<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dynamic Rank Engine - AI-powered custom rankings across any category">
    <title>Dynamic Rank Engine</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Unna:wght@400;700&family=Source+Sans+3:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0f;
            --card: #14141c;
            --card-hover: #1a1a26;
            --border: #252532;
            --border-hover: #32324a;
            --text: #e8e8ec;
            --text-muted: #8a8a9a;
            --gold: #d4af37;
            --gold-dim: #9a7d2a;
            --gold-glow: rgba(212, 175, 55, 0.12);
            --silver: #a8a8b0;
            --silver-dim: #6a6a70;
            --bronze: #a87d4a;
            --bronze-dim: #6d5230;
            --accent: #64748b;
            --accent-dim: #475569;
            --accent-glow: rgba(100, 116, 139, 0.12);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Source Sans 3', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
            min-height: 100vh;
        }

        /* Header */
        header {
            padding: 4rem 2rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(180deg, #0f0f18 0%, var(--bg) 100%);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at center top, rgba(212, 175, 55, 0.05) 0%, transparent 70%);
            pointer-events: none;
        }

        h1 {
            font-family: 'Unna', serif;
            font-size: clamp(4rem, 10vw, 9rem);
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text) 0%, var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1.1;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .stats {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            gap: 2rem;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .stats span {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .stats .num {
            font-family: 'Unna', serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text);
        }

        /* View Toggle */
        /* Methodology Badge */
        .methodology-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            color: #d4af37;
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border: 1px solid #d4af37;
            border-radius: 4px;
            background: transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .methodology-badge:hover {
            background: #d4af37;
            color: #0a0a0f;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }

        .methodology-icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }

        /* Methodology Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal-overlay.visible {
            display: flex;
        }

        .modal-content {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem 2.5rem;
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: #1a1a24;
            border-radius: 4px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: var(--gold-dim);
            border-radius: 4px;
        }

        .modal-content::-webkit-scrollbar-thumb:hover {
            background: var(--gold);
        }

        /* Category Modal */
        .category-modal-content {
            max-width: 500px;
            padding: 1.5rem;
        }

        .category-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .category-modal-header h2 {
            font-family: 'Unna', serif;
            font-size: 1.5rem;
            color: var(--text);
            margin: 0;
        }

        .category-modal-weight {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text);
            background: var(--border);
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
        }

        .category-modal-desc {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-muted);
        }

        /* Show Detail Modal - ARTIST REDESIGN */
        .show-detail-content {
            max-width: 950px;
            width: 92%;
            max-height: 92vh;
            overflow-y: auto;
            padding: 0;
            background: linear-gradient(180deg, #1a1a24 0%, #14141c 100%);
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6), 0 0 100px rgba(212, 175, 55, 0.1);
        }

        /* HEADER SECTION */
        .show-detail-header {
            display: flex;
            gap: 2rem;
            padding: 2.5rem;
            background: linear-gradient(135deg, rgba(25, 25, 35, 0.98) 0%, rgba(20, 20, 28, 0.95) 100%);
            border-bottom: 2px solid var(--gold-dim);
            position: relative;
        }

        .show-detail-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
            opacity: 0.5;
        }

        .show-detail-poster {
            width: 200px;
            min-width: 200px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5), 0 0 30px rgba(212, 175, 55, 0.15);
            border: 2px solid rgba(212, 175, 55, 0.2);
        }

        .show-detail-poster img {
            width: 100%;
            height: auto;
            display: block;
        }

        .show-detail-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .show-detail-title {
            font-family: 'Unna', serif;
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--text);
            margin: 0;
            line-height: 1.1;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.5);
            letter-spacing: -0.02em;
        }

        .show-detail-meta {
            display: flex;
            gap: 1.25rem;
            color: var(--text-muted);
            font-size: 1rem;
            margin-top: 0.5rem;
            font-weight: 400;
        }

        .show-detail-meta span:nth-child(2n) {
            color: var(--gold-dim);
            opacity: 0.6;
        }

        /* SCORE DISPLAY */
        .show-detail-score {
            display: flex;
            align-items: flex-end;
            gap: 0.75rem;
            margin-top: 1rem;
            padding: 1rem 1.5rem;
            background: rgba(212, 175, 55, 0.08);
            border-radius: 12px;
            border: 1px solid rgba(212, 175, 55, 0.2);
            width: fit-content;
        }

        .show-detail-final-score {
            font-family: 'Unna', serif;
            font-size: 4rem;
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(135deg, var(--gold) 0%, #f4e4a6 50%, var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .show-detail-final-score.silver {
            background: linear-gradient(135deg, var(--silver) 0%, #d0d0d8 50%, var(--silver) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .show-detail-final-score.bronze {
            background: linear-gradient(135deg, var(--bronze) 0%, #c9a67a 50%, var(--bronze) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .show-detail-score-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        /* EXTERNAL RATINGS - COLOR CODED */
        .show-detail-external {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }

        .external-ratings-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .external-rating {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding: 0.6rem 1rem;
            border-radius: 10px;
            border: 1px solid;
            min-width: 90px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .external-rating:hover {
            transform: translateY(-2px);
        }

        .external-rating.imdb {
            background: linear-gradient(135deg, rgba(245, 197, 24, 0.15), rgba(245, 197, 24, 0.05));
            border-color: rgba(245, 197, 24, 0.4);
            box-shadow: 0 4px 15px rgba(245, 197, 24, 0.1);
        }

        .external-rating.rotten {
            background: linear-gradient(135deg, rgba(250, 42, 0, 0.15), rgba(250, 42, 0, 0.05));
            border-color: rgba(250, 42, 0, 0.4);
            box-shadow: 0 4px 15px rgba(250, 42, 0, 0.1);
        }

        .external-rating.metacritic {
            background: linear-gradient(135deg, rgba(255, 204, 0, 0.15), rgba(255, 204, 0, 0.05));
            border-color: rgba(255, 204, 0, 0.4);
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.1);
        }

        .rating-source {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-weight: 700;
            opacity: 0.9;
        }

        .external-rating.imdb .rating-source { color: #f5c518; }
        .external-rating.rotten .rating-source { color: #fa2a00; }
        .external-rating.metacritic .rating-source { color: #ffcc00; }

        .rating-value {
            font-family: 'Unna', serif;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text);
            line-height: 1;
            margin-top: 0.2rem;
        }

        .rating-count {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 0.15rem;
        }

        /* BODY SECTIONS */
        .show-detail-body {
            padding: 2.5rem;
        }

        .show-detail-section {
            margin-bottom: 2.5rem;
            position: relative;
        }

        .show-detail-section:last-child {
            margin-bottom: 0;
        }

        /* SECTION HEADERS WITH ACCENT COLORS */
        .show-detail-section h3 {
            font-family: 'Unna', serif;
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1.25rem;
            padding: 0.6rem 1rem;
            border-radius: 6px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            display: inline-block;
        }

        .show-detail-consensus h3 {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
            color: var(--gold);
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .show-detail-narrative h3 {
            background: linear-gradient(135deg, rgba(100, 149, 237, 0.2), rgba(100, 149, 237, 0.1));
            color: #6495ed;
            border: 1px solid rgba(100, 149, 237, 0.3);
        }

        .show-detail-section:not(.show-detail-consensus):not(.show-detail-narrative) h3 {
            background: linear-gradient(135deg, rgba(168, 168, 176, 0.2), rgba(168, 168, 176, 0.1));
            color: var(--silver);
            border: 1px solid rgba(168, 168, 176, 0.3);
        }

        /* CONSENSUS SECTION - SPECIAL STYLING */
        .show-detail-consensus {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.08), rgba(212, 175, 55, 0.02));
            border: 1px solid rgba(212, 175, 55, 0.25);
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
        }

        .show-detail-consensus::before {
            content: '"';
            position: absolute;
            top: 0.5rem;
            right: 1.5rem;
            font-family: Georgia, serif;
            font-size: 5rem;
            color: rgba(212, 175, 55, 0.2);
            line-height: 1;
            pointer-events: none;
        }

        .consensus-content p {
            font-size: 1.15rem;
            line-height: 1.8;
            color: var(--text);
            font-style: italic;
            margin: 0;
            position: relative;
            z-index: 1;
        }

        /* NARRATIVE SECTION */
        .show-detail-narrative {
            background: linear-gradient(135deg, rgba(100, 149, 237, 0.06), rgba(100, 149, 237, 0.02));
            border: 1px solid rgba(100, 149, 237, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .narrative-content p {
            font-size: 1.05rem;
            line-height: 1.95;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 1.25rem;
        }

        .narrative-content p:last-child {
            margin-bottom: 0;
        }

        .narrative-content h3,
        .narrative-content h4 {
            font-family: 'Unna', serif;
            color: #6495ed;
            margin: 1.75rem 0 1rem;
            font-size: 1.2rem;
        }

        .narrative-content em {
            color: rgba(255, 255, 255, 0.6);
            font-style: italic;
        }

        .narrative-content strong {
            color: var(--text);
            font-weight: 700;
        }

        /* DIMENSION CARDS - MODERN STYLING */
        .show-detail-dimension {
            margin-bottom: 1rem;
            padding: 1.25rem;
            background: linear-gradient(135deg, rgba(25, 25, 35, 0.9), rgba(20, 20, 28, 0.9));
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: border-color 0.2s ease, transform 0.2s ease;
        }

        .show-detail-dimension:hover {
            border-color: rgba(212, 175, 55, 0.3);
            transform: translateX(4px);
        }

        .show-detail-dimension:last-child {
            margin-bottom: 0;
        }

        .show-detail-dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .show-detail-dimension-title {
            font-family: 'Unna', serif;
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--text);
        }

        .show-detail-dimension-score {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .show-detail-raw-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
        }

        .show-detail-raw-score.silver { color: var(--silver); }
        .show-detail-raw-score.bronze { color: var(--bronze); }

        .show-detail-weighted-score {
            font-size: 0.85rem;
            color: var(--text-muted);
            padding: 0.2rem 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        /* PROGRESS BARS WITH GRADIENT */
        .show-detail-dimension-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }

        .show-detail-dimension-bar > div {
            height: 100%;
            border-radius: 3px;
            background: linear-gradient(90deg, var(--gold-dim) 0%, var(--gold) 50%, #f4e4a6 100%);
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.4);
            transition: width 0.6s ease;
        }

        .show-detail-dimension-bar > div.silver {
            background: linear-gradient(90deg, var(--silver) 0%, #d0d0d8 50%, var(--silver) 100%);
            box-shadow: 0 0 10px rgba(168, 168, 176, 0.4);
        }

        .show-detail-dimension-bar > div.bronze {
            background: linear-gradient(90deg, var(--bronze) 0%, #c9a67a 50%, var(--bronze) 100%);
            box-shadow: 0 0 10px rgba(168, 125, 74, 0.4);
        }

        .show-card-panel {
            transition: all 0.3s ease;
        }

        .show-card-panel:hover {
            border-color: var(--gold-dim);
            background: linear-gradient(135deg, rgba(30, 30, 40, 0.98), rgba(25, 25, 35, 0.85));
        }

        /* Make sliders not trigger card click */
        .cat-slider-input {
            cursor: pointer;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            line-height: 1;
        }

        .modal-close:hover {
            color: var(--gold);
        }

        .modal-content h2 {
            font-family: 'Unna', serif;
            font-size: 1.8rem;
            color: var(--text);
            margin-bottom: 1rem;
        }

        /* Methodology Navigation */
        .methodology-nav {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid var(--border);
        }

        .methodology-nav a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.75rem;
            padding: 0.35rem 0.75rem;
            border: 1px solid var(--border);
            border-radius: 100px;
            transition: all 0.2s;
        }

        .methodology-nav a:hover {
            color: var(--gold);
            border-color: var(--gold-dim);
        }

        /* Methodology Sections */
        .methodology-section {
            margin-bottom: 2.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 3px solid;
        }

        .methodology-intro {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05));
            border-color: #3b82f6;
        }

        .methodology-intro strong {
            color: #60a5fa;
        }

        .intro-header {
            margin-bottom: 1rem;
        }

        .intro-header h3 {
            font-size: 1.1rem;
            color: #60a5fa;
            margin-bottom: 0;
            font-weight: 600;
        }

        .methodology-intro p {
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .intro-example {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #60a5fa;
            padding: 0.75rem 1rem;
            border-radius: 0 6px 6px 0;
            margin: 1rem 0;
            line-height: 1.7;
        }

        .intro-example strong {
            color: #93c5fd;
        }

        .methodology-categories {
            border-left: 3px solid var(--border);
            padding-left: 0;
        }

        .methodology-category {
            margin-bottom: 1.75rem;
            padding: 1.25rem;
            background: var(--bg);
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .methodology-category:last-child {
            margin-bottom: 0;
        }

        .methodology-category h3 {
            font-family: 'Unna', serif;
            font-size: 1.2rem;
            color: var(--text);
            margin-bottom: 0;
            font-weight: 600;
            letter-spacing: 0.01em;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .category-weight {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            background: var(--border);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
        }

        .methodology-category p {
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.7;
            margin-bottom: 0;
        }

        .methodology-multipliers {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05));
            border-color: #f59e0b;
        }

        .methodology-multipliers h3 {
            color: #fbbf24;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .methodology-multipliers p {
            font-size: 0.8rem;
            color: var(--text-muted);
            line-height: 1.7;
            margin-bottom: 0.5rem;
        }

        .methodology-multipliers strong {
            color: #fbbf24;
        }

        .methodology-tier {
            padding: 1.75rem;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.2));
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .methodology-tier h3 {
            font-size: 1.1rem;
            color: var(--text);
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .methodology-tier p {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        .methodology-tier strong {
            color: var(--gold);
            font-weight: 600;
        }

        /* Multiplier Grid */
        .multiplier-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .multiplier-item {
            display: flex;
            flex-direction: column;
            padding: 0.6rem 0.75rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .multiplier-item.multiplier-negative {
            border-left: 3px solid #ef4444;
        }

        .multiplier-item.multiplier-negative .multiplier-value {
            color: #ef4444;
        }

        .multiplier-item.multiplier-neutral {
            border-left: 3px solid #64748b;
        }

        .multiplier-item.multiplier-neutral .multiplier-value {
            color: #64748b;
        }

        .multiplier-item.multiplier-positive {
            border-left: 3px solid #22c55e;
        }

        .multiplier-item.multiplier-positive .multiplier-value {
            color: #22c55e;
        }

        .multiplier-range {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        .multiplier-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--gold);
            font-family: 'JetBrains Mono', monospace;
        }

        .multiplier-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            opacity: 0.8;
        }

        /* Score Scale */
        .score-scale {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 1.25rem;
        }

        .scale-item {
            display: grid;
            grid-template-columns: 60px 150px 1fr;
            align-items: center;
            gap: 1.25rem;
            padding: 0.75rem 1.25rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            border-left: 3px solid transparent;
        }

        .scale-item.scale-perfect { border-left-color: #ffd700; }
        .scale-item.scale-incredible { border-left-color: #f0c75b; }
        .scale-item.scale-exceptional { border-left-color: #c0c0c0; }
        .scale-item.scale-very-good { border-left-color: #cd7f32; }
        .scale-item.scale-good { border-left-color: #4ade80; }
        .scale-item.scale-average { border-left-color: #60a5fa; }
        .scale-item.scale-below { border-left-color: #ef4444; }

        .scale-score {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--text);
        }

        .scale-label {
            font-weight: 600;
            font-size: 1rem;
            color: var(--text);
        }

        .scale-desc {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Quick Compare Bar */
        .quick-compare {
            display: none;
            background: linear-gradient(180deg, var(--card) 0%, #0d0d14 100%);
            border-bottom: 1px solid var(--gold-dim);
            padding: 0.75rem 2rem;
            position: relative;
            z-index: 99;
        }

        .quick-compare.visible {
            display: block;
        }

        .quick-compare-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--gold);
            margin-bottom: 0.4rem;
        }

        .pinned-shows {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .pinned-card {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--bg);
            border: 1px solid var(--gold-dim);
            border-radius: 8px;
            padding: 0.5rem 0.75rem;
            min-width: 200px;
            position: relative;
        }

        .pinned-card .pin-rank {
            font-family: 'Unna', serif;
            font-weight: 900;
            color: var(--gold);
            font-size: 1.1rem;
        }

        .pinned-card .pin-title {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text);
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .pinned-card .pin-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--gold);
            font-weight: 600;
        }

        .pinned-card .unpin-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1rem;
            padding: 0;
            line-height: 1;
            opacity: 0.6;
            transition: opacity 0.2s;
        }

        .pinned-card .unpin-btn:hover {
            opacity: 1;
            color: var(--bronze);
        }

        /* Filters Section */
        .filters-section {
            background: linear-gradient(180deg, rgba(20,20,28,0.95), rgba(15,15,22,0.98));
            border-bottom: 1px solid #2a2a38;
            padding: 1.5rem 2rem;
            position: relative;
            z-index: 100;
        }

        .filter-group {
            margin-bottom: 1.25rem;
        }

        .filter-group:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #64748b;
            margin-bottom: 0.6rem;
            display: block;
            font-weight: 500;
        }

        .filter-row {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-wrapper {
            position: relative;
            flex: 1;
            min-width: 200px;
        }

        .search-input {
            width: 100%;
            padding: 0.6rem 1rem 0.6rem 2.5rem;
            background: rgba(10,10,15,0.8);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23555566' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: 0.75rem center;
            border: 1px solid #2a2a38;
            color: #e0e0e8;
            border-radius: 4px;
            font-size: 0.85rem;
            font-family: 'Source Sans 3', sans-serif;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #64748b;
            box-shadow: 0 0 0 2px rgba(100, 116, 139, 0.15);
        }

        .search-input::placeholder {
            color: #555566;
        }

        /* Weight Adjustment - Redesigned */
        .weight-group {
            background: linear-gradient(180deg, rgba(20,20,28,0.95), rgba(15,15,22,0.98));
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .weight-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        .weight-section-title {
            font-family: 'Unna', serif;
            font-size: 1.3rem;
            font-weight: 600;
            background: linear-gradient(135deg, var(--text) 0%, var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .weight-header-right {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .weight-total-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.75rem;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.4);
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            font-weight: 600;
            color: #22c55e;
        }

        .weight-total-badge.invalid {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.4);
            color: #ef4444;
        }

        .weight-total-badge span:first-child {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            opacity: 0.8;
        }

        .weight-reset-btn {
            background: transparent;
            border: 1px solid #3a3a48;
            color: var(--text-muted);
            padding: 0.4rem 0.75rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-family: 'Source Sans 3', sans-serif;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .weight-reset-btn:hover {
            border-color: var(--gold);
            color: var(--gold);
        }

        .weight-subheader {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.25rem;
            flex-wrap: wrap;
        }

        .weight-guidance {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .weight-methodology-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            color: var(--gold);
            text-decoration: none;
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.4rem 0.75rem;
            border: 1px solid var(--gold);
            border-radius: 4px;
            background: transparent;
            transition: all 0.2s ease;
            margin-left: auto;
        }

        .weight-methodology-btn:hover {
            background: rgba(212, 175, 55, 0.15);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }

        .weight-sliders {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .weight-slider-row {
            display: grid;
            grid-template-columns: 1fr auto;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.03);
        }

        .weight-slider-row:last-child {
            border-bottom: none;
        }

        .weight-slider-main {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .weight-slider-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .weight-slider-label {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text);
        }

        .weight-slider-value {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gold);
            font-family: 'JetBrains Mono', monospace;
            min-width: 32px;
            text-align: right;
        }

        .weight-slider-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .weight-slider-input {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, rgba(100,116,139,0.3) 0%, rgba(100,116,139,0.1) 100%);
            border-radius: 4px;
            outline: none;
            cursor: pointer;
        }

        .weight-slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: linear-gradient(145deg, var(--gold), var(--gold-dim));
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.15s;
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
        }

        .weight-slider-input::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            box-shadow: 0 2px 10px rgba(212, 175, 55, 0.4);
        }

        /* Episode Multiplier - Integrated */
        .episode-multiplier-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.08), rgba(34, 197, 94, 0.02));
            border: 1px solid rgba(34, 197, 94, 0.2);
            border-radius: 8px;
            margin-top: 0.5rem;
        }

        .episode-multiplier-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            color: #22c55e;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .episode-multiplier-checkbox input {
            width: 18px;
            height: 18px;
            accent-color: #22c55e;
            cursor: pointer;
        }

        .episode-multiplier-desc {
            color: var(--text-muted);
            font-size: 0.75rem;
            line-height: 1.4;
            flex: 1;
        }

        /* Per-card category score sliders */
        .cat-bar-container {
            position: relative;
            height: 14px;
            display: flex;
            align-items: center;
        }
        .cat-bar-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px;
            transform: translateY(-50%);
            background: #333;
            border-radius: 2px;
            overflow: hidden;
        }
        .cat-bar-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 0.1s ease, background 0.1s ease;
        }
        .cat-slider-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            cursor: default;
            margin: 0;
            padding: 0;
            z-index: 2;
            pointer-events: none;
            touch-action: none;
        }
        .cat-slider-input::-webkit-slider-runnable-track {
            height: 14px;
            background: transparent;
            pointer-events: none;
        }
        /* Cinema film reel thumb styling - pure CSS */
        .cat-slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: 
                /* Center hole */
                radial-gradient(circle at 50% 50%, transparent 15%, var(--thumb-color, #d4af37) 16%, var(--thumb-color, #d4af37) 35%, transparent 36%),
                /* Spiral film rings */
                repeating-radial-gradient(circle at 50% 50%, transparent 0, transparent 2px, rgba(0,0,0,0.25) 3px, rgba(0,0,0,0.25) 4px, transparent 5px),
                /* Base reel color with metal shine */
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4) 0%, transparent 40%),
                var(--thumb-color, #d4af37);
            border-radius: 50%;
            cursor: grab;
            transition: transform 0.15s, box-shadow 0.15s, filter 0.15s;
            box-shadow: 
                inset 0 -2px 4px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.3),
                0 2px 6px rgba(0,0,0,0.5), 
                0 0 0 1px rgba(0,0,0,0.3);
            pointer-events: auto;
            position: relative;
            z-index: 3;
        }
        .cat-slider-input::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            box-shadow: 
                inset 0 -2px 4px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.3),
                0 4px 10px rgba(0,0,0,0.6), 
                0 0 0 1px rgba(0,0,0,0.3), 
                0 0 10px var(--thumb-color, #d4af37);
            filter: brightness(1.1);
        }
        .cat-slider-input::-webkit-slider-thumb:active {
            cursor: grabbing;
            transform: scale(1.25);
        }
        .cat-slider-input::-moz-range-track {
            height: 14px;
            background: transparent;
            border: none;
            pointer-events: none;
        }
        .cat-slider-input::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: 
                radial-gradient(circle at 50% 50%, transparent 15%, var(--thumb-color, #d4af37) 16%, var(--thumb-color, #d4af37) 35%, transparent 36%),
                repeating-radial-gradient(circle at 50% 50%, transparent 0, transparent 2px, rgba(0,0,0,0.25) 3px, rgba(0,0,0,0.25) 4px, transparent 5px),
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4) 0%, transparent 40%),
                var(--thumb-color, #d4af37);
            border-radius: 50%;
            cursor: grab;
            border: none;
            transition: transform 0.15s, box-shadow 0.15s, filter 0.15s;
            box-shadow: 
                inset 0 -2px 4px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.3),
                0 2px 6px rgba(0,0,0,0.5), 
                0 0 0 1px rgba(0,0,0,0.3);
            pointer-events: auto;
        }
        .cat-slider-input::-moz-range-thumb:hover {
            transform: scale(1.15);
            box-shadow: 
                inset 0 -2px 4px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.3),
                0 4px 10px rgba(0,0,0,0.6), 
                0 0 0 1px rgba(0,0,0,0.3), 
                0 0 10px var(--thumb-color, #d4af37);
            filter: brightness(1.1);
        }
        .cat-slider-input::-moz-range-thumb:active {
            cursor: grabbing;
            transform: scale(1.25);
        }
        .cat-value-modified {
            color: #60a5fa !important;
        }

        /* Category label hover effect for modal */
        .score-label-text:hover {
            color: var(--gold) !important;
            text-decoration: underline;
            text-decoration-color: var(--gold);
            text-underline-offset: 3px;
        }
        .score-value:hover {
            color: var(--gold) !important;
        }

        /* Score save bar */
        .score-save-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, rgba(20,20,28,0.98), rgba(10,10,15,0.99));
            border-top: 1px solid #64748b;
            padding: 0.6rem 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            z-index: 999;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            flex-wrap: wrap;
        }
        .score-save-bar.visible {
            transform: translateY(0);
        }
        .score-save-bar .modified-count {
            font-size: 0.8rem;
            color: #60a5fa;
            font-family: 'JetBrains Mono', monospace;
        }
        .score-save-bar button {
            padding: 0.4rem 1rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        .save-btn {
            background: #64748b;
            color: #e8e8ec;
            border: 1px solid #64748b;
        }
        .save-btn:hover { background: #94a3b8; }
        .export-btn {
            background: transparent;
            color: #d4af37;
            border: 1px solid #d4af37;
        }
        .export-btn:hover { background: rgba(212,175,55,0.15); }
        .import-btn {
            background: transparent;
            color: #64748b;
            border: 1px solid #3a3a48;
        }
        .import-btn:hover { background: rgba(100,116,139,0.15); }
        .reset-btn {
            background: transparent;
            color: #ef4444;
            border: 1px solid #ef444480;
        }
        .reset-btn:hover { background: rgba(239,68,68,0.15); }

        @media (max-width: 600px) {
            .cat-slider-input::-webkit-slider-thumb {
                width: 16px;
                height: 16px;
            }
            .cat-slider-input::-moz-range-thumb {
                width: 16px;
                height: 16px;
            }
            .cat-bar-container {
                height: 20px;
            }
        }

        /* Backdrop banner - hidden on desktop, shown on mobile */
        .show-backdrop {
            display: none;
        }

        .weight-recalc-btn {
            display: block;
            width: 100%;
            margin-top: 1rem;
            padding: 0.6rem;
            background: transparent;
            color: #64748b;
            border: 1px solid #3a3a48;
            border-radius: 4px;
            font-size: 0.7rem;
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            opacity: 0.5;
            pointer-events: none;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .weight-recalc-btn.active {
            opacity: 1;
            pointer-events: auto;
            color: #64748b;
            border-color: #64748b;
        }

        .weight-recalc-btn.active:hover {
            background: rgba(100, 116, 139, 0.15);
            box-shadow: 0 0 15px rgba(100, 116, 139, 0.2);
        }
            border-color: var(--accent-dim);
            color: var(--text);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #555566;
            font-size: 1rem;
        }

        .range-wrapper {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .range-slider {
            flex: 1;
            height: 4px;
            -webkit-appearance: none;
            background: var(--border);
            border-radius: 2px;
            cursor: pointer;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: var(--gold);
            border-radius: 50%;
            cursor: pointer;
        }

        .range-value {
            font-size: 0.8rem;
            color: var(--gold);
            min-width: 2.5rem;
            text-align: right;
        }

        .genre-pills {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
        }

        .genre-pill {
            padding: 0.3rem 0.7rem;
            background: transparent;
            border: 1px solid #3a3a48;
            color: #8a8a9a;
            cursor: pointer;
            border-radius: 100px;
            font-size: 0.65rem;
            font-family: 'Source Sans 3', sans-serif;
            transition: all 0.2s ease;
            letter-spacing: 0.03em;
            text-transform: lowercase;
        }

        .genre-pill:hover {
            border-color: #64748b;
            color: #c0c0c8;
            background: rgba(100, 116, 139, 0.1);
        }

        .genre-pill.active {
            background: #64748b;
            color: #ffffff;
            border-color: #64748b;
            font-weight: 500;
        }

        /* Filter buttons (Era) */
        .filter-btn {
            padding: 0.4rem 0.75rem;
            background: transparent;
            border: 1px solid #3a3a48;
            color: #8a8a9a;
            cursor: pointer;
            border-radius: 3px;
            font-size: 0.7rem;
            font-family: 'Source Sans 3', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            transition: all 0.2s ease;
        }

        .filter-btn:hover {
            border-color: #64748b;
            color: #c0c0c8;
            background: rgba(100, 116, 139, 0.1);
        }

        .filter-btn.active {
            background: #64748b;
            color: #ffffff;
            border-color: #64748b;
            font-weight: 600;
        }

        .active-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px solid var(--border);
        }

        .active-filter-tag {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.2rem 0.45rem;
            background: var(--gold-glow);
            border: 1px solid var(--gold-dim);
            border-radius: 4px;
            font-size: 0.65rem;
            color: var(--gold);
        }

        .active-filter-tag button {
            background: none;
            border: none;
            color: var(--gold);
            cursor: pointer;
            padding: 0;
            font-size: 0.85rem;
        }

        .clear-all {
            font-size: 0.65rem;
            color: var(--text-muted);
            cursor: pointer;
            background: none;
            border: none;
            text-decoration: underline;
        }

        /* Main */
        main {
            max-width: 900px;
            margin: 0 auto;
            padding: 1.5rem 1rem 4rem;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .results-count {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .results-count strong {
            color: var(--gold);
        }

        .sort-select {
            padding: 0.35rem 0.75rem;
            background: var(--bg);
            border: 1px solid var(--border);
            color: var(--text);
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
        }

        .sort-select:focus {
            outline: none;
            border-color: var(--gold);
        }

        /* Show Cards - Cinematic Editorial Style */
        .show-list {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .show-list.hidden {
            display: none !important;
        }

        .score-breakdown.hidden {
            display: none !important;
        }

        .show-card {
            background: #14141c !important;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem 1.75rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: flex-start;
            cursor: pointer;
        }

        /* Click indicator overlay */
        .show-card::before {
            content: 'View Details';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 0.75rem 1.5rem;
            background: rgba(212, 175, 55, 0.9);
            color: #1a1a24;
            font-family: 'Unna', serif;
            font-size: 0.9rem;
            font-weight: 700;
            border-radius: 30px;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
            z-index: 10;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        .show-card:hover::before {
            opacity: 1;
        }

        .show-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(212, 175, 55, 0.05));
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            border-radius: 12px;
        }

        .show-card:hover::after {
            opacity: 1;
        }

        .show-card:hover {
            border-color: var(--gold-dim);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3), 0 0 40px rgba(212, 175, 55, 0.15);
            transform: translateY(-2px);
        }

        /* Universal transparent rule - strip backgrounds from card inner wrappers */
        .show-card .title-section,
        .show-card .score-section,
        .show-card .score-breakdown,
        .show-card .meta,
        .show-card .title-section *,
        .show-card .score-section *,
        .show-card .score-breakdown *,
        .show-card .meta * {
            background: transparent !important;
            box-shadow: none !important;
        }

        /* Exception: keep gradients for prestige elements */
        .show-card .rank-badge {
            background: linear-gradient(135deg, var(--gold-dim), var(--gold)) !important;
        }
        .show-card.tier-silver .rank-badge {
            background: linear-gradient(135deg, var(--silver-dim), var(--silver)) !important;
        }
        .show-card.tier-bronze .rank-badge {
            background: linear-gradient(135deg, var(--bronze-dim), var(--bronze)) !important;
        }
        .show-card .score-bar-fill {
            background: linear-gradient(90deg, #9E7F2A, #F0C75B, #9E7F2A) !important;
            background-size: 200% 100% !important;
        }
        .show-card .score-item.tier-silver .score-bar-fill {
            background: linear-gradient(90deg, #7a7a80, #c0c0c8, #7a7a80) !important;
            background-size: 200% 100% !important;
        }
        .show-card .score-item.tier-bronze .score-bar-fill {
            background: linear-gradient(90deg, #8B5A2B, #CD853F, #8B5A2B) !important;
            background-size: 200% 100% !important;
        }
        .show-card .season-badge {
            background: var(--gold) !important;
        }
        .show-card .final-score {
            background: unset !important;
        }

        /* Also preserve score bar track color */
        .show-card .score-bar {
            background: #333333 !important;
        }
        .show-card .score-item {
            background: transparent !important;
        }

        /* Poster transparency */
        .show-card .poster,
        .show-card .poster-placeholder {
            background: transparent !important;
        }

        /* Score desc transparency */
        .show-card .score-desc {
            background: transparent !important;
        }

        /* Score labels and values */
        .show-card .score-label-text,
        .show-card .score-value {
            background: transparent !important;
        }

        /* Genre tags */
        .show-card .genre-tag {
            background: transparent !important;
            border: 1px solid var(--gold) !important;
            color: var(--gold) !important;
            transition: all 0.3s ease;
        }
        .show-card .genre-tag:hover {
            background: var(--gold) !important;
            color: var(--bg) !important;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }

        /* Meta info */
        .show-card .meta .year,
        .show-card .meta .episodes {
            background: transparent !important;
        }

        /* Pin button - needs explicit background */
        .show-card .pin-btn {
            background: rgba(0, 0, 0, 0.6) !important;
        }

        .show-card:hover {
            background: #1a1a26 !important;
            border-color: var(--border-hover);
        }

        /* Force transparency on all card children */
        .show-card > * {
            background-color: transparent !important;
        }
            transition: opacity 0.3s;
        }

        .show-card::after {
            display: none !important;
        }

        .show-card:hover {
            background: var(--card-hover);
            border-color: var(--border-hover);
            transform: translateY(-3px);
            box-shadow: 0 16px 48px rgba(0,0,0,0.4);
        }

        .show-card::before,
        .show-card::after {
            display: none !important;
        }

        .show-card.tier-gold { border-color: var(--gold-dim); }
        .show-card.tier-gold .rank-badge { background: linear-gradient(135deg, var(--gold-dim), var(--gold)); color: var(--bg); border: none; box-shadow: 0 4px 16px rgba(212, 175, 55, 0.4); }

        .show-card.tier-silver { border-color: var(--silver-dim); }
        .show-card.tier-silver .rank-badge { background: linear-gradient(135deg, var(--silver-dim), var(--silver)); color: var(--bg); border: none; }

        .show-card.tier-bronze { border-color: var(--bronze-dim); }
        .show-card.tier-bronze .rank-badge { background: linear-gradient(135deg, var(--bronze-dim), var(--bronze)); color: var(--bg); border: none; }

        /* Card Header */
        .card-header {
            display: none; /* Removed - using direct children now */
        }

        .title-section {
            flex: 1;
            min-width: 200px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding-top: 0;
            margin-top: 0;
        }

        /* Poster Thumbnail */
        .poster {
            width: 120px;
            height: 180px;
            border-radius: 4px;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .poster-glow {
            display: none; /* Disabled for uniform card look */
        }

        .poster-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Unna', serif;
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.15);
            font-weight: 900;
        }

        /* Pin Button */
        .pin-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--border);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s;
            color: var(--text-muted);
            font-size: 0.9rem;
            z-index: 10;
        }

        .show-card:hover .pin-btn,
        .pin-btn.pinned {
            opacity: 1;
        }

        .pin-btn:hover {
            background: var(--gold);
            border-color: var(--gold);
            color: var(--bg);
        }

        .pin-btn.pinned {
            background: var(--gold);
            border-color: var(--gold);
            color: var(--bg);
        }

        .rank-badge {
            position: absolute;
            top: -12px;
            left: -12px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            background: var(--bg);
            border: 2px solid var(--gold-dim);
            border-radius: 50%;
            font-family: 'Unna', serif;
            font-weight: 900;
            font-size: 1.5rem;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            z-index: 10;
        }

        .title-section {
            flex: 1;
            min-width: 0;
            margin-top: -4px;
        }

        .show-title {
            font-family: 'Unna', serif;
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
            color: var(--text);
            letter-spacing: -0.01em;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .season-badge {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 2px 6px;
            border: 1px solid var(--gold);
            border-radius: 4px;
            color: #000;
            background: #D4AF37;
            letter-spacing: 0.02em;
        }
            border: 1px solid var(--gold);
            border-radius: 4px;
            color: #000;
            background: var(--gold);
            letter-spacing: 0.02em;
        }

        .show-meta {
            display: flex;
            gap: 0.6rem;
            font-family: 'Unna', serif;
            font-size: 0.9rem;
            font-weight: 500;
            color: #AAAAAA;
            margin-top: 0.25rem;
            letter-spacing: 0.02em;
        }

        .show-meta .year::before {
            content: '';
            margin-right: 0.6rem;
            color: var(--gold-dim);
        }

        .show-meta .year {
            color: var(--text);
        }

        .show-meta .episodes {
            color: var(--text-muted);
        }

        .score-section {
            text-align: right;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
            margin-left: auto;
        }

        .final-score {
            font-family: 'Unna', serif;
            font-size: 3.2rem;
            font-weight: 900;
            color: var(--gold);
            text-align: right;
            line-height: 1;
            text-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .final-score.silver {
            color: var(--silver);
            text-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .final-score.bronze {
            color: var(--bronze);
            text-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .score-label {
            display: block;
            font-size: 0.6rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            text-align: right;
            margin-top: 0.3rem;
        }

        /* Score Breakdown - List View */
        .score-breakdown {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border);
            position: relative;
            z-index: 1;
            width: 100%;
        }

        .score-item {
            display: grid;
            grid-template-columns: 35% 55% 10%;
            align-items: center;
            gap: 0;
        }

        .score-label-text {
            font-family: 'Unna', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
            flex-shrink: 0;
            width: 100%;
            letter-spacing: 0.01em;
        }

        .score-bar {
            height: 6px;
            background: #333333;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            width: 100%;
        }

        .score-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.6s ease-out;
            width: 0;
            animation: shimmerMove 3s ease-in-out infinite;
        }

        @keyframes shimmerMove {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Gold tier */
        .score-item.tier-gold .score-bar-fill { background: linear-gradient(90deg, #9E7F2A, #F0C75B, #9E7F2A); background-size: 200% 100%; }
        .score-item.tier-gold .score-value { color: var(--gold); }

        /* Silver tier */
        .score-item.tier-silver .score-bar-fill { background: linear-gradient(90deg, #7a7a80, #c0c0c8, #7a7a80); background-size: 200% 100%; }
        .score-item.tier-silver .score-value { color: var(--silver); }

        /* Bronze tier */
        .score-item.tier-bronze .score-bar-fill { background: linear-gradient(90deg, #6d5230, #c9955a, #6d5230); background-size: 200% 100%; }
        .score-item.tier-bronze .score-value { color: var(--bronze); }

        .score-value {
            font-family: 'Unna', serif;
            font-weight: 600;
            font-size: 1.4rem;
            color: var(--text);
            text-align: right;
            width: 100%;
            letter-spacing: 0.02em;
        }

        .score-value.clickable {
            cursor: pointer;
            transition: color 0.2s;
        }

        .score-value.clickable:hover {
            color: var(--gold);
        }

        /* Clickable score label */
        .score-label-text.clickable {
            cursor: pointer;
            position: relative;
            transition: color 0.2s;
        }

        .score-label-text.clickable:hover {
            color: var(--gold);
        }

        .score-label-text.clickable::after {
            content: '';
            font-size: 0.5rem;
            margin-left: 0.3rem;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .score-label-text.clickable:hover::after {
            opacity: 0.5;
        }

        /* Score description accordion */
        .score-desc {
            display: none;
            font-size: 0.7rem;
            color: var(--text-muted);
            padding: 0.25rem 0;
            line-height: 1.4;
            font-style: italic;
            width: 100%;
            order: 3;
        }

        .score-desc.expanded {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Genres */
        .genres {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
            margin-top: 1.25rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
            position: relative;
            z-index: 1;
        }

        .genre-tag {
            padding: 0.2rem 0.5rem;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 100px;
            font-family: 'Unna', serif;
            font-size: 0.7rem;
            font-weight: 500;
            color: var(--text-muted);
            transition: all 0.2s ease;
            cursor: pointer;
            letter-spacing: 0.03em;
        }

        .genre-tag:hover {
            border-color: var(--text-muted);
            color: var(--text);
        }

        /* Card methodology link */
        .card-methodology-link {
            font-family: 'Unna', serif;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-muted);
            text-decoration: none;
            border-bottom: 1px dashed var(--text-muted);
            transition: all 0.2s;
            margin-top: 0.5rem;
            display: inline-block;
            letter-spacing: 0.02em;
        }

        .card-methodology-link:hover {
            color: var(--gold);
            border-color: var(--gold);
        }

        /* Read Review Arrow */
        .read-more {
            position: absolute;
            bottom: 1rem;
            right: 1.5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 0.3rem;
            opacity: 0;
            transition: all 0.3s;
        }

        .show-card:hover .read-more {
            opacity: 1;
            transform: translateX(-4px);
        }

        .read-more-arrow {
            transition: transform 0.3s;
        }

        .show-card:hover .read-more-arrow {
            transform: translateX(4px);
        }

        /* No Results */
        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        /* Mobile - same as desktop */
        @media (max-width: 600px) {
            header { padding: 2rem 1rem; }
            h1 { font-size: 2.5rem !important; }
            .subtitle { font-size: 0.8rem !important; padding: 0 1rem; }
            .stats { gap: 1rem !important; padding: 0 1rem; }
            .filters-section { padding: 0.5rem; }
            .filters-toggle-btn {
                font-size: 1rem;
                padding: 0.875rem 1rem;
            }
            .weight-section-title {
                font-size: 1.3rem;
            }
            .weight-slider-label {
                font-size: 0.9rem;
            }
            .weight-slider-row {
                grid-template-columns: 140px 1fr 45px;
                gap: 0.75rem;
            }
            .search-bar-fixed {
                padding: 0.5rem 0.75rem;
            }
            .search-input-fixed {
                font-size: 0.9rem;
                padding: 0.55rem 2.25rem 0.55rem 0.875rem;
            }

            /* Modal mobile fixes */
            .modal-overlay {
                padding: 0.5rem !important;
                align-items: flex-start !important;
            }
            .modal-content {
                width: 100% !important;
                max-width: 100% !important;
                padding: 1rem !important;
                max-height: 95vh !important;
            }
            .show-detail-content {
                width: 100% !important;
                max-width: 100% !important;
            }
            .show-detail-header {
                flex-direction: column !important;
                padding: 1.5rem !important;
                gap: 1rem !important;
            }
            .show-detail-poster {
                width: 120px !important;
                min-width: 120px !important;
                margin: 0 auto !important;
            }
            .show-detail-title {
                font-size: 1.8rem !important;
                text-align: center !important;
            }
            .show-detail-meta {
                justify-content: center !important;
                flex-wrap: wrap !important;
            }
            .show-detail-score {
                margin: 0 auto !important;
            }
            .show-detail-final-score {
                font-size: 2.5rem !important;
            }
            .show-detail-body {
                padding: 1.5rem !important;
            }
            .show-detail-section {
                margin-bottom: 1.5rem !important;
            }
            .show-detail-dimension {
                padding: 1rem !important;
            }
            .category-modal-content {
                max-width: 100% !important;
                padding: 1rem !important;
            }
            .modal-close {
                top: 0.5rem !important;
                right: 0.5rem !important;
            }

            /* Mobile card layout: stacked with backdrop banner */
            .show-module {
                flex-direction: column !important;
                align-items: stretch !important;
            }
            .show-poster {
                display: none !important;
            }
            .show-backdrop {
                display: block !important;
                width: 100% !important;
                height: 180px !important;
                position: relative !important;
                overflow: hidden !important;
                border-radius: 12px 12px 0 0 !important;
                background: #1a1a24 !important;
            }
            .show-backdrop img {
                width: 100% !important;
                height: 100% !important;
                object-fit: cover !important;
                object-position: center 20% !important;
                display: block !important;
            }
            .show-backdrop .backdrop-gradient {
                position: absolute !important;
                bottom: 0 !important;
                left: 0 !important;
                right: 0 !important;
                height: 60px !important;
                background: linear-gradient(transparent, rgba(20,20,28,0.95)) !important;
                pointer-events: none !important;
            }
            .show-backdrop .backdrop-rank-badge {
                position: absolute !important;
                top: 8px !important;
                left: 8px !important;
            }
            .show-card-panel {
                border-radius: 0 0 12px 12px !important;
                border-top: none !important;
                border-left: 1px solid #252532 !important;
            }
        }

        @media (max-width: 900px) {
            .show-module {
                gap: 0 !important;
                margin-bottom: 0.75rem !important;
            }
            .show-poster {
                width: 120px !important;
                min-width: 120px !important;
                flex-shrink: 0 !important;
                align-self: stretch !important;
            }
            .show-poster img {
                height: 100% !important;
                width: 100% !important;
                object-fit: cover !important;
            }
            .show-card-panel {
                padding: 0.5rem 0.75rem !important;
                min-width: 0 !important;
            }
            .show-title { font-size: 1.1rem; }
            .final-score { font-size: 1.5rem; }
            header { padding: 3rem 1.5rem; }
            h1 { font-size: 3rem; }
            .subtitle { font-size: 0.9rem; }
            .stats { gap: 1.5rem; }
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes goldGlow {
            0%, 100% { text-shadow: 0 0 10px rgba(212, 175, 55, 0.3); }
            50% { text-shadow: 0 0 20px rgba(212, 175, 55, 0.6), 0 0 30px rgba(212, 175, 55, 0.3); }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .show-card {
            animation: fadeIn 0.4s ease-out;
            animation-fill-mode: both;
        }

        /* ============================================
           CARD RESET - KILLS ALL BACKGROUND ARTIFACTS
           ============================================ */
        .show-card,
        .show-card *,
        .show-card *::before,
        .show-card *::after {
            background: transparent !important;
            background-color: transparent !important;
            background-image: none !important;
            box-shadow: none !important;
            text-shadow: none !important;
        }

        /* Now re-apply only what we need inline */
    
        /* ============================================
           FILTERS SECTION - COLLAPSIBLE
           ============================================ */
        .filters-toggle-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 1rem 1.5rem;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(212, 175, 55, 0.05));
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            color: #d4af37;
            font-family: 'Unna', serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .filters-toggle-btn:hover {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
            border-color: #d4af37;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.2);
        }

        .filters-toggle-icon {
            font-size: 1.3rem;
        }

        .filters-toggle-arrow {
            font-size: 0.9rem;
            transition: transform 0.3s ease;
        }

        .filters-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.4s ease, opacity 0.3s ease;
            opacity: 1;
        }

        .filters-content.collapsed {
            max-height: 0;
            opacity: 0;
        }

        /* Center era filters */
        .era-filter-row {
            justify-content: center;
        }

        /* Make "Create Your Custom Ranking" header bigger */
        .weight-section-title {
            font-family: 'Unna', serif;
            font-size: 1.6rem;
            font-weight: 700;
            color: #e0e0e8;
            letter-spacing: -0.01em;
        }

        /* Weight slider labels - bigger text */
        .weight-slider-label {
            font-size: 1.05rem;
            color: var(--text);
            font-weight: 500;
        }

        /* Weight sliders - half width */
        .weight-slider-row {
            display: grid;
            grid-template-columns: 200px 1fr 50px;
            align-items: center;
            gap: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .weight-slider-input {
            width: 100%;
        }

        .weight-slider-value {
            font-size: 1rem;
        }

        /* Sticky search bar at bottom - COMPACT */
        .search-bar-fixed {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, rgba(10,10,15,0.98), rgba(10,10,15,1));
            border-top: 1px solid #2a2a38;
            padding: 0.5rem 1rem;
            z-index: 1000;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.4);
        }

        .search-wrapper-fixed {
            position: relative;
            max-width: 600px;
            margin: 0 auto;
        }

        .search-input-fixed {
            width: 100%;
            padding: 0.6rem 2.5rem 0.6rem 1rem;
            background: rgba(20,20,28,0.9);
            border: 1px solid #3a3a48;
            color: #e0e0e8;
            border-radius: 6px;
            font-size: 0.95rem;
            font-family: 'Source Sans 3', sans-serif;
            transition: all 0.2s ease;
            line-height: 1.4;
        }

        .search-input-fixed:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
        }

        .search-input-fixed::placeholder {
            color: #64748b;
        }

        .search-clear-btn {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #64748b;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.25rem;
            transition: color 0.2s;
        }

        .search-clear-btn:hover {
            color: #d4af37;
        }

        /* Ensure main content has padding for fixed search bar - COMPACT */
        main {
            padding-bottom: 50px;
        }

        /* Methodology badge - not full width, inline */
        .methodology-badge {
            display: inline-flex !important;
            width: auto !important;
        }

        /* Mobile adjustments */
        @media (max-width: 600px) {
            .filters-toggle-btn {
                font-size: 1rem;
                padding: 0.875rem 1rem;
            }

            .weight-section-title {
                font-size: 1.3rem;
            }

            .weight-slider-label {
                font-size: 0.9rem;
            }

            .weight-slider-row {
                grid-template-columns: 140px 1fr 45px;
                gap: 0.75rem;
            }

            .search-bar-fixed {
                padding: 0.5rem 0.75rem;
            }

            .search-input-fixed {
                font-size: 0.9rem;
                padding: 0.55rem 2.25rem 0.55rem 0.875rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <!-- Ornate corner decorations -->
        <div style="position:absolute;top:20px;left:20px;width:50px;height:50px;border-top:1px solid #d4af37;border-left:1px solid #d4af37;"></div>
        <div style="position:absolute;top:20px;right:20px;width:50px;height:50px;border-top:1px solid #d4af37;border-right:1px solid #d4af37;"></div>
        <div style="position:absolute;bottom:20px;left:20px;width:50px;height:50px;border-bottom:1px solid #d4af37;border-left:1px solid #d4af37;"></div>
        <div style="position:absolute;bottom:20px;right:20px;width:50px;height:50px;border-bottom:1px solid #d4af37;border-right:1px solid #d4af37;"></div>

        <!-- Center diamond ornament -->
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.2rem;color:#d4af37;opacity:0.5;"></div>

        <!-- Top decorative line -->
        <div style="position:absolute;top:0;left:10%;right:10%;height:1px;background:linear-gradient(90deg,transparent,#d4af37,#d4af37,transparent);"></div>

        <h1>Dynamic Rank Engine</h1>

        <!-- Ornate subtitle -->
        <p class="subtitle" style="font-family:'Source Sans 3',sans-serif;font-size:1.2rem;font-weight:300;color:#8a8a9a;letter-spacing:0.3em;text-transform:uppercase;margin-top:0.5rem;position:relative;display:inline-block;">
            <span style="position:absolute;left:-40px;top:50%;width:30px;height:1px;background:linear-gradient(90deg,transparent,#d4af37);"></span>
            TV Drama Rankings  Powered by Custom Algorithms
            <span style="position:absolute;right:-40px;top:50%;width:30px;height:1px;background:linear-gradient(90deg,#d4af37,transparent);"></span>
        </p>

        <div class="stats" style="margin-top:2rem;display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;align-items:center;">
            <div style="text-align:center;">
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">103</span>
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Shows Ranked</span>
            </div>
            <div style="width:1px;height:30px;background:#2a2a38;"></div>
            <div style="text-align:center;">
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">103</span>
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Showing</span>
            </div>
            <div style="width:1px;height:30px;background:#2a2a38;"></div>
            <div style="text-align:center;">
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">7</span>
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Evaluation Dimensions</span>
            </div>
            <div style="width:1px;height:30px;background:#2a2a38;"></div>
            <div style="text-align:center;">
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Updated</span>
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">February 2026</span>
            </div>
        </div>

        <!-- Bottom decorative line -->
        <div style="position:absolute;bottom:0;left:15%;right:15%;height:1px;background:linear-gradient(90deg,transparent,#252532,#d4af37,#252532,transparent);"></div>
    </header>

    <!-- Methodology Modal -->
    <div class="modal-overlay" id="methodology-modal">
        <div class="modal-content">
            <button class="modal-close" id="close-methodology"></button>
            <h2>Ranking Methodology</h2>

            <div class="methodology-nav">
                <a href="#methodology-intro">Season Selection</a>
                <a href="#methodology-categories">Core Metrics</a>
                <a href="#methodology-multipliers">Multipliers</a>
                <a href="#methodology-scale">Scoring Scale</a>
            </div>

            <div class="methodology-section methodology-intro" id="methodology-intro">
                <div class="intro-header">
                    <h3>Season Selection Philosophy</h3>
                </div>
                <p>Shows are evaluated at their peak. When later seasons decline in quality, only the excellent seasons are included in the ranking.</p>
                <p class="intro-example"><strong>Example:</strong> Game of Thrones (S1-4) includes only the first four seasons-the show at its absolute best, before the source material ran out and quality declined.</p>
                <p>This mirrors how we select only the best shows for inclusion: we're ranking television excellence, not mediocrity. A show's weakest moments don't define it-its strongest do.</p>
            </div>

            <div class="methodology-section" id="methodology-categories">
                <div class="methodology-categories">
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Characters & Acting</h3>
                            <span class="category-weight">20%</span>
                        </div>
                        <p>Characters & Acting evaluates whether the people on screen feel like real individuals making authentic, internally consistent choices. It assesses depth of characterization, psychological believability, meaningful change over time, and the strength of the ensemble as a whole-not just standout leads. Acting is judged on embodiment and invisibility: performances should disappear into the role rather than draw attention to themselves. High scores reflect characters who feel autonomous, linger in the viewer's mind, and remain compelling beyond the immediate plot.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>World Building</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>World Building measures how fully realized and self-sustaining the show's world feels. This includes consistency of rules, institutions, cultures, and social structures, as well as the sense that life exists beyond the immediate story being told. A strong world feels navigable and durable: the viewer can understand how power works, how people live, and what pressures shape behavior without constant exposition. High scores are reserved for worlds that feel lived-in, coherent, and capable of supporting many stories.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Cinematography</h3>
                            <span class="category-weight">10%</span>
                        </div>
                        <p>Cinematography evaluates the visual craft and intentionality behind how the story is told. This includes framing, camera movement, lighting, color, composition, and visual rhythm, with emphasis on coherence and meaning rather than surface beauty. High-scoring shows demonstrate a distinctive and consistent visual language, where the camera communicates narrative or character information rather than merely recording events. A key marker is recognizability: the ability to identify the show from a single frame.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Visual Spectacle</h3>
                            <span class="category-weight">10%</span>
                        </div>
                        <p>Visual Spectacle measures the impact, ambition, and sustained presence of what is shown on screen. This includes large-scale environments, meticulously crafted sets, production design, visual effects, and striking or immersive imagery. Frequency matters when spectacle is genuinely sustained across scenes and episodes. Spectacle may also arise from novelty and exposure-revealing places, systems, or ways of life the viewer has rarely or never seen, captured with authority and detail. The focus is on how visually compelling and memorable the on-screen world is, whether through epic construction or grounded realism.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Conceptual Density</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>Conceptual Density measures how many distinct ideas a series meaningfully engages with, and how well those ideas are integrated into the narrative. These concepts may be political, philosophical, social, moral, or institutional, but must be dramatized through story, character, and world rather than stated directly. Higher scores reflect shows that sustain multiple independent concepts across episodes and seasons, explore them from different angles, and allow them to interact or conflict. The emphasis is on breadth of ideas combined with coherent execution, not symbolic interpretation or tone.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Narrative Drive</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>Narrative Drive assesses how effectively the story pulls the viewer forward. This includes pacing, clarity of stakes, escalation, and whether each episode meaningfully advances the narrative. A strong sense of drive does not require constant action; slower or quieter series can score highly if momentum, tension, or curiosity are consistently maintained. Filler, stalling, or structural wheel-spinning lowers the score. The core question is whether the story moves with purpose.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Narrative Path & Resolution</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>Narrative Path & Resolution evaluates how effectively a series fulfills the narrative promises it introduces. This includes how many story loops, mysteries, arcs, or tensions are opened, how deliberately they are carried forward, and how meaningfully they are resolved. High scores reflect disciplined loop management, strong closure rates, and payoffs that feel earned-often enhancing or recontextualizing earlier material. Ambiguity is not penalized when intentional and coherent, but unresolved, rushed, or undermining resolutions reduce the score. This category rewards narrative discipline over novelty.</p>
                    </div>
                </div>
            </div>

            <div class="methodology-section methodology-multipliers" id="methodology-multipliers">
                <h3>Episode Count Multipliers</h3>
                <p>Longer shows that maintain quality across many hours are rewarded. The multiplier system recognizes that sustaining excellence over 60+ episodes is harder than over 6.</p>
                <div class="multiplier-grid">
                    <div class="multiplier-item multiplier-negative"><span class="multiplier-range">10 episodes</span><span class="multiplier-value">0.96</span><span class="multiplier-label">Miniseries</span></div>
                    <div class="multiplier-item multiplier-negative"><span class="multiplier-range">11-20 episodes</span><span class="multiplier-value">0.95</span><span class="multiplier-label">Short Series</span></div>
                    <div class="multiplier-item multiplier-negative"><span class="multiplier-range">21-30 episodes</span><span class="multiplier-value">0.97</span><span class="multiplier-label">Limited Series</span></div>
                    <div class="multiplier-item multiplier-neutral"><span class="multiplier-range">31-40 episodes</span><span class="multiplier-value">1.00</span><span class="multiplier-label">Baseline</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">41-50 episodes</span><span class="multiplier-value">1.02</span><span class="multiplier-label">Standard Run</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">51-60 episodes</span><span class="multiplier-value">1.03</span><span class="multiplier-label">Extended</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">61-75 episodes</span><span class="multiplier-value">1.04</span><span class="multiplier-label">Long-Form</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">76-100 episodes</span><span class="multiplier-value">1.05</span><span class="multiplier-label">Epic Run</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">100+ episodes</span><span class="multiplier-value">1.06</span><span class="multiplier-label">Maximum Bonus</span></div>
                </div>
            </div>

            <div class="methodology-section methodology-tier" id="methodology-scale">
                <h3>The Scoring Scale</h3>
                <p>Every category uses a strict 1-10 scale calibrated for precision:</p>
                <div class="score-scale">
                    <div class="scale-item scale-perfect"><span class="scale-score">10</span><span class="scale-label">Perfect</span><span class="scale-desc">The gold standard, no meaningful flaws</span></div>
                    <div class="scale-item scale-incredible"><span class="scale-score">9</span><span class="scale-label">Incredible</span><span class="scale-desc">Near-flawless, only minor imperfections</span></div>
                    <div class="scale-item scale-exceptional"><span class="scale-score">8</span><span class="scale-label">Exceptional</span><span class="scale-desc">Among the very best in television</span></div>
                    <div class="scale-item scale-very-good"><span class="scale-score">7</span><span class="scale-label">Very Good</span><span class="scale-desc">Clearly stands out, memorable</span></div>
                    <div class="scale-item scale-good"><span class="scale-score">6</span><span class="scale-label">Good</span><span class="scale-desc">Noticeably above typical TV</span></div>
                    <div class="scale-item scale-average"><span class="scale-score">5</span><span class="scale-label">Average</span><span class="scale-desc">Competent but unremarkable</span></div>
                    <div class="scale-item scale-below"><span class="scale-score">4</span><span class="scale-label">Below Average</span><span class="scale-desc">Ranges from mediocre to poor</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Category Detail Modal -->
    <div class="modal-overlay" id="category-modal">
        <div class="modal-content category-modal-content">
            <button class="modal-close" id="close-category">&times;</button>
            <div class="category-modal-header">
                <h2 id="category-modal-title">Category</h2>
                <span class="category-modal-weight" id="category-modal-weight">20%</span>
            </div>
            <p class="category-modal-desc" id="category-modal-desc">Description</p>
        </div>
    </div>

    <!-- Show Detail Modal -->
    <div class="modal-overlay" id="show-detail-modal">
        <div class="modal-content show-detail-content">
            <button class="modal-close" id="close-show-detail">&times;</button>
            <div id="show-detail-body">
                <!-- Content loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- Quick Compare Bar -->
    <div class="quick-compare" id="quick-compare">
        <div class="quick-compare-label"> Quick Compare (Pinned Shows)</div>
        <div class="pinned-shows" id="pinned-shows"></div>
    </div>

    <div class="filters-section">
        <!-- Collapse/Expand Button -->
        <button class="filters-toggle-btn" id="filters-toggle">
            <span class="filters-toggle-icon"></span>
            <span class="filters-toggle-text">Filters & Settings</span>
            <span class="filters-toggle-arrow"></span>
        </button>
        
        <!-- Collapsible Content -->
        <div class="filters-content" id="filters-content">
            <!-- Era Filter -->
            <div class="filter-group">
                <label class="filter-label">Era</label>
                <div class="filter-row era-filter-row" id="era-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="last3mo">Last 3 Months</button>
                    <button class="filter-btn" data-filter="last6mo">Last 6 Months</button>
                    <button class="filter-btn" data-filter="thisYear">This Year</button>
                    <button class="filter-btn" data-filter="2020s">2020s</button>
                    <button class="filter-btn" data-filter="2010s">2010s</button>
                    <button class="filter-btn" data-filter="2000s">2000s</button>
                    <button class="filter-btn" data-filter="pre2000">Pre-2000</button>
                </div>
            </div>

            <!-- Genre Filter -->
            <div class="filter-group">
                <label class="filter-label">Genre</label>
                <div class="genre-pills" id="genre-filters">
                    <button class="genre-pill active" data-genre="all">All</button>
                    <button class="genre-pill" data-genre="drama">Drama</button>
                    <button class="genre-pill" data-genre="crime">Crime</button>
                    <button class="genre-pill" data-genre="thriller">Thriller</button>
                    <button class="genre-pill" data-genre="mystery">Mystery</button>
                    <button class="genre-pill" data-genre="sci-fi">Sci-Fi</button>
                    <button class="genre-pill" data-genre="fantasy">Fantasy</button>
                    <button class="genre-pill" data-genre="historical">Historical</button>
                    <button class="genre-pill" data-genre="comedy">Comedy</button>
                    <button class="genre-pill" data-genre="action">Action</button>
                    <button class="genre-pill" data-genre="horror">Horror</button>
                    <button class="genre-pill" data-genre="western">Western</button>
                    <button class="genre-pill" data-genre="superhero">Superhero</button>
                    <button class="genre-pill" data-genre="cop-show">Cop Show</button>
                </div>
            </div>

            <!-- Active Filters -->
            <div class="active-filters" id="active-filters"></div>

            <!-- Weight Adjustment -->
            <div class="filter-group weight-group">
                <div class="weight-header">
                    <span class="weight-section-title">Create Your Custom Ranking</span>
                    <div class="weight-header-right">
                        <div class="weight-total-badge" id="weight-total-badge">
                            <span>Total</span>
                            <span id="weight-total-value">100%</span>
                        </div>
                        <button class="weight-reset-btn" id="reset-weights">Reset</button>
                    </div>
                </div>
                
                <div class="weight-subheader">
                    <span class="weight-guidance">Adjust sliders until total reaches 100%</span>
                    <a href="#" class="weight-methodology-btn" id="open-methodology">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M3 12h18M3 18h18M7 6v12M17 6v12M7 9h.01M17 9h.01"/>
                        </svg>
                        Methodology &amp; Criteria
                    </a>
                </div>
                
                <div class="weight-sliders" id="weight-sliders">
                    <!-- Generated by JS -->
                </div>
                <div class="weight-warning" id="weight-warning"> Total must equal 100%</div>

                <!-- Episode Multiplier -->
                <div class="episode-multiplier-section">
                    <label class="episode-multiplier-checkbox">
                        <input type="checkbox" id="multiplier-toggle">
                        <span>Episode Multiplier</span>
                    </label>
                    <span class="episode-multiplier-desc">
                        Adjusts scores based on episode count  longer series get bonuses (1.021.06) for sustaining quality
                    </span>
                </div>
            </div>
        </div>
    </div>

    <main>
        <div class="results-header">
            <div class="results-count">Showing <strong id="results-num">100</strong> shows</div>
            <select class="sort-select" id="sort-select">
                <option value="rank">Sort by Rank</option>
                <option value="score-desc">Highest Score</option>
                <option value="score-asc">Lowest Score</option>
                <option value="year-desc">Newest First</option>
                <option value="year-asc">Oldest First</option>
                <option value="title">Alphabetical</option>
            </select>
        </div>
        <div class="show-list" id="rankings" style="display: flex;"></div>
        <div class="no-results" id="no-results" style="display: none;">
            <p>None</p>
        </div>
        <!-- Score Save Bar -->
        <div class="score-save-bar" id="score-save-bar">
            <span class="modified-count" id="modified-count">0 shows modified</span>
            <button class="save-btn" id="save-scores-btn">Save to localStorage</button>
            <button class="export-btn" id="export-scores-btn">Download JSON</button>
            <button class="import-btn" id="import-scores-btn">Import</button>
            <input type="file" id="import-scores-file" accept=".json" style="display:none;">
            <button class="reset-btn" id="reset-scores-btn">Reset All</button>
        </div>
    </main>
    
    <!-- Sticky Search Bar at Bottom -->
    <div class="search-bar-fixed" id="search-bar-fixed">
        <div class="search-wrapper-fixed">
            <input type="text" class="search-input-fixed" placeholder="Search shows..." id="search">
            <button class="search-clear-btn" id="search-clear"></button>
        </div>
    </div>

    <script>
        const TMDB_API_KEY = 'ca9b21cb89de2d1debed1050f603d7ad';
        const TMDB_IMAGE_BASE = 'https://image.tmdb.org/t/p/w500';

        // Dynamic data loading from JSON
        let shows = [];

        async function loadShowsData() {
            try {
                const response = await fetch('data/shows/index.json');
                const data = await response.json();
                shows = data.shows;
                console.log(`Loaded ${shows.length} shows from JSON`);
                initScoreSystem();
                renderShows();
            } catch (error) {
                console.error('Failed to load shows from JSON, using fallback:', error);
                // Fallback to embedded data if JSON fails
                shows = FALLBACK_SHOWS;
                initScoreSystem();
                renderShows();
            }
        }

        // Fallback embedded data (synced from master list)
        const FALLBACK_SHOWS = [
            { rank: 1, title: "Game of Thrones (S1-4)", year: 2011, month: 4, episodes: 40, char: 10, world: 10, cine: 8, spect: 9.5, conc: 9, drive: 10, resol: 9, final: 9.45, genres: ["fantasy", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/1XS1oqL89opfnbLl8WnZY1O1uJx.jpg", backdrop: "https://image.tmdb.org/t/p/w780/zZqpAXxVSBtxV9qPBcscfXBcL2w.jpg" },
            { rank: 2, title: "Breaking Bad", year: 2008, month: 1, episodes: 62, char: 9, world: 7, cine: 10, spect: 6, conc: 9, drive: 10, resol: 10, final: 8.8, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/ztkUQFLlC19CCMYHW9o1zWhJRNq.jpg", backdrop: "https://image.tmdb.org/t/p/w780/tsRy63Mu5cu8etL1X7ZLyf7UP1M.jpg" },
            { rank: 3, title: "Band of Brothers", year: 2001, month: 9, episodes: 10, char: 7.5, world: 9, cine: 8, spect: 10, conc: 8.5, drive: 9, resol: 9.5, final: 8.7, genres: ["drama", "historical", "war"], poster: "https://image.tmdb.org/t/p/w500/8JMXquNmdMUy2n2RgW8gfOM0O3l.jpg", backdrop: "" },
            { rank: 4, title: "The Wire", year: 2002, month: 6, episodes: 60, char: 9, world: 9.5, cine: 6.5, spect: 7.5, conc: 10, drive: 7.5, resol: 9.5, final: 8.68, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/4lbclFySvugI51fwsyxBTOm4DqK.jpg", backdrop: "https://image.tmdb.org/t/p/w780/layPSOJGckJv3PXZDIVluMq69mn.jpg" },
            { rank: 5, title: "Better Call Saul", year: 2015, month: 2, episodes: 63, char: 8.5, world: 7, cine: 9, spect: 6, conc: 8, drive: 9, resol: 10, final: 8.3, genres: ["crime", "drama"], poster: "https://image.tmdb.org/t/p/w500/fC2HDm5t0kHl7mTm7jxMR31b7by.jpg", backdrop: "https://image.tmdb.org/t/p/w780/qsnXwGS7KBbX4JLqHvICngtR8qg.jpg" },
            { rank: 6, title: "The Sopranos", year: 1999, month: 1, episodes: 86, char: 9.5, world: 8, cine: 6.5, spect: 5, conc: 9.5, drive: 8, resol: 9.5, final: 8.3, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/rTc7ZXdroqjkKivFPvCPX0Ru7uw.jpg", backdrop: "https://image.tmdb.org/t/p/w780/gMqQY6SwuhKg1LvmiTxKX6YrINr.jpg" },
            { rank: 7, title: "Boardwalk Empire", year: 2010, month: 9, episodes: 56, char: 9, world: 9, cine: 8, spect: 9.5, conc: 8.5, drive: 6.5, resol: 7.5, final: 8.28, genres: ["crime", "drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/kL6SqlVPpfAof2nQbh1VxkUuXBQ.jpg", backdrop: "https://image.tmdb.org/t/p/w780/o1oSRBiSwkim3xdK0OJ2LwpWL89.jpg" },
            { rank: 8, title: "Chernobyl", year: 2019, month: 5, episodes: 5, char: 7, world: 8, cine: 9, spect: 8, conc: 8, drive: 8.5, resol: 9, final: 8.13, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/hlLXt2tOPT6RRnjiUmoxyG1LTFi.jpg", backdrop: "https://image.tmdb.org/t/p/w780/3URK0z9PzpVNJrGE7XOuyy6KFzk.jpg" },
            { rank: 9, title: "Succession", year: 2018, month: 6, episodes: 39, char: 9, world: 7, cine: 8, spect: 7, conc: 7.5, drive: 8.5, resol: 9, final: 8.1, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/z0XiwdrCQ9yVIr4O0pxzaAYRxdW.jpg", backdrop: "https://image.tmdb.org/t/p/w780/bcdUYUFk8GdpZJPiSAas9UeocLH.jpg" },
            { rank: 10, title: "Deadwood", year: 2004, month: 3, episodes: 36, char: 9, world: 8.5, cine: 7, spect: 8, conc: 9, drive: 7, resol: 7.5, final: 8.1, genres: ["drama", "western"], poster: "https://image.tmdb.org/t/p/w500/fWwxYAuqY4Na7fKI3Qq2nFWCwG8.jpg", backdrop: "https://image.tmdb.org/t/p/w780/391ixi0wVbFtFLQnOy8ZncWv2io.jpg" },
            { rank: 11, title: "The Expanse", year: 2015, month: 12, episodes: 62, char: 7.5, world: 10, cine: 7, spect: 10, conc: 8, drive: 7.5, resol: 7, final: 8.07, genres: ["sci-fi", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/8djpxDeWpINnGhjpFXQjnBe6zbx.jpg", backdrop: "https://image.tmdb.org/t/p/w780/7yKtaRij2giAj0s09F6gmB8XIje.jpg" },
            { rank: 12, title: "Mad Men", year: 2007, month: 7, episodes: 92, char: 8.5, world: 8, cine: 8, spect: 8.5, conc: 9, drive: 7, resol: 7.5, final: 8.07, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/7v8iCNzKFpdlrCMcqCoJyn74Nsa.jpg", backdrop: "https://image.tmdb.org/t/p/w780/zP5SftyPx2VCdly369kTVVNIcT3.jpg" },
            { rank: 13, title: "Andor", year: 2022, month: 9, episodes: 12, char: 7.5, world: 9, cine: 8, spect: 8.5, conc: 8, drive: 7.5, resol: 8, final: 8.03, genres: ["sci-fi", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/khZqmwHQicTYoS7Flreb9EddFZC.jpg", backdrop: "https://image.tmdb.org/t/p/w780/kCGwvjpqM1owt9kI4pkYPJWJLvc.jpg" },
            { rank: 14, title: "True Detective S1", year: 2014, month: 1, episodes: 8, char: 8, world: 7, cine: 10, spect: 6, conc: 8, drive: 9, resol: 8, final: 8, genres: ["crime", "mystery", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/cuV2O5ZyDLHSOWzg3nLVljp1ubw.jpg", backdrop: "https://image.tmdb.org/t/p/w780/bPLRjO2pcBx0WL73WUPzuNzQ3YN.jpg" },
            { rank: 15, title: "The Leftovers", year: 2014, month: 6, episodes: 28, char: 7, world: 8, cine: 8, spect: 7, conc: 9, drive: 8, resol: 9, final: 8, genres: ["drama", "fantasy", "mystery"], poster: "https://image.tmdb.org/t/p/w500/ri8xr223xBb2TeHX3GKypvQPV2B.jpg", backdrop: "" },
            { rank: 16, title: "Dark", year: 2017, month: 12, episodes: 26, char: 7, world: 7.5, cine: 8.5, spect: 6.5, conc: 9, drive: 8.5, resol: 9, final: 8, genres: ["sci-fi", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/7CFCzWIZZcnxHke3yAQiGPWXHwF.jpg", backdrop: "https://image.tmdb.org/t/p/w780/2VpSajCTI26zddsp5cSjqfCBKEa.jpg" },
            { rank: 17, title: "The Americans", year: 2013, month: 1, episodes: 75, char: 8.5, world: 7.5, cine: 7, spect: 5, conc: 8.5, drive: 8, resol: 10, final: 8, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/w1UBlxEXhbKe8sp0fxFZh7MqTce.jpg", backdrop: "https://image.tmdb.org/t/p/w780/wyspZaGs7CXceV3Ct7NJhcKNDkn.jpg" },
            { rank: 18, title: "Shogun (2024)", year: 2024, month: 2, episodes: 10, char: 8, world: 9, cine: 9, spect: 9, conc: 7, drive: 7.5, resol: 7, final: 7.98, genres: ["drama", "historical", "action"], poster: "https://image.tmdb.org/t/p/w500/7O4iVfOMQmdCSxhOg1WnzG1AgYT.jpg", backdrop: "https://image.tmdb.org/t/p/w780/bwSmgmd90hCWwqOKQYTEraeOZhJ.jpg" },
            { rank: 19, title: "Babylon Berlin", year: 2017, month: 10, episodes: 36, char: 7.5, world: 8.5, cine: 9, spect: 9, conc: 8, drive: 7.5, resol: 7, final: 7.95, genres: ["drama", "historical", "thriller"], poster: "https://image.tmdb.org/t/p/w500/om7Ri353ddUsg0gDJsOZIQJBRwL.jpg", backdrop: "https://image.tmdb.org/t/p/w780/yjkRAd9pjVgB0kpZSQXvMQB8yZC.jpg" },
            { rank: 20, title: "House of the Dragon", year: 2022, month: 8, episodes: 18, char: 8, world: 9, cine: 8, spect: 9.5, conc: 7.5, drive: 7.5, resol: 6.5, final: 7.92, genres: ["fantasy", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/7QMsOTMUswlwxJP0rTTZfmz2tX2.jpg", backdrop: "https://image.tmdb.org/t/p/w780/2xGcSLyTAzConiHAByWqhfLiatT.jpg" },
            { rank: 21, title: "The Knick", year: 2014, month: 8, episodes: 20, char: 8, world: 8.5, cine: 9.5, spect: 8, conc: 8, drive: 8, resol: 6, final: 7.92, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/oeEqDSIVOi6q0GcZj8L9Q6G7fGC.jpg", backdrop: "https://image.tmdb.org/t/p/w780/tYS0vmYyEdklxiTxHL7M4OPv5iC.jpg" },
            { rank: 22, title: "Penny Dreadful", year: 2014, month: 5, episodes: 27, char: 8.5, world: 8, cine: 9, spect: 9, conc: 8, drive: 7.5, resol: 6, final: 7.92, genres: ["horror", "drama", "fantasy"], poster: "https://image.tmdb.org/t/p/w500/hQSdrXBYTbLGHYDIseHkBOPXTgL.jpg", backdrop: "" },
            { rank: 23, title: "Angels in America", year: 2003, month: 12, episodes: 6, char: 8, world: 7, cine: 8, spect: 7, conc: 9, drive: 7, resol: 9, final: 7.9, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/rrV0kCmzcP8oB00gemSZDns90rb.jpg", backdrop: "https://image.tmdb.org/t/p/w780/ijs6Ilt8B2xHyZeePXZivQI15Cc.jpg" },
            { rank: 25, title: "Station Eleven", year: 2021, month: 12, episodes: 10, char: 7.5, world: 8, cine: 9, spect: 7, conc: 9, drive: 7, resol: 8, final: 7.9, genres: ["drama", "sci-fi"], poster: "https://image.tmdb.org/t/p/w500/xWlhMOzRxUpu4uzkWcDQOaESCE.jpg", backdrop: "https://image.tmdb.org/t/p/w780/qzSjrYSZAWrjhg6Yf3hCcfJE4o0.jpg" },
            { rank: 26, title: "Silo", year: 2023, month: 5, episodes: 20, char: 7.5, world: 8.5, cine: 8, spect: 8, conc: 8, drive: 8.5, resol: 7, final: 7.9, genres: ["sci-fi", "drama", "mystery"], poster: "https://image.tmdb.org/t/p/w500/c2OijvbFEXBW1onbzuvENr4CGQB.jpg", backdrop: "https://image.tmdb.org/t/p/w780/4XccmjsOmQZw8S2iW1wvlvmb5v1.jpg" },
            { rank: 27, title: "Euphoria", year: 2019, month: 6, episodes: 17, char: 8, world: 7, cine: 9.5, spect: 8.5, conc: 8, drive: 8, resol: 7, final: 7.9, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/3Q0hd3heuWwDWpwcDkhQOA6TYWI.jpg", backdrop: "https://image.tmdb.org/t/p/w780/9KnIzPCv9XpWA0MqmwiKBZvV1Sj.jpg" },
            { rank: 28, title: "Ozark", year: 2017, month: 7, episodes: 44, char: 8.5, world: 7, cine: 8.5, spect: 6, conc: 8.5, drive: 8, resol: 8, final: 7.88, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/pCGyPVrI9Fzw6rE1Pvi4BIXF6ET.jpg", backdrop: "https://image.tmdb.org/t/p/w780/aatG9iVAUL7U7OyFEmupESpOrD2.jpg" },
            { rank: 29, title: "Severance", year: 2022, month: 2, episodes: 19, char: 7.5, world: 8.5, cine: 8.5, spect: 6.5, conc: 9, drive: 9, resol: 6, final: 7.88, genres: ["sci-fi", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/pPHpeI2X1qEd1CS1SeyrdhZ4qnT.jpg", backdrop: "https://image.tmdb.org/t/p/w780/hxNOoINeMW92caBjtPEHaejhcK0.jpg" },
            { rank: 30, title: "Hannibal", year: 2013, month: 4, episodes: 39, char: 8, world: 6.5, cine: 10, spect: 8.5, conc: 8.5, drive: 6.5, resol: 8, final: 7.88, genres: ["crime", "thriller", "horror", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/pbV2eLnKSIm1epSZt473UYfqaeZ.jpg", backdrop: "https://image.tmdb.org/t/p/w780/vlG182ZY2WMzD5bjFZNnhyvv5V4.jpg" },
            { rank: 31, title: "Adolescence", year: 2025, month: 3, episodes: 4, char: 8, world: 5, cine: 9.5, spect: 5, conc: 9, drive: 9, resol: 9, final: 7.85, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/20i4nShZZg1g1VFHSB8xpaYM4r7.jpg", backdrop: "https://image.tmdb.org/t/p/w780/llZodlkVKRkTdUsiRxvn8h80hhx.jpg" },
            { rank: 32, title: "Wolf Hall", year: 2015, month: 1, episodes: 6, char: 8, world: 8.5, cine: 9, spect: 7, conc: 8.5, drive: 7, resol: 7, final: 7.85, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/dGuiMtUQBGxM3ZWosphO2MdYw8o.jpg", backdrop: "https://image.tmdb.org/t/p/w780/dkyZ6k3FNcC5mxh2X2h48dfFMay.jpg" },
            { rank: 33, title: "Rome", year: 2005, month: 8, episodes: 22, char: 8, world: 9, cine: 7, spect: 9, conc: 8, drive: 8, resol: 6, final: 7.85, genres: ["drama", "historical", "action"], poster: "https://image.tmdb.org/t/p/w500/xLy4fhXUPocgMyFNPFac3tY4jwY.jpg", backdrop: "" },
            { rank: 34, title: "The Penguin", year: 2024, month: 10, episodes: 8, char: 8, world: 8.5, cine: 8, spect: 6.5, conc: 8, drive: 7.5, resol: 8, final: 7.85, genres: ["crime", "drama", "superhero"], poster: "https://image.tmdb.org/t/p/w500/vOWcqC4oDQws1doDWLO7d3dh5qc.jpg", backdrop: "https://image.tmdb.org/t/p/w780/vV5LKWmuysEe5wsuZJGbdiL5XJ2.jpg" },
            { rank: 35, title: "The Haunting of Hill House", year: 2018, month: 10, episodes: 10, char: 7.5, world: 7, cine: 9, spect: 7, conc: 8, drive: 8, resol: 8.5, final: 7.83, genres: ["horror", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/38PkhBGRQtmVx2drvPik3F42qHO.jpg", backdrop: "" },
            { rank: 36, title: "Mr. Robot", year: 2015, month: 5, episodes: 45, char: 8, world: 7, cine: 9, spect: 6, conc: 8, drive: 7.5, resol: 9, final: 7.82, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/kv1nRqgebSsREnd7vdC2pSGjpLo.jpg", backdrop: "https://image.tmdb.org/t/p/w780/hZOuVkhAWX9viLJuaIsMh8cM3Jz.jpg" },
            { rank: 37, title: "It's a Sin", year: 2021, month: 1, episodes: 5, char: 8, world: 7.5, cine: 8, spect: 6, conc: 8, drive: 8, resol: 8.5, final: 7.8, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/tUaNS4b5TIiP1SwpHCYCbUoGpHG.jpg", backdrop: "https://image.tmdb.org/t/p/w780/rrZKfEVvC6itMIaEfDHwWRYaULw.jpg" },
            { rank: 38, title: "Rectify", year: 2013, month: 4, episodes: 30, char: 9, world: 7, cine: 8.5, spect: 5, conc: 9, drive: 6, resol: 9, final: 7.8, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/tm9nQe9165cyjnTz8NB50izwcpJ.jpg", backdrop: "https://image.tmdb.org/t/p/w780/cwosIp9M9B6TcLnv0bBg86s0WUx.jpg" },
            { rank: 39, title: "The Underground Railroad", year: 2021, month: 5, episodes: 10, char: 7.5, world: 8, cine: 10, spect: 8, conc: 9, drive: 6, resol: 7, final: 7.8, genres: ["drama", "fantasy", "historical"], poster: "https://image.tmdb.org/t/p/w500/CrrTqw7LHafnbdH9UcK60aOZSm.jpg", backdrop: "https://image.tmdb.org/t/p/w780/miJlszZR9rYtRhMPrSobnMAJsrl.jpg" },
            { rank: 40, title: "Halt and Catch Fire", year: 2014, month: 6, episodes: 40, char: 8.5, world: 7.5, cine: 7, spect: 5, conc: 8, drive: 8, resol: 9, final: 7.78, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/AtKo2gANo2QBgZN9ebTAa8hXnvv.jpg", backdrop: "https://image.tmdb.org/t/p/w780/o35U5p9J3eDsqrgfCpYUOO2lsuG.jpg" },
            { rank: 41, title: "Beef", year: 2023, month: 4, episodes: 10, char: 8, world: 6.5, cine: 8, spect: 5, conc: 8, drive: 9, resol: 9, final: 7.78, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/4b4v7RnPhNyPEaVGFarEuo74r8W.jpg", backdrop: "" },
            { rank: 42, title: "Sharp Objects", year: 2018, month: 7, episodes: 8, char: 8.5, world: 7.5, cine: 9, spect: 6, conc: 8, drive: 7, resol: 8, final: 7.78, genres: ["drama", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/1SGovj2qDdkJexvhFiXllj9EYfu.jpg", backdrop: "" },
            { rank: 43, title: "Utopia (UK)", year: 2013, month: 1, episodes: 12, char: 7.5, world: 7.5, cine: 10, spect: 7, conc: 8, drive: 9, resol: 6, final: 7.78, genres: ["sci-fi", "thriller", "drama"], poster: "https://image.tmdb.org/t/p/w500/snOU6W5CU7aGVSVu29wBWzdzNzi.jpg", backdrop: "https://image.tmdb.org/t/p/w780/kDhUhjBrJKVPvSSAmqncCJFvKFD.jpg" },
            { rank: 44, title: "The Last of Us", year: 2023, month: 1, episodes: 16, char: 8, world: 7.5, cine: 8, spect: 8, conc: 8, drive: 8, resol: 7, final: 7.78, genres: ["drama", "action", "sci-fi"], poster: "https://image.tmdb.org/t/p/w500/dmo6TYuuJgaYinXBPjrgG9mB5od.jpg", backdrop: "https://image.tmdb.org/t/p/w780/lY2DhbA7Hy44fAKddr06UrXWWaQ.jpg" },
            { rank: 45, title: "Black Mirror", year: 2011, month: 12, episodes: 29, char: 7, world: 7, cine: 8, spect: 7, conc: 9.5, drive: 8, resol: 8, final: 7.78, genres: ["sci-fi", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/seN6rRfN0I6n8iDXjlSMk1QjNcq.jpg", backdrop: "" },
            { rank: 46, title: "Peaky Blinders", year: 2013, month: 9, episodes: 36, char: 8, world: 8, cine: 9, spect: 8.5, conc: 7, drive: 7.5, resol: 7, final: 7.78, genres: ["crime", "drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/vUUqzWa2LnHIVqkaKVlVGkVcZIW.jpg", backdrop: "https://image.tmdb.org/t/p/w780/l8v3gJDlASN0lNn51gR8zQJsu5O.jpg" },
            { rank: 47, title: "Foundation", year: 2021, month: 9, episodes: 30, char: 7, world: 8.5, cine: 8.5, spect: 9.5, conc: 8, drive: 7, resol: 7, final: 7.78, genres: ["sci-fi", "drama"], poster: "https://image.tmdb.org/t/p/w500/tg9I5pOY4M9CKj8U0cxVBTsm5eh.jpg", backdrop: "https://image.tmdb.org/t/p/w780/u23G9KZregWHs1use6ir1fX27gl.jpg" },
            { rank: 48, title: "Twin Peaks: The Return", year: 2017, month: 5, episodes: 18, char: 8, world: 8, cine: 9, spect: 9, conc: 9, drive: 5, resol: 7, final: 7.75, genres: ["mystery", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/lA9CNSdo50iQPZ8A2fyVpMvJZAf.jpg", backdrop: "https://image.tmdb.org/t/p/w780/dZklTql88IDOmkC3JAYQSTgyK6f.jpg" },
            { rank: 49, title: "Patrick Melrose", year: 2018, month: 5, episodes: 5, char: 8.5, world: 7, cine: 8, spect: 6, conc: 8, drive: 7, resol: 9, final: 7.75, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/t6ubZ1Bpu0elTzA8tT2mxkrfpxA.jpg", backdrop: "" },
            { rank: 50, title: "The Shield", year: 2002, month: 3, episodes: 88, char: 8.5, world: 7, cine: 6, spect: 5, conc: 7, drive: 9, resol: 10, final: 7.75, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/AfdZXqqlFsPUEfi6kWWWthxw7Nz.jpg", backdrop: "https://image.tmdb.org/t/p/w780/ro0tlgnsco4SwbdAgmscLkSlMSL.jpg" },
            { rank: 51, title: "For All Mankind", year: 2019, month: 11, episodes: 40, char: 7, world: 8, cine: 8, spect: 8, conc: 8, drive: 8, resol: 7.5, final: 7.72, genres: ["sci-fi", "drama"], poster: "https://image.tmdb.org/t/p/w500/JP3DItWMbrrLiKR5AYUfpsNf2b.jpg", backdrop: "https://image.tmdb.org/t/p/w780/9OQ5BIITkJwRJo9JA6AlCfJIGBQ.jpg" },
            { rank: 52, title: "The Queen's Gambit", year: 2020, month: 10, episodes: 7, char: 7.5, world: 7, cine: 8.5, spect: 7, conc: 7, drive: 9, resol: 8, final: 7.7, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/zU0htwkhNvBQdVSIKB9s6hgVeFK.jpg", backdrop: "https://image.tmdb.org/t/p/w780/5N5dSOrysuquExvn8Gpp5jMEf6u.jpg" },
            { rank: 53, title: "Generation Kill", year: 2008, month: 7, episodes: 7, char: 7, world: 8, cine: 8, spect: 7, conc: 9, drive: 7, resol: 8, final: 7.7, genres: ["drama", "war", "action"], poster: "https://image.tmdb.org/t/p/w500/wiihoYOODwh82xVzPoiaztlg6c9.jpg", backdrop: "https://image.tmdb.org/t/p/w780/oenEPUQI0ZgeaBWB5dYGrzrA9gN.jpg" },
            { rank: 54, title: "Midnight Mass", year: 2021, month: 9, episodes: 7, char: 7.5, world: 7, cine: 8, spect: 6, conc: 9, drive: 7, resol: 9, final: 7.7, genres: ["horror", "drama", "mystery"], poster: "https://image.tmdb.org/t/p/w500/iYoMZYVD775MtBYJfv6OGY1FsnL.jpg", backdrop: "https://image.tmdb.org/t/p/w780/cEcjzVue5lfMuUVZ40zvQhzFIRF.jpg" },
            { rank: 55, title: "The White Lotus", year: 2021, month: 7, episodes: 21, char: 7.5, world: 7, cine: 9, spect: 8, conc: 8, drive: 7, resol: 8, final: 7.7, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/gbSaK9v1CbcYH1ISgbM7XObD2dW.jpg", backdrop: "https://image.tmdb.org/t/p/w780/rCTLaPwuApDx8vLGjYZ9pRl7zRB.jpg" },
            { rank: 56, title: "Godless", year: 2017, month: 11, episodes: 7, char: 7.5, world: 8, cine: 9, spect: 8, conc: 7, drive: 7, resol: 8, final: 7.7, genres: ["drama", "western"], poster: "https://image.tmdb.org/t/p/w500/ePOD0ofGWFDTbZR84QhM7kpYMPX.jpg", backdrop: "" },
            { rank: 57, title: "Fargo", year: 2014, month: 4, episodes: 51, char: 8, world: 6.5, cine: 8.5, spect: 6, conc: 8.5, drive: 8, resol: 8, final: 7.7, genres: ["crime", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/6U9CPeD8obHzweikFhiLhpc7YBT.jpg", backdrop: "https://image.tmdb.org/t/p/w780/4jrSbRpLqpvYJtLKncaxZVC47EW.jpg" },
            { rank: 58, title: "Girls", year: 2012, month: 4, episodes: 62, char: 8.5, world: 7, cine: 7, spect: 5, conc: 8.5, drive: 8.5, resol: 8, final: 7.7, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/ikyT3hnELofnYRsPIqVGgUhDbOT.jpg", backdrop: "" },
            { rank: 59, title: "When They See Us", year: 2019, month: 5, episodes: 4, char: 7.5, world: 6.5, cine: 8, spect: 5, conc: 9, drive: 8, resol: 9, final: 7.67, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/oPv3nNtkuc6EPEql5lgdOuQNHuG.jpg", backdrop: "" },
            { rank: 60, title: "Westworld", year: 2016, month: 10, episodes: 36, char: 7.5, world: 8.5, cine: 8.5, spect: 9, conc: 9.5, drive: 6.5, resol: 5, final: 7.67, genres: ["sci-fi", "western", "drama"], poster: "https://image.tmdb.org/t/p/w500/8MfgyFHf7XEboZJPZXCIDqqiz6e.jpg", backdrop: "https://image.tmdb.org/t/p/w780/rX5hvSRB2k4YoIvRg6Zky52rWk0.jpg" },
            { rank: 61, title: "Pose", year: 2018, month: 6, episodes: 26, char: 7.5, world: 8, cine: 8, spect: 7, conc: 8, drive: 7, resol: 8, final: 7.65, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/5f23i30nFJz0nrd3DGheOCqXa2P.jpg", backdrop: "" },
            { rank: 62, title: "The Pacific", year: 2010, month: 3, episodes: 10, char: 7, world: 8, cine: 8, spect: 9, conc: 7, drive: 7, resol: 8, final: 7.6, genres: ["drama", "war", "historical"], poster: "https://image.tmdb.org/t/p/w500/x9Y1IMFdY8Ma222KcQadFEau0EB.jpg", backdrop: "" },
            { rank: 63, title: "The Crown", year: 2016, month: 11, episodes: 60, char: 7.5, world: 8, cine: 9, spect: 8.5, conc: 7, drive: 7, resol: 7, final: 7.6, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/1DDE0Z2Y805rqfkEjPbZsMLyPwa.jpg", backdrop: "https://image.tmdb.org/t/p/w780/8VXhcrl5z2I1zEU9X3pkkNrZlD.jpg" },
            { rank: 64, title: "The Handmaid's Tale", year: 2017, month: 4, episodes: 56, char: 7.5, world: 8.5, cine: 8.5, spect: 7.5, conc: 8.5, drive: 7, resol: 6, final: 7.6, genres: ["drama", "sci-fi", "thriller"], poster: "https://image.tmdb.org/t/p/w500/eGUT7j3n3rn5yGihlCgwUnD70HV.jpg", backdrop: "https://image.tmdb.org/t/p/w780/vz5jePQ6hHuICnxXgybjc0jJWt6.jpg" },
            { rank: 65, title: "Squid Game", year: 2021, month: 9, episodes: 18, char: 6.5, world: 7.5, cine: 8, spect: 7.5, conc: 7, drive: 9, resol: 8, final: 7.58, genres: ["thriller", "drama", "sci-fi"], poster: "https://image.tmdb.org/t/p/w500/1QdXdRYfktUSONkl1oD5gc6Be0s.jpg", backdrop: "https://image.tmdb.org/t/p/w780/2meX1nMdScFOoV4370rqHWKmXhY.jpg" },
            { rank: 66, title: "Stranger Things", year: 2016, month: 7, episodes: 42, char: 7, world: 8.5, cine: 8, spect: 8, conc: 6.5, drive: 8.5, resol: 7, final: 7.58, genres: ["sci-fi", "horror", "drama"], poster: "https://image.tmdb.org/t/p/w500/uOOtwVbSr4QDjAGIifLDwpb2Pdl.jpg", backdrop: "https://image.tmdb.org/t/p/w780/mLKN1dsimKPiXCZ48KED0X8a02t.jpg" },
            { rank: 67, title: "Escape at Dannemora", year: 2018, month: 11, episodes: 7, char: 8, world: 7, cine: 8, spect: 5, conc: 7, drive: 8, resol: 9, final: 7.55, genres: ["drama", "crime", "thriller"], poster: "https://image.tmdb.org/t/p/w500/odk6ccUtUJlGTzPApKS6s4CTTrK.jpg", backdrop: "https://image.tmdb.org/t/p/w780/4ymYfH8PL5ztov7vc5k5QePfsh9.jpg" },
            { rank: 68, title: "The Plot Against America", year: 2020, month: 3, episodes: 6, char: 7.5, world: 8, cine: 8, spect: 6, conc: 9, drive: 7, resol: 7, final: 7.55, genres: ["drama", "historical", "thriller"], poster: "https://image.tmdb.org/t/p/w500/rC5GUHvKxlk3WPyCh4mQ5q6HDxG.jpg", backdrop: "" },
            { rank: 69, title: "The Bureau", year: 2015, month: 4, episodes: 50, char: 8, world: 7.5, cine: 7, spect: 5, conc: 8, drive: 8, resol: 8, final: 7.52, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/noxbt8KgVz21vdLINfQ5P1CmflS.jpg", backdrop: "https://image.tmdb.org/t/p/w780/iOqmSCyVnhb9qzrhOjXBm3usnzI.jpg" },
            { rank: 70, title: "Mare of Easttown", year: 2021, month: 4, episodes: 7, char: 8, world: 7.5, cine: 7, spect: 5, conc: 7, drive: 8, resol: 9, final: 7.52, genres: ["crime", "drama", "mystery", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/78aK4Msbr22A5PGa6PZV0pAvdwf.jpg", backdrop: "https://image.tmdb.org/t/p/w780/8wfSBRCTGKJqu4KBrjQBUizftiP.jpg" },
            { rank: 71, title: "Narcos", year: 2015, month: 8, episodes: 30, char: 7.5, world: 8, cine: 8, spect: 7, conc: 7, drive: 8, resol: 7, final: 7.5, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/rTmal9fDbwh5F0waol2hq35U4ah.jpg", backdrop: "https://image.tmdb.org/t/p/w780/qx8XQund44cecIJiX2Yb4SUeiT.jpg" },
            { rank: 72, title: "Dopesick", year: 2021, month: 10, episodes: 8, char: 7.5, world: 7, cine: 7, spect: 5, conc: 9, drive: 8, resol: 8, final: 7.5, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/qW8Gpddy29faTcD7VuyKjwLXbKU.jpg", backdrop: "https://image.tmdb.org/t/p/w780/2WZCkqtPz5R2Dd2gMc1rTI1dMle.jpg" },
            { rank: 73, title: "Borgen", year: 2010, month: 9, episodes: 40, char: 8, world: 7, cine: 7, spect: 5, conc: 8, drive: 8, resol: 8, final: 7.45, genres: ["drama", "political"], poster: "https://image.tmdb.org/t/p/w500/3wB4R3Ac3lKSQWKpoU0zeRY8XqL.jpg", backdrop: "" },
            { rank: 74, title: "Happy Valley", year: 2014, month: 4, episodes: 18, char: 8, world: 7, cine: 7, spect: 5, conc: 7, drive: 8, resol: 9, final: 7.45, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/xZK5iQSrn2mouZEk2PwyLPCwa4u.jpg", backdrop: "" },
            { rank: 75, title: "Justified", year: 2010, month: 3, episodes: 78, char: 8, world: 7.5, cine: 7, spect: 5, conc: 7.5, drive: 8, resol: 8, final: 7.45, genres: ["crime", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/ie1quhMk09lDtvtAyQAHTu09R9Z.jpg", backdrop: "https://image.tmdb.org/t/p/w780/uinrziSwEmS6s8VvGBad5sed7bF.jpg" },
            { rank: 76, title: "Broadchurch", year: 2013, month: 3, episodes: 24, char: 7.5, world: 7, cine: 8, spect: 6, conc: 7, drive: 8, resol: 8, final: 7.4, genres: ["crime", "drama", "mystery", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/2NhBFUTg5KVBmGwafxtLwVdsqrr.jpg", backdrop: "" },
            { rank: 77, title: "Six Feet Under", year: 2001, month: 6, episodes: 63, char: 8, world: 6.5, cine: 7, spect: 5, conc: 8, drive: 6, resol: 10, final: 7.38, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/sCgzLaVlFy8KxtxRPvt1V5MNTDb.jpg", backdrop: "" },
            { rank: 78, title: "Watchmen (2019)", year: 2019, month: 10, episodes: 9, char: 7, world: 7.5, cine: 7.5, spect: 8, conc: 7, drive: 7, resol: 8, final: 7.38, genres: ["drama", "sci-fi", "superhero"], poster: "https://image.tmdb.org/t/p/w500/m8rWq3j73ZGhDuSCZWMMoE9ePH1.jpg", backdrop: "" },
            { rank: 79, title: "Interview with the Vampire", year: 2022, month: 10, episodes: 18, char: 8, world: 7.5, cine: 8, spect: 7, conc: 7, drive: 7, resol: 7, final: 7.38, genres: ["horror", "drama", "fantasy"], poster: "https://image.tmdb.org/t/p/w500/Afv4pPhqVMg2wOmhuDLiGUw4r4O.jpg", backdrop: "https://image.tmdb.org/t/p/w780/r5RoeEWuslP6svlZsHsCKo7TZs7.jpg" },
            { rank: 80, title: "Twin Peaks", year: 1990, month: 4, episodes: 30, char: 7.5, world: 8, cine: 8, spect: 7, conc: 9, drive: 6, resol: 6, final: 7.35, genres: ["mystery", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/lA9CNSdo50iQPZ8A2fyVpMvJZAf.jpg", backdrop: "https://image.tmdb.org/t/p/w780/dZklTql88IDOmkC3JAYQSTgyK6f.jpg" },
            { rank: 81, title: "Big Little Lies", year: 2017, month: 2, episodes: 14, char: 7.5, world: 7, cine: 8, spect: 7, conc: 7, drive: 7, resol: 8, final: 7.35, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/b4HNJOc2N6SGyEhf2RagdpAKBK6.jpg", backdrop: "https://image.tmdb.org/t/p/w780/18inwHlpKnK9mt02wFBJoIVKXI.jpg" },
            { rank: 82, title: "The Boys", year: 2019, month: 7, episodes: 40, char: 7, world: 7.5, cine: 7, spect: 8, conc: 8, drive: 8, resol: 6, final: 7.32, genres: ["superhero", "action", "drama"], poster: "https://image.tmdb.org/t/p/w500/2zmTngn1tYC1AvfnrFLhxeD82hz.jpg", backdrop: "https://image.tmdb.org/t/p/w780/czffzEgaBko4mXW84B1J1EnQBzo.jpg" },
            { rank: 83, title: "True Detective S3", year: 2019, month: 1, episodes: 8, char: 7.5, world: 7.5, cine: 8, spect: 6, conc: 7, drive: 7, resol: 8, final: 7.32, genres: ["crime", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/cuV2O5ZyDLHSOWzg3nLVljp1ubw.jpg", backdrop: "https://image.tmdb.org/t/p/w780/bPLRjO2pcBx0WL73WUPzuNzQ3YN.jpg" },
            { rank: 84, title: "The Bear", year: 2022, month: 6, episodes: 28, char: 7.5, world: 6.5, cine: 9, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.28, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/eKfVzzEazSIjJMrw9ADa2x8ksLz.jpg", backdrop: "https://image.tmdb.org/t/p/w780/wHNwlE6ftEpgjVbdhLXOtv1hLs0.jpg" },
            { rank: 85, title: "The Day of the Jackal", year: 2024, month: 11, episodes: 8, char: 7.5, world: 7, cine: 8, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.25, genres: ["thriller", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/tYLecM3WSEjlkKhkGiH5G68Dprm.jpg", backdrop: "https://image.tmdb.org/t/p/w780/enVrO8TRkdT8dmYXTfI4sEjR5Kp.jpg" },
            { rank: 86, title: "Slow Horses", year: 2022, month: 4, episodes: 18, char: 8, world: 7, cine: 7, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.25, genres: ["thriller", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/dnpatlJrEPiDSn5fzgzvxtiSnMo.jpg", backdrop: "https://image.tmdb.org/t/p/w780/fZJs6xgU9dqIg9phIXjZAZOInzy.jpg" },
            { rank: 87, title: "Homeland", year: 2011, month: 10, episodes: 96, char: 8, world: 7, cine: 7, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.25, genres: ["drama", "thriller", "action"], poster: "https://image.tmdb.org/t/p/w500/6GAvS2e6VIRsms9FpVt33PsCoEW.jpg", backdrop: "https://image.tmdb.org/t/p/w780/aSGSxGMTP893DPMCvMl9AdnEICE.jpg" },
            { rank: 88, title: "The Marvelous Mrs. Maisel", year: 2017, month: 3, episodes: 43, char: 7, world: 7, cine: 8, spect: 7, conc: 7, drive: 7, resol: 8, final: 7.25, genres: ["drama", "comedy", "historical"], poster: "https://image.tmdb.org/t/p/w500/zS7fQiOZiKCVH2vlYSiIsFWW8hh.jpg", backdrop: "https://image.tmdb.org/t/p/w780/ywQtHG17LZhAFZyZtBflhtFMtJ7.jpg" },
            { rank: 89, title: "Friday Night Lights", year: 2006, month: 10, episodes: 76, char: 8, world: 7.5, cine: 7, spect: 5, conc: 7, drive: 7, resol: 8, final: 7.22, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/Eu7MzZY1DldJ683z7vLkILHNRD.jpg", backdrop: "" },
            { rank: 90, title: "Downton Abbey", year: 2010, month: 9, episodes: 52, char: 7, world: 8, cine: 8, spect: 8, conc: 6, drive: 7, resol: 7, final: 7.2, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/7HgDYRYjym4BwbhKaqTQq771SKb.jpg", backdrop: "" },
            { rank: 91, title: "Line of Duty", year: 2012, month: 3, episodes: 37, char: 7.5, world: 7, cine: 7, spect: 5, conc: 7, drive: 9, resol: 7, final: 7.2, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/ysGUKnnR1pGYIndjXWcjupGbWpS.jpg", backdrop: "https://image.tmdb.org/t/p/w780/2HtnTJLs3CDUTu6ug8rib5vNnU2.jpg" },
            { rank: 92, title: "The Killing (DK)", year: 2007, month: 1, episodes: 40, char: 7.5, world: 7, cine: 7, spect: 5, conc: 7, drive: 8, resol: 8, final: 7.2, genres: ["crime", "drama", "mystery", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/iLvnc1aK2b2PNQhbyn4IVpDcmcX.jpg", backdrop: "" },
            { rank: 93, title: "Gomorrah", year: 2014, month: 4, episodes: 58, char: 7, world: 8, cine: 8, spect: 6, conc: 7, drive: 7, resol: 7, final: 7.15, genres: ["crime", "drama"], poster: "https://image.tmdb.org/t/p/w500/cXsagSyQQki9vTbV3TTxRCGIIlQ.jpg", backdrop: "https://image.tmdb.org/t/p/w780/qVyqPzx6wD3Wm3HD4iy3PrJYxGX.jpg" },
            { rank: 94, title: "Lost", year: 2004, month: 9, episodes: 121, char: 9, world: 8, cine: 7.5, spect: 7.5, conc: 7, drive: 9.5, resol: 1, final: 7.13, genres: ["sci-fi", "drama", "mystery"], poster: "https://image.tmdb.org/t/p/w500/og6S0aTZU6YUJAbqxeKjCa3kY1E.jpg", backdrop: "https://image.tmdb.org/t/p/w780/yUOFocKDW7MCC5isx4FK8A68QFp.jpg" },
            { rank: 95, title: "Battlestar Galactica", year: 2004, month: 10, episodes: 75, char: 7, world: 7, cine: 7, spect: 8, conc: 8, drive: 7, resol: 6, final: 7.1, genres: ["sci-fi", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/99PJSbcO2LeM10uOGWeFihNp77j.jpg", backdrop: "" },
            { rank: 96, title: "Barry", year: 2018, month: 3, episodes: 32, char: 7.5, world: 6, cine: 8, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.1, genres: ["crime", "drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/j1XpwD11f0BAEI7pX6UdMhUVX2F.jpg", backdrop: "https://image.tmdb.org/t/p/w780/wBWIVs9abyjayqOwaQ7oTYzEn6V.jpg" },
            { rank: 97, title: "Killing Eve", year: 2018, month: 4, episodes: 32, char: 7, world: 6.5, cine: 7, spect: 7, conc: 7, drive: 8, resol: 7, final: 7.08, genres: ["thriller", "action", "drama"], poster: "https://image.tmdb.org/t/p/w500/4wKhTVw8aGq5AZMa0Q1spERdi7n.jpg", backdrop: "https://image.tmdb.org/t/p/w780/2eR0H27Us1tvbjd95oW7WhiKioC.jpg" },
            { rank: 98, title: "The X-Files", year: 1993, month: 9, episodes: 218, char: 7.5, world: 7.5, cine: 7, spect: 7, conc: 7, drive: 7, resol: 6, final: 7.02, genres: ["sci-fi", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/rcBx0p8h51LHceyhquYMxbspJQu.jpg", backdrop: "https://image.tmdb.org/t/p/w780/w00lfexrsOeR25dO4hsWhbcUnmD.jpg" },
            { rank: 99, title: "Oz", year: 1997, month: 7, episodes: 56, char: 7.5, world: 7.5, cine: 6, spect: 5, conc: 8, drive: 7, resol: 7, final: 7.02, genres: ["crime", "drama"], poster: "https://image.tmdb.org/t/p/w500/oTQ9PUnCgf9CimYeWuDGp8iaT07.jpg", backdrop: "https://image.tmdb.org/t/p/w780/6QjToSAi4Z7TjJ4D18jz9HecYYb.jpg" },
            { rank: 100, title: "24", year: 2001, month: 11, episodes: 192, char: 7, world: 6, cine: 6, spect: 7, conc: 6, drive: 9.5, resol: 7, final: 6.97, genres: ["action", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/iq6yrZ5LEDXf1ArCOYLq8PIUBpV.jpg", backdrop: "https://image.tmdb.org/t/p/w780/be6mDIMv7cg8duWkcYVnTB8rphO.jpg" },
            { rank: 101, title: "Hill Street Blues", year: 1981, month: 12, episodes: 146, char: 7.5, world: 7, cine: 6, spect: 5, conc: 8, drive: 7, resol: 7, final: 6.95, genres: ["drama", "crime", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/elvCmYxmwVzv2va3rLKponOJOfm.jpg", backdrop: "" },
            { rank: 102, title: "The Affair", year: 2014, month: 10, episodes: 53, char: 7.5, world: 6.5, cine: 8, spect: 5, conc: 8, drive: 7, resol: 6, final: 6.92, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/8scKJeu6GoxMqpt7UO5aMeU0TOn.jpg", backdrop: "https://image.tmdb.org/t/p/w780/1uJaqlVeZ5MQvwCX7TRwf3dIduA.jpg" },
            { rank: 103, title: "Homicide: Life on the Street", year: 1993, month: 1, episodes: 122, char: 7.5, world: 6.5, cine: 6, spect: 5, conc: 7, drive: 7, resol: 7, final: 6.72, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/nb5310xlFjx5r9TnpKoaOTQsAlP.jpg", backdrop: "https://image.tmdb.org/t/p/w780/gyc2Zf7656uoyqRqToeDS52axCi.jpg" }
        ];

        // Initialize by loading from JSON (or fallback)
        loadShowsData();

        const list = document.getElementById('rankings');
        const noResults = document.getElementById('no-results');
        const searchInput = document.getElementById('search');
        const scoreFilter = document.getElementById('score-filter');
        const scoreValue = document.getElementById('score-value');
        const sortSelect = document.getElementById('sort-select');
        const resultsNum = document.getElementById('results-num');
        const activeFiltersEl = document.getElementById('active-filters');

        let currentGenres = ['all'];
        let currentEras = [];
        let minScore = 6.5;
        let searchTerm = '';
        let sortBy = 'rank';
        let viewMode = 'list';

        // Default weights - CURRENT CONFIG: 25/15/5/5/15/15/20
        const defaultWeights = { char: 25, world: 15, cine: 5, spect: 5, conc: 15, drive: 15, resol: 20 };
        let weights = { ...defaultWeights };

        // Episode multiplier toggle
        let multiplierEnabled = false;

        // Score override system
        const baseScores = {};
        const activeScores = {};
        const modifiedShows = new Set();
        const catKeys = ['char', 'world', 'cine', 'spect', 'conc', 'drive', 'resol'];

        function recalcFinal(show) {
            let val = (
                (show.char * weights.char) +
                (show.world * weights.world) +
                (show.cine * weights.cine) +
                (show.spect * weights.spect) +
                (show.conc * weights.conc) +
                (show.drive * weights.drive) +
                (show.resol * weights.resol)
            ) / 100;

            // Apply episode multiplier if enabled
            if (multiplierEnabled) {
                val = val * getMultiplier(show.episodes);
            }

            show.final = parseFloat(val.toFixed(2));
            return show.final;
        }

        function initScoreSystem() {
            // VERSION CHECK: Clear old storage if version mismatch
            const STORAGE_VERSION = 'v3-full-fix';
            const storedVersion = localStorage.getItem('tvranked_version');
            if (storedVersion !== STORAGE_VERSION) {
                console.log('Clearing old localStorage (version mismatch)');
                localStorage.removeItem('tvranked_score_overrides');
                localStorage.setItem('tvranked_version', STORAGE_VERSION);
            }

            // Build base scores from loaded data
            shows.forEach(show => {
                baseScores[show.title] = {};
                activeScores[show.title] = {};
                catKeys.forEach(key => {
                    baseScores[show.title][key] = show[key];
                    activeScores[show.title][key] = show[key];
                });

                // Calculate the base weighted average (unmultiplied)
                const baseWeighted = (
                    (show.char * weights.char) +
                    (show.world * weights.world) +
                    (show.cine * weights.cine) +
                    (show.spect * weights.spect) +
                    (show.conc * weights.conc) +
                    (show.drive * weights.drive) +
                    (show.resol * weights.resol)
                ) / 100;

                // Store the unmultiplied weighted average as base.final for recalculation reference
                baseScores[show.title].calculatedFinal = parseFloat(baseWeighted.toFixed(2));

                // USE JSON FINAL: Trust the AI-adjusted final score from JSON rather than recalculating
                // The JSON final values have been human-reviewed and adjusted
                baseScores[show.title].final = show.final;
            });

            // Re-sort after recalculating all finals
            shows.sort((a, b) => b.final - a.final);
            shows.forEach((show, idx) => { show.rank = idx + 1; });

            // Restore overrides from localStorage
            try {
                const saved = localStorage.getItem('tvranked_score_overrides');
                if (saved) {
                    const overrides = JSON.parse(saved);
                    Object.keys(overrides).forEach(title => {
                        const show = shows.find(s => s.title === title);
                        if (!show) return;
                        const changes = overrides[title];
                        let hasChange = false;
                        catKeys.forEach(key => {
                            if (changes[key] !== undefined && changes[key] !== baseScores[title][key]) {
                                show[key] = changes[key];
                                activeScores[title][key] = changes[key];
                                hasChange = true;
                            }
                        });
                        if (hasChange) {
                            modifiedShows.add(title);
                            recalcFinal(show);
                        }
                    });

                    if (modifiedShows.size > 0) {
                        // Re-sort and re-rank
                        shows.sort((a, b) => b.final - a.final);
                        shows.forEach((show, idx) => { show.rank = idx + 1; });
                        updateSaveBar();
                    }
                }
            } catch (e) {
                console.error('Failed to restore score overrides:', e);
            }
        }

        function updateSaveBar() {
            const bar = document.getElementById('score-save-bar');
            const countEl = document.getElementById('modified-count');
            if (!bar) return;
            if (modifiedShows.size > 0) {
                bar.classList.add('visible');
                countEl.textContent = modifiedShows.size + ' show' + (modifiedShows.size !== 1 ? 's' : '') + ' modified';
            } else {
                bar.classList.remove('visible');
            }
        }

        function saveOverridesToStorage() {
            const overrides = {};
            modifiedShows.forEach(title => {
                overrides[title] = {};
                catKeys.forEach(key => {
                    overrides[title][key] = activeScores[title][key];
                });
            });
            localStorage.setItem('tvranked_score_overrides', JSON.stringify(overrides));
        }

        // Initialize weight sliders
        function initWeightSliders() {
            const slidersContainer = document.getElementById('weight-sliders');
            if (!slidersContainer) return;

            slidersContainer.innerHTML = categories.map(cat => `
                <div class="weight-slider-row">
                    <div class="weight-slider-header">
                        <span class="weight-slider-label">${cat.label}</span>
                        <span class="weight-slider-value" id="weight-value-${cat.key}">${weights[cat.key]}%</span>
                    </div>
                    <div class="weight-slider-wrapper">
                        <input type="range" class="weight-slider-input" data-key="${cat.key}" min="0" max="100" step="5" value="${weights[cat.key]}">
                    </div>
                </div>
            `).join('');

            // Add event listeners
            slidersContainer.querySelectorAll('.weight-slider-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    const key = e.target.dataset.key;
                    const value = parseInt(e.target.value);
                    weights[key] = value;
                    document.getElementById(`weight-value-${key}`).textContent = value + '%';
                    updateWeightTotal();

                    // Auto-recalculate if total = 100
                    const total = Object.values(weights).reduce((a, b) => a + b, 0);
                    if (total === 100) {
                        recalculateWithWeights();
                    }
                });
            });

            updateWeightTotal();
        }

        function updateWeightTotal() {
            const total = Object.values(weights).reduce((a, b) => a + b, 0);
            const totalEl = document.getElementById('weight-total-value');
            const totalBadge = document.getElementById('weight-total-badge');
            const warningEl = document.getElementById('weight-warning');

            totalEl.textContent = total + '%';

            // Update badge styling based on total
            if (total === 100) {
                totalBadge.classList.add('valid');
                totalBadge.classList.remove('invalid');
                warningEl.classList.remove('visible');
            } else {
                totalBadge.classList.add('invalid');
                totalBadge.classList.remove('valid');
                warningEl.textContent = total > 100 ? ` Total ${total}% - reduce to 100%` : ` Total must equal 100%`;
                warningEl.classList.add('visible');
            }
        }

        // Reset weights
        document.getElementById('reset-weights')?.addEventListener('click', () => {
            weights = { ...defaultWeights };
            initWeightSliders();
            recalculateWithWeights();
        });

        // Recalculate rankings with custom weights (shared function)
        function recalculateWithWeights() {
            // Recalculate final scores using activeScores (includes modifications)
            shows.forEach(show => {
                const active = activeScores[show.title];
                if (!active) return;

                // Calculate weighted average from category scores
                let val = (
                    (active.char * weights.char) +
                    (active.world * weights.world) +
                    (active.cine * weights.cine) +
                    (active.spect * weights.spect) +
                    (active.conc * weights.conc) +
                    (active.drive * weights.drive) +
                    (active.resol * weights.resol)
                ) / 100;

                // Apply multiplier if enabled
                if (multiplierEnabled) {
                    val = val * getMultiplier(show.episodes);
                }

                show.final = parseFloat(val.toFixed(2));

                // CRITICAL: Also update baseScores.final (unmultiplied) for slider calculations
                // This ensures slider deltas are calculated from the correct baseline
                const baseUnmultiplied = (
                    (baseScores[show.title].char * weights.char) +
                    (baseScores[show.title].world * weights.world) +
                    (baseScores[show.title].cine * weights.cine) +
                    (baseScores[show.title].spect * weights.spect) +
                    (baseScores[show.title].conc * weights.conc) +
                    (baseScores[show.title].drive * weights.drive) +
                    (baseScores[show.title].resol * weights.resol)
                ) / 100;
                baseScores[show.title].final = parseFloat(baseUnmultiplied.toFixed(2));
            });

            // Re-sort shows by new final score
            shows.sort((a, b) => b.final - a.final);

            // Update ranks
            shows.forEach((show, idx) => {
                show.rank = idx + 1;
            });

            // Re-render
            renderShows();
        }

        // Legacy button handler (kept for compatibility)
        document.getElementById('recalc-weights')?.addEventListener('click', () => {
            const total = Object.values(weights).reduce((a, b) => a + b, 0);
            if (total !== 100) return;
            recalculateWithWeights();
        });

        // Episode multiplier toggle
        document.getElementById('multiplier-toggle')?.addEventListener('change', (e) => {
            multiplierEnabled = e.target.checked;
            console.log('Multiplier toggled:', multiplierEnabled, 'shows loaded:', shows.length);

            if (shows.length === 0) {
                console.log('No shows loaded yet!');
                return;
            }

            // DEBUG: Show top 5 before
            console.log('BEFORE toggle - Top 5:');
            shows.slice(0, 5).forEach((s, i) => console.log(`  ${i+1}. ${s.title.substring(0,20)}: ${s.final}`));

            // Recalculate using activeScores (includes any slider modifications)
            shows.forEach(show => {
                const active = activeScores[show.title];
                if (!active) return;

                // Calculate from active scores (current values) with current weights
                let val = (
                    (active.char * weights.char) +
                    (active.world * weights.world) +
                    (active.cine * weights.cine) +
                    (active.spect * weights.spect) +
                    (active.conc * weights.conc) +
                    (active.drive * weights.drive) +
                    (active.resol * weights.resol)
                ) / 100;

                // Then apply multiplier if enabled
                if (multiplierEnabled) {
                    val = val * getMultiplier(show.episodes);
                }

                show.final = parseFloat(val.toFixed(2));
            });

            // Sort and re-rank
            shows.sort((a, b) => b.final - a.final);
            shows.forEach((s, i) => { s.rank = i + 1; });

            // DEBUG: Show top 5 after
            console.log('AFTER toggle - Top 5:');
            shows.slice(0, 5).forEach((s, i) => console.log(`  ${i+1}. ${s.title.substring(0,20)}: ${s.final}`));

            renderShows();
        });

        // Initialize on load
        // Note: initWeightSliders called after categories is defined

        const categories = [
            { key: 'char', label: 'Characters & Acting', weight: '25%', desc: 'Characters & Acting evaluates whether the people on screen feel like real individuals making authentic, internally consistent choices. It assesses depth of characterization, psychological believability, meaningful change over time, and the strength of the ensemble as a whole-not just standout leads. Acting is judged on embodiment and invisibility: performances should disappear into the role rather than draw attention to themselves. High scores reflect characters who feel autonomous, linger in the viewer\'s mind, and remain compelling beyond the immediate plot.' },
            { key: 'world', label: 'World Building', weight: '15%', desc: 'World Building measures how fully realized and self-sustaining the show\'s world feels. This includes consistency of rules, institutions, cultures, and social structures, as well as the sense that life exists beyond the immediate story being told. A strong world feels navigable and durable: the viewer can understand how power works, how people live, and what pressures shape behavior without constant exposition. High scores are reserved for worlds that feel lived-in, coherent, and capable of supporting many stories.' },
            { key: 'cine', label: 'Cinematography', weight: '5%', desc: 'Cinematography evaluates the visual craft and intentionality behind how the story is told. This includes framing, camera movement, lighting, color, composition, and visual rhythm, with emphasis on coherence and meaning rather than surface beauty. High-scoring shows demonstrate a distinctive and consistent visual language, where the camera communicates narrative or character information rather than merely recording events. A key marker is recognizability: the ability to identify the show from a single frame.' },
            { key: 'spect', label: 'Visual Spectacle', weight: '5%', desc: 'Visual Spectacle measures the impact, ambition, and sustained presence of what is shown on screen. This includes large-scale environments, meticulously crafted sets, production design, visual effects, and striking or immersive imagery. Frequency matters when spectacle is genuinely sustained across scenes and episodes. Spectacle may also arise from novelty and exposure-revealing places, systems, or ways of life the viewer has rarely or never seen, captured with authority and detail. The focus is on how visually compelling and memorable the on-screen world is, whether through epic construction or grounded realism.' },
            { key: 'conc', label: 'Conceptual Density', weight: '15%', desc: 'Conceptual Density measures how many distinct ideas a series meaningfully engages with, and how well those ideas are integrated into the narrative. These concepts may be political, philosophical, social, moral, or institutional, but must be dramatized through story, character, and world rather than stated directly. Higher scores reflect shows that sustain multiple independent concepts across episodes and seasons, explore them from different angles, and allow them to interact or conflict. The emphasis is on breadth of ideas combined with coherent execution, not symbolic interpretation or tone.' },
            { key: 'drive', label: 'Narrative Drive', weight: '15%', desc: 'Narrative Drive assesses how effectively the story pulls the viewer forward. This includes pacing, clarity of stakes, escalation, and whether each episode meaningfully advances the narrative. A strong sense of drive does not require constant action; slower or quieter series can score highly if momentum, tension, or curiosity are consistently maintained. Filler, stalling, or structural wheel-spinning lowers the score. The core question is whether the story moves with purpose.' },
            { key: 'resol', label: 'Narrative Path & Resolution', weight: '20%', desc: 'Narrative Path & Resolution evaluates how effectively a series fulfills the narrative promises it introduces. This includes how many story loops, mysteries, arcs, or tensions are opened, how deliberately they are carried forward, and how meaningfully they are resolved. High scores reflect disciplined loop management, strong closure rates, and payoffs that feel earned-often enhancing or recontextualizing earlier material. Ambiguity is not penalized when intentional and coherent, but unresolved, rushed, or undermining resolutions reduce the score. This category rewards narrative discipline over novelty.' }
        ];

        // Initialize weight sliders after categories is defined
        initWeightSliders();

        function getEra(year, month) {
            const now = new Date();
            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth() + 1; // 1-12

            // This year (current year)
            if (year === currentYear) return 'thisYear';

            // Last 3 months: current year if we're in Jan-Mar, or previous year
            if (currentMonth <= 3) {
                // In Jan-Mar 2026, last 3 months = shows from 2025 or 2026
                if (year === currentYear || year === currentYear - 1) return 'last3mo';
            } else {
                // After March, last 3 months means shows from this year
                if (year === currentYear && month >= currentMonth - 2) return 'last3mo';
            }

            // Last 6 months: current year if we're in Jan-Jun, or previous year
            if (currentMonth <= 6) {
                // In Jan-Jun 2026, last 6 months = shows from 2025 or 2026
                if (year === currentYear || year === currentYear - 1) return 'last6mo';
            } else {
                // After June, last 6 months means shows from this year
                if (year === currentYear && month >= currentMonth - 5) return 'last6mo';
            }

            // Decades
            if (year >= 2020) return '2020s';
            if (year >= 2010) return '2010s';
            if (year >= 2000) return '2000s';
            return 'pre2000';
        }

        function getTier(score) {
            if (score >= 9) return 'gold';
            if (score >= 7) return 'silver';
            return 'bronze';
        }

        function getMultiplier(episodes) {
            if (episodes <= 10) return 0.96;
            if (episodes <= 20) return 0.95;
            if (episodes <= 30) return 0.97;
            if (episodes <= 40) return 1.00;
            if (episodes <= 50) return 1.02;
            if (episodes <= 60) return 1.03;
            if (episodes <= 75) return 1.04;
            if (episodes <= 100) return 1.05;
            return 1.06;
        }

        // Fetch posters from TMDB
        async function fetchPosters() {
            for (let show of shows) {
                // Clean title for search (remove season info in parentheses)
                const searchTitle = show.title.replace(/\s*\(S\d+.*\)/, '').trim();
                try {
                    const searchRes = await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(searchTitle)}&first_air_year=${show.year}`);
                    const searchData = await searchRes.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const bestMatch = searchData.results[0];
                        if (bestMatch.poster_path) {
                            show.poster = TMDB_IMAGE_BASE + bestMatch.poster_path;
                            console.log(`Found poster for: ${show.title}`);
                        }
                    }
                } catch (e) {
                    console.error(`Error fetching poster for ${show.title}:`, e);
                }
                // Rate limiting - small delay between requests
                await new Promise(r => setTimeout(r, 200));
            }
            // Re-render with posters
            renderShows();
        }

        function getScoreMeaning(score) {
            if (score >= 10) return 'Perfect - The gold standard, no meaningful flaws';
            if (score >= 9) return 'Incredible - Near-flawless, only minor imperfections';
            if (score >= 8) return 'Exceptional - Among the very best in television';
            if (score >= 7) return 'Very Good - Clearly stands out, memorable';
            if (score >= 6) return 'Good - Noticeably above typical TV';
            if (score >= 5) return 'Average - Competent but unremarkable';
            return 'Below Average - Ranges from mediocre to poor';
        }

        // Poster colors by genre
        const genreColors = {
            'fantasy': '#7B68EE',
            'drama': '#4A90A4',
            'action': '#E63946',
            'crime': '#2D3436',
            'thriller': '#6C5CE7',
            'cop-show': '#1ABC9C',
            'scifi': '#00CEC9',
            'horror': '#A63333',
            'comedy': '#F39C12',
            'western': '#D35400',
            'romance': '#E91E63',
            'mystery': '#34495E',
            'historical': '#8B4513',
            'war': '#5D6D7E'
        };

        function getPosterColor(genres) {
            const primary = genres[0] || 'drama';
            return genreColors[primary] || '#d4af37';
        }

        // Pinned shows for Quick Compare (stored by title, not rank)
        let pinnedShows = [];

        function renderPinnedShows() {
            const container = document.getElementById('pinned-shows');
            const quickCompare = document.getElementById('quick-compare');

            if (pinnedShows.length === 0) {
                quickCompare.classList.remove('visible');
                return;
            }

            quickCompare.classList.add('visible');
            container.innerHTML = pinnedShows.map(title => {
                const show = shows.find(s => s.title === title);
                if (!show) return '';
                return `
                    <div class="pinned-card" data-pin-title="${show.title.replace(/"/g, '&quot;')}">
                        <span class="pin-rank">#${show.rank}</span>
                        <span class="pin-title">${show.title.replace(/\s*\(S\d+-\d+\)$/, '')}</span>
                        <span class="pin-score">${show.final.toFixed(2)}</span>
                        <button class="unpin-btn" data-pin-title="${show.title.replace(/"/g, '&quot;')}"></button>
                    </div>
                `;
            }).join('');
        }

        function togglePin(title) {
            const idx = pinnedShows.indexOf(title);
            if (idx > -1) {
                pinnedShows.splice(idx, 1);
            } else {
                if (pinnedShows.length >= 3) {
                    pinnedShows.shift(); // Max 3 pinned
                }
                pinnedShows.push(title);
            }
            renderPinnedShows();
            renderShows();
        }

        function renderShows() {
            let filtered = shows.filter(show => {
                const matchesSearch = show.title.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesScore = show.final >= minScore;
                const matchesEra = currentEras.length === 0 || currentEras.includes(getEra(show.year, show.month));

                let matchesGenre = true;
                if (!currentGenres.includes('all')) {
                    matchesGenre = currentGenres.every(g => show.genres.includes(g));
                }

                return matchesSearch && matchesScore && matchesEra && matchesGenre;
            });

            filtered.sort((a, b) => {
                switch(sortBy) {
                    case 'score-desc': return b.final - a.final;
                    case 'score-asc': return a.final - b.final;
                    case 'year-desc': return b.year - a.year;
                    case 'year-asc': return a.year - b.year;
                    case 'title': return a.title.localeCompare(b.title);
                    default: return a.rank - b.rank;
                }
            });

            resultsNum.textContent = filtered.length;

            if (filtered.length === 0) {
                list.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }

            list.style.display = 'flex';
            noResults.style.display = 'none';

            list.innerHTML = filtered.map((show, idx) => {
                const tier = getTier(show.final);
                const tierColors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                const tierColor = tierColors[tier];

                const showTitleEscaped = show.title.replace(/"/g, '&quot;');
                return `
                <div class="show-module" data-show-title="${showTitleEscaped}" style="display:flex;gap:0;margin-bottom:0.5rem;animation:fadeIn 0.4s ease-out;animation-delay:${idx*40}ms;animation-fill-mode:both;align-items:stretch;">
                    <!-- Backdrop banner - visible on mobile only -->
                    <div class="show-backdrop">
                        ${show.backdrop
                            ? `<img src="${show.backdrop}" alt="${show.title}">`
                            : show.poster
                                ? `<img src="${show.poster}" alt="${show.title}" style="object-position:center 30%;filter:blur(2px) brightness(0.7);transform:scale(1.1);">`
                                : `<div style="width:100%;height:100%;background:linear-gradient(135deg,#1a1a2e,#16213e);display:flex;align-items:center;justify-content:center;"><span style="font-family:Unna,serif;font-size:3rem;color:rgba(255,255,255,0.15);font-weight:900;">${show.title.charAt(0)}</span></div>`
                        }
                        <div class="backdrop-gradient"></div>
                        <span class="backdrop-rank-badge" data-rank-badge style="width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,${tierColor}99,${tierColor});color:#0a0a0f;display:flex;align-items:center;justify-content:center;font-family:JetBrains Mono,monospace;font-size:0.75rem;font-weight:600;z-index:5;box-shadow:0 4px 12px rgba(0,0,0,0.5);">#${show.rank}</span>
                    </div>
                    <!-- Poster - full height of card (desktop only) -->
                    <div class="show-poster" style="width:200px;min-width:200px;height:100%;background:#1a1a24;border-radius:8px 0 0 8px;position:relative;flex-shrink:0;box-shadow:4px 0 20px rgba(0,0,0,0.4);overflow:hidden;align-self:stretch;">
                        ${show.poster
                            ? `<img src="${show.poster}" alt="${show.title}" style="width:100%;height:100%;object-fit:cover;object-position:center;display:block;">`
                            : `<span style="font-family:Unna,serif;font-size:5rem;color:rgba(255,255,255,0.12);font-weight:900;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;">${show.title.charAt(0)}</span>`
                        }
                        <span data-rank-badge style="position:absolute;top:-6px;left:-6px;width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,${tierColor}99,${tierColor});color:#0a0a0f;display:flex;align-items:center;justify-content:center;font-family:JetBrains Mono,monospace;font-size:0.75rem;font-weight:600;z-index:5;box-shadow:0 4px 12px rgba(0,0,0,0.5);">#${show.rank}</span>
                    </div>

                    <!-- Card Panel - flows next to poster -->
                    <div class="show-card-panel" style="flex:1;min-width:0;background:linear-gradient(135deg,rgba(20,20,28,0.95),rgba(20,20,28,0.8));border:1px solid #252532;border-radius:0 12px 12px 0;border-left:none;padding:0.8rem 1.25rem;position:relative;transition:all 0.3s ease;" onmouseover="this.style.borderColor='#d4af3740';this.style.background='linear-gradient(135deg,rgba(30,30,40,0.98),rgba(25,25,35,0.85))'" onmouseout="this.style.borderColor='#252532';this.style.background='linear-gradient(135deg,rgba(20,20,28,0.95),rgba(20,20,28,0.8))'">
                        <!-- Corner ornaments -->
                        <div style="position:absolute;top:6px;left:6px;width:12px;height:12px;border-top:1px solid #d4af3740;border-left:1px solid #d4af3740;"></div>
                        <div style="position:absolute;top:6px;right:6px;width:12px;height:12px;border-top:1px solid #d4af3740;border-right:1px solid #d4af3740;"></div>
                        <div style="position:absolute;bottom:6px;left:6px;width:12px;height:12px;border-bottom:1px solid #d4af3740;border-left:1px solid #d4af3740;"></div>
                        <div style="position:absolute;bottom:6px;right:6px;width:12px;height:12px;border-bottom:1px solid #d4af3740;border-right:1px solid #d4af3740;"></div>

                        <!-- Top row: Title + Score -->
                        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:0.5rem;">
                            <div style="flex:1;min-width:100px;">
                                <div style="font-family:Unna,serif;font-size:1.6rem;font-weight:700;color:#e8e8ec;display:flex;align-items:center;gap:0.35rem;flex-wrap:wrap;line-height:1.1;">
                                    ${show.title.replace(/\s*\(S\d+-\d+\)$/, '')}
                                    ${show.title.match(/\(S\d+-\d+\)/) ? `<span style="background:#475569;color:#e8e8ec;font-size:0.75rem;padding:0.08rem 0.25rem;border-radius:4px;font-weight:600;box-shadow:0 2px 4px rgba(0,0,0,0.2);">${show.title.match(/\(S\d+-\d+\)/)[0].replace(/[()]/g,'')}</span>` : ''}
                                </div>
                                <div style="display:flex;align-items:center;gap:0.4rem;margin-top:0.2rem;">
                                    <span style="font-size:0.9rem;color:#8a8a9a;">${show.year}</span>
                                    <span style="color:#3a3a48;">|</span>
                                    <span style="font-size:0.9rem;color:#8a8a9a;">${show.episodes} ep</span>
                                    <span style="font-size:0.8rem;font-family:'JetBrains Mono',monospace;vertical-align:0;${getMultiplier(show.episodes) > 1 ? 'color:#22c55e;' : getMultiplier(show.episodes) < 1 ? 'color:#ef4444;' : 'color:#64748b;'}">${getMultiplier(show.episodes).toFixed(2)}</span>
                                </div>
                            </div>
                            <div style="text-align:right;flex-shrink:0;position:relative;">
                                <!-- Score glow effect for high scores -->
                                ${show.final >= 9 ? `<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:50px;height:50px;background:radial-gradient(circle,${tierColor}30 0%,transparent 70%);border-radius:50%;pointer-events:none;"></div>` : ''}
                                <div data-score-display style="font-family:Unna,serif;font-size:2.2rem;font-weight:900;color:${tierColor};line-height:1;animation:goldGlow 3s ease-in-out infinite;text-shadow:${show.final >= 9 ? `0 0 20px ${tierColor}40` : 'none'};">${show.final.toFixed(2)}</div>
                                <div style="font-size:0.5rem;color:#8a8a9a;text-transform:uppercase;letter-spacing:0.1em;">score</div>
                            </div>
                        </div>

                        <!-- Divider -->
                        <div style="display:flex;align-items:center;gap:0.5rem;padding:0.3rem 0;">
                            <div style="flex:1;height:1px;background:linear-gradient(90deg,transparent,#252532);"></div>
                            <div style="color:#d4af37;font-size:0.65rem;"></div>
                            <div style="flex:1;height:1px;background:linear-gradient(90deg,#252532,transparent);"></div>
                        </div>

                        <!-- Category bars with sliders -->
                        <div style="display:flex;flex-direction:column;gap:2px;">
                            ${categories.map(cat => {
                                const value = show[cat.key];
                                const percentage = (value / 10) * 100;
                                // Classic medal tier color scheme - visible on dark backgrounds
                                const getScoreColor = (score) => {
                                    if (score === 10) return '#d4af37'; // Gold - Perfect
                                    if (score >= 9) return '#a8a8b0';  // Silver - Excellent
                                    if (score >= 8) return '#a87d4a';  // Bronze - Very Good
                                    if (score >= 7) return '#8b4513';  // Dark Brown - Good
                                    if (score >= 6) return '#8B0000';  // Maroon - Average
                                    if (score >= 5) return '#8B2E2E';  // Dark Red - Below Average
                                    return '#4a2020';                   // Dark brown-red - Dim
                                };
                                const catTierColor = getScoreColor(value);
                                const isModified = baseScores[show.title] && value !== baseScores[show.title][cat.key];
                                return `
                                    <div style="display:grid;grid-template-columns:35% 55% 10%;align-items:center;">
                                        <span class="score-label-text" data-cat="${cat.key}" style="font-family:Unna,serif;font-size:0.85rem;font-weight:200;font-style:italic;color:#e8e8ec;cursor:pointer;" title="Click for details">${cat.label}</span>
                                        <div class="cat-bar-container">
                                            <div class="cat-bar-track">
                                                <div class="cat-bar-fill" data-cat-bar="${cat.key}" style="background:linear-gradient(90deg,${catTierColor}99,${catTierColor},${catTierColor}99);width:${percentage}%;"></div>
                                            </div>
                                            <input type="range" class="cat-slider-input" data-show="${showTitleEscaped}" data-cat="${cat.key}" min="0" max="10" step="0.5" value="${value}" style="--thumb-color: ${catTierColor};">
                                        </div>
                                        <span class="cat-value-display${isModified ? ' cat-value-modified' : ''} score-value" data-cat-value="${cat.key}" style="font-family:JetBrains Mono,monospace;font-size:0.7rem;font-weight:500;text-align:right;color:${isModified ? '#60a5fa' : catTierColor};cursor:pointer;" title="Click for details">${value}</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>

                        <!-- Genres -->
                        <div style="display:flex;flex-wrap:wrap;gap:0.25rem;margin-top:0.25rem;">
                            ${show.genres.map(g => `<span class="genre-tag" data-genre="${g}" style="background:transparent;border:1px solid #64748b;color:#64748b;padding:0.08rem 0.25rem;border-radius:100px;font-size:0.5rem;font-weight:500;cursor:pointer;transition:all 0.2s;"
                                onmouseover="this.style.borderColor='#d4af37';this.style.color='#d4af37'"
                                onmouseout="this.style.borderColor='#64748b';this.style.color='#64748b'">${g}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `}).join('');

            setTimeout(() => {
                document.querySelectorAll('.score-bar-fill').forEach(bar => {
                    bar.style.width = bar.dataset.width;
                });
            }, 100);

            updateActiveFilters();
        }

        function updateActiveFilters() {
            const tags = [];

            // Active era tags
            if (currentEras.length > 0) {
                currentEras.forEach(era => {
                    tags.push({ type: 'era', value: era, label: `Era: ${era}` });
                });
            }

            if (minScore > 6.5) {
                tags.push({ type: 'score', value: minScore, label: `Score: ${minScore}+` });
            }

            if (!currentGenres.includes('all')) {
                currentGenres.forEach(g => {
                    tags.push({ type: 'genre', value: g, label: g });
                });
            }

            if (searchTerm) {
                tags.push({ type: 'search', value: searchTerm, label: `"${searchTerm}"` });
            }

            if (tags.length === 0) {
                activeFiltersEl.innerHTML = '';
                return;
            }

            activeFiltersEl.innerHTML = tags.map(t => `
                <span class="active-filter-tag">
                    ${t.label}
                    <button onclick="removeFilter('${t.type}', '${t.value}')"></button>
                </span>
            `).join('') + `<button class="clear-all" onclick="clearAllFilters()">Clear all</button>`;
        }

        window.removeFilter = function(type, value) {
            if (type === 'era') {
                currentEra = 'all';
                document.querySelectorAll('#era-filters .filter-btn').forEach(b => b.classList.remove('active'));
                document.querySelector('#era-filters .filter-btn[data-filter="all"]').classList.add('active');
            } else if (type === 'score') {
                minScore = 6.5;
                if (scoreFilter) scoreFilter.value = 6.5;
                if (scoreValue) scoreValue.textContent = '6.5';
            } else if (type === 'genre') {
                currentGenres = currentGenres.filter(g => g !== value);
                if (currentGenres.length === 0) {
                    currentGenres = ['all'];
                    document.querySelectorAll('#genre-filters .genre-pill').forEach(p => p.classList.remove('active'));
                    document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.add('active');
                } else {
                    document.querySelector(`#genre-filters .genre-pill[data-genre="${value}"]`).classList.remove('active');
                }
            } else if (type === 'search') {
                searchTerm = '';
                searchInput.value = '';
            }
            renderShows();
        };

        window.clearAllFilters = function() {
            currentEras = [];
            currentGenres = ['all'];
            minScore = 6.5;
            searchTerm = '';
            sortBy = 'rank';

            searchInput.value = '';
            if (scoreFilter) scoreFilter.value = 6.5;
            if (scoreValue) scoreValue.textContent = '6.5';
            sortSelect.value = 'rank';

            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.genre-pill').forEach(p => p.classList.remove('active'));
            document.querySelector('#era-filters .filter-btn[data-filter="all"]').classList.add('active');
            document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.add('active');

            renderShows();
        };

        // Era buttons (multi-select)
        document.querySelectorAll('#era-filters .filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const era = btn.dataset.filter;
                if (era === 'all') {
                    currentEras = [];
                    document.querySelectorAll('#era-filters .filter-btn').forEach(b => b.classList.remove('active'));
                } else {
                    btn.classList.toggle('active');
                    if (btn.classList.contains('active')) {
                        currentEras.push(era);
                    } else {
                        currentEras = currentEras.filter(e => e !== era);
                    }
                    document.querySelector('#era-filters .filter-btn[data-filter="all"]').classList.remove('active');
                }
                renderShows();
            });
        });

        // Genre pills
        document.querySelectorAll('#genre-filters .genre-pill').forEach(pill => {
            pill.addEventListener('click', () => {
                const genre = pill.dataset.genre;

                if (genre === 'all') {
                    document.querySelectorAll('#genre-filters .genre-pill').forEach(p => p.classList.remove('active'));
                    pill.classList.add('active');
                    currentGenres = ['all'];
                } else {
                    document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.remove('active');

                    if (pill.classList.contains('active')) {
                        pill.classList.remove('active');
                        currentGenres = currentGenres.filter(g => g !== genre);
                        if (currentGenres.length === 0) {
                            currentGenres = ['all'];
                            document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.add('active');
                        }
                    } else {
                        pill.classList.add('active');
                        if (currentGenres.includes('all')) {
                            currentGenres = [genre];
                        } else {
                            currentGenres.push(genre);
                        }
                    }
                }
                renderShows();
            });
        });

        // Search
        searchInput.addEventListener('input', (e) => {
            searchTerm = e.target.value;
            renderShows();
        });

        // Genre tags on cards - click to filter
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('genre-tag')) {
                const genre = e.target.textContent;
                document.querySelectorAll('#genre-filters .genre-pill').forEach(p => p.classList.remove('active'));
                const pill = document.querySelector(`#genre-filters .genre-pill[data-genre="${genre}"]`);
                if (pill) {
                    pill.classList.add('active');
                    currentGenres = [genre];
                    renderShows();
                }
            }
        });

        // Score filter (only if element exists)
        if (scoreFilter) {
            scoreFilter.addEventListener('input', (e) => {
                minScore = parseFloat(e.target.value);
                if (scoreValue) scoreValue.textContent = minScore.toFixed(1);
                renderShows();
            });
        }

        // Sort
        sortSelect.addEventListener('change', (e) => {
            sortBy = e.target.value;
            renderShows();
        });

        // Pin button handlers
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('pin-btn')) {
                const title = e.target.dataset.pinTitle || e.target.closest('.show-module')?.dataset.showTitle;
                if (title) togglePin(title);
            }
            if (e.target.classList.contains('unpin-btn')) {
                const title = e.target.dataset.pinTitle;
                if (title) togglePin(title);
            }
            // Accordion for score descriptions - Category label
            if (e.target.classList.contains('score-label-text')) {
                const desc = e.target.nextElementSibling.nextElementSibling; // score-bar is between
                const allDescs = document.querySelectorAll('.score-desc.expanded');
                allDescs.forEach(d => {
                    if (d !== desc) d.classList.remove('expanded');
                });
                desc.classList.toggle('expanded');
            }
            // Score value click - show score meaning
            if (e.target.classList.contains('score-value')) {
                const meaning = e.target.dataset.meaning;
                const catDesc = e.target.previousElementSibling.previousElementSibling.querySelector('.score-desc');
                const allDescs = document.querySelectorAll('.score-desc.expanded');
                allDescs.forEach(d => {
                    if (d !== catDesc) d.classList.remove('expanded');
                });
                // Show category description with score meaning
                if (catDesc) {
                    catDesc.innerHTML = `<strong>Score ${e.target.dataset.score}:</strong> ${meaning}<br><em>${catDesc.textContent}</em>`;
                    catDesc.classList.toggle('expanded');
                }
            }
        });

        // Methodology modal
        const modal = document.getElementById('methodology-modal');
        const openLink = document.getElementById('open-methodology');
        const closeBtn = document.getElementById('close-methodology');

        if (openLink && modal && closeBtn) {
            openLink.addEventListener('click', (e) => {
                e.preventDefault();
                modal.classList.add('visible');
            });

            // Card-level methodology links
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('card-methodology-link')) {
                    e.preventDefault();
                    modal.classList.add('visible');
                }
            });

            closeBtn.addEventListener('click', () => {
                modal.classList.remove('visible');
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('visible');
                }
            });
        }

        // Category modal
        const categoryModal = document.getElementById('category-modal');
        const categoryModalTitle = document.getElementById('category-modal-title');
        const categoryModalWeight = document.getElementById('category-modal-weight');
        const categoryModalDesc = document.getElementById('category-modal-desc');
        const closeCategoryBtn = document.getElementById('close-category');

        if (categoryModal) {
            // Click on score labels
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('score-label-text') || e.target.classList.contains('score-value')) {
                    const catKey = e.target.dataset.cat || e.target.dataset.score;
                    const category = categories.find(c => c.key === catKey);
                    if (category) {
                        categoryModalTitle.textContent = category.label;
                        categoryModalWeight.textContent = category.weight;
                        categoryModalDesc.textContent = category.desc;
                        categoryModal.classList.add('visible');
                    }
                }
            });

            closeCategoryBtn.addEventListener('click', () => {
                categoryModal.classList.remove('visible');
            });

            categoryModal.addEventListener('click', (e) => {
                if (e.target === categoryModal) {
                    categoryModal.classList.remove('visible');
                }
            });

            // Push state when opening category modal
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('score-label-text') || e.target.classList.contains('score-value')) {
                    history.pushState({ modal: 'category' }, '');
                }
            });
        }

        // Show Detail Modal
        const showDetailModal = document.getElementById('show-detail-modal');
        const showDetailBody = document.getElementById('show-detail-body');
        const closeShowDetailBtn = document.getElementById('close-show-detail');

        if (showDetailModal) {
            // Click on show cards to open detail view (but not on sliders or interactive elements)
            list.addEventListener('click', (e) => {
                // Don't open if clicking on interactive elements
                if (e.target.tagName === 'INPUT' ||
                    e.target.tagName === 'BUTTON' ||
                    e.target.classList.contains('cat-slider-input') ||
                    e.target.classList.contains('genre-tag') ||
                    e.target.classList.contains('score-label-text') ||
                    e.target.classList.contains('score-value')) {
                    return;
                }

                // Find the show module
                const showModule = e.target.closest('.show-module');
                if (showModule) {
                    const showTitle = showModule.dataset.showTitle;
                    const show = shows.find(s => s.title === showTitle);
                    if (show) {
                        history.pushState({ modal: 'show-detail' }, '');
                        openShowDetail(show);
                    }
                }
            });

            // Close button
            closeShowDetailBtn.addEventListener('click', () => {
                showDetailModal.classList.remove('visible');
            });

            // Click outside to close
            showDetailModal.addEventListener('click', (e) => {
                if (e.target === showDetailModal) {
                    showDetailModal.classList.remove('visible');
                }
            });

            // Back button on mobile closes popup
            window.addEventListener('popstate', (e) => {
                if (showDetailModal.classList.contains('visible')) {
                    showDetailModal.classList.remove('visible');
                    e.stopImmediatePropagation();
                }
                if (categoryModal.classList.contains('visible')) {
                    categoryModal.classList.remove('visible');
                    e.stopImmediatePropagation();
                }
            });

            // Push state when opening modal
            const originalOpenShowDetail = openShowDetail;
            openShowDetail = function(show) {
                history.pushState({ modal: 'show-detail' }, '');
                originalOpenShowDetail(show);
            };
        }

        // Function to open show detail modal
        async function openShowDetail(show) {
            const tier = getTier(show.final);
            const tierColor = tier === 'gold' ? 'var(--gold)' : tier === 'silver' ? 'var(--silver)' : 'var(--bronze)';

            // Generate slug if not present
            const slug = show.slug || show.title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/-+/g, '-').replace(/^-|-$/g, '');

            // Show loading state immediately
            showDetailBody.innerHTML = `
                <div class="show-detail-header">
                    <div class="show-detail-poster">
                        ${show.poster
                            ? `<img src="${show.poster}" alt="${show.title}">`
                            : `<div style="width:100%;height:270px;background:#1a1a24;display:flex;align-items:center;justify-content:center;"><span style="font-family:Unna,serif;font-size:5rem;color:rgba(255,255,255,0.12);font-weight:900;">${show.title.charAt(0)}</span></div>`
                        }
                    </div>
                    <div class="show-detail-info">
                        <h2 class="show-detail-title">${show.title.replace(/\s*\(S\d+-\d+\)$/, '')}</h2>
                        <div class="show-detail-meta">
                            <span>${show.year}</span>
                            <span></span>
                            <span>${show.episodes} episodes</span>
                            <span></span>
                            <span>${show.genres.join(', ')}</span>
                        </div>
                        <div class="show-detail-score">
                            <span class="show-detail-final-score ${tier}">${show.final.toFixed(2)}</span>
                            <span class="show-detail-score-label">final score</span>
                        </div>
                    </div>
                </div>
                <div class="show-detail-body">
                    <div class="show-detail-section">
                        <h3>What It Feels Like to Watch</h3>
                        <p style="color:var(--text-muted);"><em>Loading...</em></p>
                    </div>
                </div>
            `;
            showDetailModal.classList.add('visible');

            // Fetch both HTML and JSON data
            let narrativeHtml = '';
            let whyItRanksHtml = '';
            let externalRatingsHtml = '';
            let consensusHtml = '';
            let showData = null;

            try {
                // Fetch JSON data for external ratings and consensus
                const jsonResponse = await fetch(`data/shows/${slug}.json`);
                if (jsonResponse.ok) {
                    showData = await jsonResponse.json();
                }
            } catch (err) {
                // JSON might not exist, continue
            }

            try {
                // Fetch HTML for narrative and why it ranks
                const response = await fetch(`docs/shows/${slug}.html`);
                if (response.ok) {
                    const html = await response.text();
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');

                    // Extract "What It Feels Like to Watch" section
                    const heading = Array.from(doc.querySelectorAll('h2')).find(h => h.textContent.includes('What It Feels Like to Watch'));
                    if (heading) {
                        let content = '';
                        let nextEl = heading.nextElementSibling;
                        while (nextEl && !nextEl.tagName.match(/^H[12]$/i)) {
                            content += nextEl.outerHTML;
                            nextEl = nextEl.nextElementSibling;
                        }
                        narrativeHtml = content || '<p>Narrative content available on full page.</p>';
                    }

                    // Extract "Why It Ranks" section
                    const whyHeading = Array.from(doc.querySelectorAll('h2')).find(h => h.textContent.includes('Why It Ranks'));
                    if (whyHeading) {
                        let content = '';
                        let nextEl = whyHeading.nextElementSibling;
                        while (nextEl && !nextEl.tagName.match(/^H2$/i)) {
                            content += nextEl.outerHTML;
                            nextEl = nextEl.nextElementSibling;
                        }
                        whyItRanksHtml = content;
                    }
                }
            } catch (err) {
                // HTML fetch failed
            }

            // Set fallback content if nothing loaded
            if (!narrativeHtml && !whyItRanksHtml) {
                narrativeHtml = `<p style="color:var(--text-muted);">${show.title} is ranked #${show.rank} with a score of ${show.final.toFixed(2)}. Full narrative analysis coming soon.</p>`;
            }

            // Build external ratings HTML from JSON data
            if (showData && showData.external_ratings) {
                const ratings = showData.external_ratings;
                let ratingsItems = [];

                if (ratings.imdb) {
                    ratingsItems.push(`
                        <div class="external-rating imdb">
                            <span class="rating-source">IMDB</span>
                            <span class="rating-value">${ratings.imdb.score}/${ratings.imdb.scale}</span>
                            ${ratings.imdb.count ? `<span class="rating-count">${ratings.imdb.count} ratings</span>` : ''}
                        </div>
                    `);
                }

                if (ratings.rotten_tomatoes) {
                    const rtScore = ratings.rotten_tomatoes.season_1?.score || ratings.rotten_tomatoes.score;
                    ratingsItems.push(`
                        <div class="external-rating rotten">
                            <span class="rating-source">Rotten Tomatoes</span>
                            <span class="rating-value">${rtScore}%</span>
                        </div>
                    `);
                }

                if (ratings.metacritic) {
                    ratingsItems.push(`
                        <div class="external-rating metacritic">
                            <span class="rating-source">Metacritic</span>
                            <span class="rating-value">${ratings.metacritic.score}/${ratings.metacritic.scale}</span>
                        </div>
                    `);
                }

                if (ratingsItems.length > 0) {
                    externalRatingsHtml = `
                        <div class="external-ratings-grid">
                            ${ratingsItems.join('')}
                        </div>
                    `;
                }
            }

            // Build consensus highlights
            if (showData && showData.consensus_highlights) {
                consensusHtml = `<div class="consensus-content"><p>${showData.consensus_highlights}</p></div>`;
            }

            // Update modal with full content
            showDetailBody.innerHTML = `
                <div class="show-detail-header">
                    <div class="show-detail-poster">
                        ${show.poster
                            ? `<img src="${show.poster}" alt="${show.title}">`
                            : `<div style="width:100%;height:270px;background:#1a1a24;display:flex;align-items:center;justify-content:center;"><span style="font-family:Unna,serif;font-size:5rem;color:rgba(255,255,255,0.12);font-weight:900;">${show.title.charAt(0)}</span></div>`
                        }
                    </div>
                    <div class="show-detail-info">
                        <h2 class="show-detail-title">${show.title.replace(/\s*\(S\d+-\d+\)$/, '')}</h2>
                        <div class="show-detail-meta">
                            <span>${show.year}</span>
                            <span></span>
                            <span>${show.episodes} episodes</span>
                            <span></span>
                            <span>${show.genres.join(', ')}</span>
                        </div>
                        <div class="show-detail-score">
                            <span class="show-detail-final-score ${tier}">${show.final.toFixed(2)}</span>
                            <span class="show-detail-score-label">final score</span>
                        </div>
                        ${externalRatingsHtml ? `<div class="show-detail-external">${externalRatingsHtml}</div>` : ''}
                    </div>
                </div>
                <div class="show-detail-body">
                    ${consensusHtml ? `
                    <div class="show-detail-section show-detail-consensus">
                        <h3>Critical Consensus</h3>
                        ${consensusHtml}
                    </div>
                    ` : ''}
                    <div class="show-detail-section show-detail-narrative">
                        <h3>What It Feels Like to Watch</h3>
                        <div class="narrative-content">${narrativeHtml || '<p>Full narrative analysis coming soon.</p>'}</div>
                    </div>
                    ${whyItRanksHtml ? `
                    <div class="show-detail-section">
                        <h3>Why It Ranks #${show.rank}</h3>
                        ${whyItRanksHtml}
                    </div>
                    ` : ''}
                </div>
            `;
        }

        // ---- Per-card slider event handling ----
        let reorderDebounce = null;
        let sliderDragState = new Map();

        // Prevent slider drags from opening category modal
        list.addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('cat-slider-input')) {
                e.stopPropagation();
                sliderDragState.set(e.target, { isDragging: true });
            }
        }, true);
        list.addEventListener('touchstart', (e) => {
            if (e.target.classList.contains('cat-slider-input')) {
                e.stopPropagation();
                sliderDragState.set(e.target, { isDragging: true });
            }
        }, true);

        // Prevent click-to-snap behavior on range sliders
        list.addEventListener('click', (e) => {
            if (e.target.classList.contains('cat-slider-input')) {
                const state = sliderDragState.get(e.target);
                if (!state || !state.isDragging) {
                    e.preventDefault();
                    return;
                }
                sliderDragState.delete(e.target);
            }
        }, true);

        // Live update on slider drag
        list.addEventListener('input', (e) => {
            if (!e.target.classList.contains('cat-slider-input')) return;
            const slider = e.target;
            const title = slider.dataset.show;
            const catKey = slider.dataset.cat;
            const newVal = parseFloat(slider.value);

            const show = shows.find(s => s.title === title);
            if (!show || !activeScores[title]) return;

            // Update data
            activeScores[title][catKey] = newVal;
            show[catKey] = newVal;

            // Calculate final from BASE + sum of all deltas (not cumulative)
            let finalDelta = 0;
            catKeys.forEach(k => {
                const delta = activeScores[title][k] - baseScores[title][k];
                finalDelta += delta * (weights[k] / 100);
            });

            // Apply episode multiplier if enabled
            let newFinal = baseScores[title].final + finalDelta;
            if (multiplierEnabled) {
                newFinal = newFinal * getMultiplier(show.episodes);
            }
            show.final = parseFloat(newFinal.toFixed(2));

            // Track modification
            const isModified = catKeys.some(k => activeScores[title][k] !== baseScores[title][k]);
            if (isModified) {
                modifiedShows.add(title);
            } else {
                modifiedShows.delete(title);
            }

            // Targeted DOM update (no full re-render)
            const card = list.querySelector(`.show-module[data-show-title="${CSS.escape(title)}"]`);
            if (card) {
                // Update bar fill
                const barFill = card.querySelector(`[data-cat-bar="${catKey}"]`);
                if (barFill) {
                    const pct = (newVal / 10) * 100;
                    // Classic medal tier color scheme - visible on dark backgrounds
                    const getScoreColor = (score) => {
                        if (score === 10) return '#d4af37'; // Gold - Perfect
                        if (score >= 9) return '#a8a8b0';  // Silver - Excellent
                        if (score >= 8) return '#a87d4a';  // Bronze - Very Good
                        if (score >= 7) return '#8b4513';  // Dark Brown - Good
                        if (score >= 6) return '#8B0000';  // Maroon - Average
                        if (score >= 5) return '#8B2E2E';  // Dark Red - Below Average
                        return '#4a2020';                   // Dark brown-red - Dim
                    };
                    const c = getScoreColor(newVal);
                    barFill.style.width = pct + '%';
                    barFill.style.background = `linear-gradient(90deg,${c}99,${c},${c}99)`;
                    
                    // Update slider thumb color
                    slider.style.setProperty('--thumb-color', c);
                }

                // Update value text
                const valEl = card.querySelector(`[data-cat-value="${catKey}"]`);
                if (valEl) {
                    const valModified = baseScores[title] && newVal !== baseScores[title][catKey];
                    valEl.textContent = newVal;
                    if (valModified) {
                        valEl.classList.add('cat-value-modified');
                        valEl.style.color = '#60a5fa';
                    } else {
                        valEl.classList.remove('cat-value-modified');
                        // Classic medal tier color scheme - visible on dark backgrounds
                        const getScoreColor = (score) => {
                            if (score === 10) return '#d4af37'; // Gold - Perfect
                            if (score >= 9) return '#a8a8b0';  // Silver - Excellent
                            if (score >= 8) return '#a87d4a';  // Bronze - Very Good
                            if (score >= 7) return '#8b4513';  // Dark Brown - Good
                            if (score >= 6) return '#8B0000';  // Maroon - Average
                            if (score >= 5) return '#8B2E2E';  // Dark Red - Below Average
                            return '#4a2020';                   // Dark brown-red - Dim
                        };
                        valEl.style.color = getScoreColor(newVal);
                    }
                }

                // Update total score display
                const scoreDisplay = card.querySelector('[data-score-display]');
                if (scoreDisplay) {
                    const tier = getTier(show.final);
                    const colors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                    scoreDisplay.textContent = show.final.toFixed(2);
                    scoreDisplay.style.color = colors[tier];
                }
            }

            updateSaveBar();

            // Debounced reorder
            if (reorderDebounce) clearTimeout(reorderDebounce);
            reorderDebounce = setTimeout(() => checkAndReorder(), 300);
        });

        // On slider release - immediate reorder + persist
        list.addEventListener('change', (e) => {
            if (!e.target.classList.contains('cat-slider-input')) return;
            if (reorderDebounce) { clearTimeout(reorderDebounce); reorderDebounce = null; }
            checkAndReorder();
            saveOverridesToStorage();
        });

        function checkAndReorder() {
            // Re-sort shows array
            shows.sort((a, b) => b.final - a.final);
            shows.forEach((s, i) => { s.rank = i + 1; });

            // Get current DOM order
            const cards = Array.from(list.querySelectorAll('.show-module[data-show-title]'));
            const currentOrder = cards.map(c => c.dataset.showTitle);
            const desiredOrder = shows.map(s => s.title);

            // Filter desired order to only currently-visible cards
            const visibleTitles = new Set(currentOrder);
            const desiredVisible = desiredOrder.filter(t => visibleTitles.has(t));

            let needsMove = false;
            for (let i = 0; i < desiredVisible.length; i++) {
                if (currentOrder[i] !== desiredVisible[i]) { needsMove = true; break; }
            }

            if (needsMove) {
                // Move DOM nodes to match desired order
                desiredVisible.forEach(title => {
                    const card = list.querySelector(`.show-module[data-show-title="${CSS.escape(title)}"]`);
                    if (card) list.appendChild(card);
                });
            }

            // Update all rank badge colors on visible cards (text is set by template, don't overwrite)
            const currentCards = Array.from(list.querySelectorAll('.show-module[data-show-title]'));
            currentCards.forEach(card => {
                const title = card.dataset.showTitle;
                const show = shows.find(s => s.title === title);
                if (!show) return;
                const badge = card.querySelector('[data-rank-badge]');
                if (badge) {
                    // Only update color - text is correct from template render
                    const tier = getTier(show.final);
                    const colors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                    const c = colors[tier];
                    badge.style.background = `linear-gradient(135deg,${c}99,${c})`;
                }
            });

            // Refresh pinned shows
            renderPinnedShows();
        }

        // ---- Save / Export / Import / Reset ----
        document.getElementById('save-scores-btn')?.addEventListener('click', () => {
            saveOverridesToStorage();
            const btn = document.getElementById('save-scores-btn');
            const orig = btn.textContent;
            btn.textContent = 'Saved!';
            setTimeout(() => { btn.textContent = orig; }, 1500);
        });

        document.getElementById('export-scores-btn')?.addEventListener('click', () => {
            const overrides = {};
            modifiedShows.forEach(title => {
                overrides[title] = {};
                catKeys.forEach(key => {
                    overrides[title][key] = activeScores[title][key];
                });
            });
            const blob = new Blob([JSON.stringify({
                timestamp: new Date().toISOString(),
                weights: { ...weights },
                baseScores: { ...baseScores },
                overrides,
                finalRankings: shows.map(s => ({ rank: s.rank, title: s.title, final: s.final }))
            }, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            const ts = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19);
            a.href = url;
            a.download = `tvranked-scores-${ts}.json`;
            a.click();
            URL.revokeObjectURL(url);
        });

        document.getElementById('import-scores-btn')?.addEventListener('click', () => {
            document.getElementById('import-scores-file').click();
        });

        document.getElementById('import-scores-file')?.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (ev) => {
                try {
                    const data = JSON.parse(ev.target.result);
                    if (data.overrides) {
                        // Reset to base first
                        shows.forEach(show => {
                            if (baseScores[show.title]) {
                                catKeys.forEach(k => {
                                    show[k] = baseScores[show.title][k];
                                    activeScores[show.title][k] = baseScores[show.title][k];
                                });
                            }
                        });
                        modifiedShows.clear();

                        // Apply imported overrides
                        Object.keys(data.overrides).forEach(title => {
                            const show = shows.find(s => s.title === title);
                            if (!show) return;
                            const changes = data.overrides[title];
                            let hasChange = false;
                            catKeys.forEach(key => {
                                if (changes[key] !== undefined) {
                                    show[key] = changes[key];
                                    activeScores[title][key] = changes[key];
                                    if (changes[key] !== baseScores[title][key]) hasChange = true;
                                }
                            });
                            if (hasChange) modifiedShows.add(title);
                            recalcFinal(show);
                        });

                        // Optionally import weights
                        if (data.weights) {
                            Object.assign(weights, data.weights);
                            initWeightSliders();
                        }

                        // Recalculate baseScores.final with imported/current weights
                        shows.forEach(show => {
                            if (baseScores[show.title]) {
                                const baseUnmultiplied = (
                                    (baseScores[show.title].char * weights.char) +
                                    (baseScores[show.title].world * weights.world) +
                                    (baseScores[show.title].cine * weights.cine) +
                                    (baseScores[show.title].spect * weights.spect) +
                                    (baseScores[show.title].conc * weights.conc) +
                                    (baseScores[show.title].drive * weights.drive) +
                                    (baseScores[show.title].resol * weights.resol)
                                ) / 100;
                                baseScores[show.title].final = parseFloat(baseUnmultiplied.toFixed(2));
                            }
                        });

                        shows.forEach(show => recalcFinal(show));
                        shows.sort((a, b) => b.final - a.final);
                        shows.forEach((s, i) => { s.rank = i + 1; });
                        saveOverridesToStorage();
                        updateSaveBar();
                        renderShows();
                    }
                } catch (err) {
                    console.error('Failed to import scores:', err);
                    alert('Failed to import: invalid JSON file');
                }
            };
            reader.readAsText(file);
            e.target.value = ''; // reset file input
        });

        document.getElementById('reset-scores-btn')?.addEventListener('click', () => {
            if (!confirm('Reset all score modifications to original values?')) return;

            // Also reset weights to defaults
            weights = { ...defaultWeights };
            initWeightSliders();

            // First reset all shows to base values
            shows.forEach(show => {
                if (baseScores[show.title]) {
                    catKeys.forEach(k => {
                        show[k] = baseScores[show.title][k];
                        activeScores[show.title][k] = baseScores[show.title][k];
                    });
                }
            });

            // Then recalculate baseScores.final with reset (default) weights
            shows.forEach(show => {
                if (baseScores[show.title]) {
                    const baseUnmultiplied = (
                        (baseScores[show.title].char * weights.char) +
                        (baseScores[show.title].world * weights.world) +
                        (baseScores[show.title].cine * weights.cine) +
                        (baseScores[show.title].spect * weights.spect) +
                        (baseScores[show.title].conc * weights.conc) +
                        (baseScores[show.title].drive * weights.drive) +
                        (baseScores[show.title].resol * weights.resol)
                    ) / 100;
                    baseScores[show.title].final = parseFloat(baseUnmultiplied.toFixed(2));
                    // Recalculate show.final with current multiplier state
                    recalcFinal(show);
                }
            });
            modifiedShows.clear();
            localStorage.removeItem('tvranked_score_overrides');
            shows.sort((a, b) => b.final - a.final);
            shows.forEach((s, i) => { s.rank = i + 1; });
            updateSaveBar();
            renderShows();
        });

        // ---- Fix pinned shows to use titles instead of ranks ----
        // (Ranks are now mutable, so pin by title)

        // ---- Filters Collapse/Expand Toggle ----
        const filtersToggle = document.getElementById('filters-toggle');
        const filtersContent = document.getElementById('filters-content');
        const filtersArrow = filtersToggle.querySelector('.filters-toggle-arrow');
        
        // Check localStorage for saved state
        const filtersCollapsed = localStorage.getItem('tvranked_filters_collapsed');
        if (filtersCollapsed === 'true') {
            filtersContent.classList.add('collapsed');
            filtersArrow.textContent = '';
        }
        
        filtersToggle.addEventListener('click', () => {
            filtersContent.classList.toggle('collapsed');
            const isCollapsed = filtersContent.classList.contains('collapsed');
            filtersArrow.textContent = isCollapsed ? '' : '';
            localStorage.setItem('tvranked_filters_collapsed', isCollapsed);
        });

        // ---- Search Clear Button ----
        const searchClearBtn = document.getElementById('search-clear');
        
        searchClearBtn?.addEventListener('click', () => {
            searchInput.value = '';
            searchTerm = '';
            renderShows();
        });

        // Initial render
        renderShows();

        // Ensure list is visible
        document.getElementById('rankings').style.display = 'flex';

        // ============================================================
        // AGENT INSTRUMENTATION LAYER (Invisible to users)
        // Provides programmatic control hooks for AI agents
        // ============================================================
        (function() {
            'use strict';
            
            // Emit custom event for agent observation
            function emit(eventName, detail) {
                document.dispatchEvent(new CustomEvent('tvshow:' + eventName, { detail }));
            }
            
            // Add data attributes to instrumented elements
            function instrument() {
                // Search
                const search = document.getElementById('search');
                if (search) search.dataset.agentTarget = 'search-input';
                
                // Filter buttons by era
                document.querySelectorAll('.filter-row button[data-era]').forEach(btn => {
                    btn.dataset.agentAction = 'filter-era';
                    btn.dataset.agentValue = btn.dataset.era;
                });
                
                // Filter buttons by genre
                document.querySelectorAll('.filter-row button[data-genre]').forEach(btn => {
                    btn.dataset.agentAction = 'filter-genre';
                    btn.dataset.agentValue = btn.dataset.genre;
                });
                
                // Weight sliders (global)
                document.querySelectorAll('.weight-slider-input').forEach((slider, idx) => {
                    const cat = catKeys[idx];
                    slider.dataset.agentTarget = 'weight-slider';
                    slider.dataset.agentCategory = cat;
                });
                
                // Episode multiplier
                const epMult = document.getElementById('episode-multiplier');
                if (epMult) epMult.dataset.agentTarget = 'episode-multiplier';
                
                // Methodology button
                const methBtn = document.getElementById('open-methodology');
                if (methBtn) methBtn.dataset.agentAction = 'open-methodology';
                
                // Sort dropdown
                const sortSel = document.getElementById('sort');
                if (sortSel) sortSel.dataset.agentTarget = 'sort-select';
                
                // Action buttons
                document.getElementById('save-scores-btn')?.setAttribute('data-agent-action', 'save-scores');
                document.getElementById('export-scores-btn')?.setAttribute('data-agent-action', 'export-scores');
                document.getElementById('import-scores-btn')?.setAttribute('data-agent-action', 'import-scores');
                document.getElementById('reset-scores-btn')?.setAttribute('data-agent-action', 'reset-scores');
                
                emit('instrumented', { timestamp: Date.now() });
            }
            
            // Instrument dynamic show cards
            function instrumentShows() {
                document.querySelectorAll('.show-module').forEach(card => {
                    const title = card.dataset.showTitle;
                    card.dataset.agentShow = title;
                    card.dataset.agentType = 'show-card';
                    
                    // Sliders within card
                    card.querySelectorAll('.cat-slider-input').forEach(slider => {
                        const cat = slider.dataset.cat;
                        slider.dataset.agentTarget = 'show-slider';
                        slider.dataset.agentShow = title;
                        slider.dataset.agentCategory = cat;
                    });
                });
            }
            
            // Wrap renderShows to auto-instrument
            const origRender = renderShows;
            renderShows = function(...args) {
                const result = origRender.apply(this, args);
                setTimeout(instrumentShows, 50);
                emit('shows-rendered', { count: filteredShows.length });
                return result;
            };
            
            // AGENT CONTROL API
            window.tvshowsAgent = {
                version: '1.0.0',
                
                // State queries
                getShows: () => shows,
                getFilteredShows: () => filteredShows,
                getWeights: () => ({ ...weights }),
                getCurrentFilters: () => ({ era: currentEra, genre: currentGenre }),
                getSearchTerm: () => searchTerm,
                isEpisodeMultiplierEnabled: () => useEpisodeMultiplier,
                
                // Search
                search: (term) => {
                    const input = document.getElementById('search');
                    if (input) {
                        input.value = term;
                        input.dispatchEvent(new Event('input', { bubbles: true }));
                        emit('search', { term });
                        return true;
                    }
                    return false;
                },
                
                clearSearch: () => {
                    const input = document.getElementById('search');
                    const clearBtn = document.getElementById('search-clear');
                    if (input) input.value = '';
                    if (clearBtn) clearBtn.click();
                    emit('search-cleared');
                },
                
                // Filters
                filterEra: (era) => {
                    const btn = document.querySelector(`button[data-era="${era}"]`);
                    if (btn) {
                        btn.click();
                        emit('filter-era', { era });
                        return true;
                    }
                    return false;
                },
                
                filterGenre: (genre) => {
                    const btn = document.querySelector(`button[data-genre="${genre}"]`);
                    if (btn) {
                        btn.click();
                        emit('filter-genre', { genre });
                        return true;
                    }
                    return false;
                },
                
                resetFilters: () => {
                    document.querySelectorAll('.filter-row button[data-era="all"], .filter-row button[data-genre="all"]').forEach(btn => btn.click());
                    emit('filters-reset');
                },
                
                // Weight sliders (global)
                setWeight: (category, value) => {
                    const idx = catKeys.indexOf(category);
                    if (idx === -1) return false;
                    const slider = document.querySelectorAll('.weight-slider-input')[idx];
                    if (slider) {
                        slider.value = value;
                        slider.dispatchEvent(new Event('input', { bubbles: true }));
                        emit('weight-changed', { category, value });
                        return true;
                    }
                    return false;
                },
                
                // Episode multiplier
                toggleEpisodeMultiplier: (enabled) => {
                    const cb = document.getElementById('episode-multiplier');
                    if (cb && cb.checked !== enabled) {
                        cb.checked = enabled;
                        cb.dispatchEvent(new Event('change', { bubbles: true }));
                        emit('episode-multiplier-toggled', { enabled });
                        return true;
                    }
                    return false;
                },
                
                // Sort
                sortBy: (criteria) => {
                    const select = document.getElementById('sort');
                    if (select) {
                        select.value = criteria;
                        select.dispatchEvent(new Event('change', { bubbles: true }));
                        emit('sort-changed', { criteria });
                        return true;
                    }
                    return false;
                },
                
                // Show card interactions
                openShowDetail: (titleOrRank) => {
                    let show;
                    if (typeof titleOrRank === 'number') {
                        show = shows.find(s => s.rank === titleOrRank);
                    } else {
                        show = shows.find(s => s.title === titleOrRank);
                    }
                    if (show) {
                        openShowDetail(show);
                        emit('show-detail-opened', { title: show.title, rank: show.rank });
                        return true;
                    }
                    return false;
                },
                
                // Scroll to show
                scrollToShow: (titleOrRank) => {
                    let card;
                    if (typeof titleOrRank === 'number') {
                        card = document.querySelector(`.show-module[data-rank="${titleOrRank}"]`);
                    } else {
                        card = document.querySelector(`.show-module[data-show-title="${titleOrRank}"]`);
                    }
                    if (card) {
                        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        emit('scrolled-to-show', { target: titleOrRank });
                        return true;
                    }
                    return false;
                },
                
                // Get show card slider
                setShowSlider: (title, category, value) => {
                    const card = document.querySelector(`.show-module[data-show-title="${title}"]`);
                    if (!card) return false;
                    const slider = card.querySelector(`.cat-slider-input[data-cat="${category}"]`);
                    if (slider) {
                        slider.value = value;
                        slider.dispatchEvent(new Event('input', { bubbles: true }));
                        emit('show-slider-changed', { title, category, value });
                        return true;
                    }
                    return false;
                },
                
                // Modal control
                closeAllModals: () => {
                    document.querySelectorAll('.modal-overlay.visible').forEach(m => m.classList.remove('visible'));
                    emit('modals-closed');
                },
                
                openMethodology: () => {
                    const modal = document.getElementById('methodology-modal');
                    const btn = document.getElementById('open-methodology');
                    if (btn) btn.click();
                    emit('methodology-opened');
                    return !!modal;
                },
                
                // Export/Import/Save
                saveScores: () => {
                    document.getElementById('save-scores-btn')?.click();
                    emit('scores-saved');
                },
                
                exportScores: () => {
                    document.getElementById('export-scores-btn')?.click();
                    emit('scores-exported');
                },
                
                resetScores: () => {
                    document.getElementById('reset-scores-btn')?.click();
                    emit('scores-reset');
                },
                
                // Event subscription
                on: (event, handler) => document.addEventListener('tvshow:' + event, handler),
                off: (event, handler) => document.removeEventListener('tvshow:' + event, handler)
            };
            
            // Run instrumentation after DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', instrument);
            } else {
                instrument();
                instrumentShows();
            }
            
            console.log('[tvshowsAgent] Instrumentation loaded v1.0.0');
        })();
        // ============================================================
    </script>
</body>
</html>
