<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="TV Shows Ranked - The definitive ranking of prestige TV dramas">
    <title>TV Shows Ranked</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Unna:wght@400;700&family=Source+Sans+3:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0f;
            --card: #14141c;
            --card-hover: #1a1a26;
            --border: #252532;
            --border-hover: #32324a;
            --text: #e8e8ec;
            --text-muted: #8a8a9a;
            --gold: #d4af37;
            --gold-dim: #9a7d2a;
            --gold-glow: rgba(212, 175, 55, 0.12);
            --silver: #a8a8b0;
            --silver-dim: #6a6a70;
            --bronze: #a87d4a;
            --bronze-dim: #6d5230;
            --accent: #64748b;
            --accent-dim: #475569;
            --accent-glow: rgba(100, 116, 139, 0.12);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Source Sans 3', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
            min-height: 100vh;
        }
        
        /* Header */
        header {
            padding: 4rem 2rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(180deg, #0f0f18 0%, var(--bg) 100%);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at center top, rgba(212, 175, 55, 0.05) 0%, transparent 70%);
            pointer-events: none;
        }
        
        h1 {
            font-family: 'Unna', serif;
            font-size: clamp(4rem, 10vw, 9rem);
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text) 0%, var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1.1;
        }
        
        .subtitle {
            color: var(--text-muted);
            font-size: 0.95rem;
        }
        
        .stats {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            gap: 2rem;
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        .stats span {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }
        
        .stats .num {
            font-family: 'Unna', serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text);
        }
        
        /* View Toggle */
        /* Methodology Badge */
        .methodology-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            color: #d4af37;
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border: 1px solid #d4af37;
            border-radius: 4px;
            background: transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .methodology-badge:hover {
            background: #d4af37;
            color: #0a0a0f;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }
        
        .methodology-icon {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }
        
        /* Methodology Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .modal-overlay.visible {
            display: flex;
        }
        
        .modal-content {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem 2.5rem;
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }
        
        .modal-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .modal-content::-webkit-scrollbar-track {
            background: #1a1a24;
            border-radius: 4px;
        }
        
        .modal-content::-webkit-scrollbar-thumb {
            background: var(--gold-dim);
            border-radius: 4px;
        }
        
        .modal-content::-webkit-scrollbar-thumb:hover {
            background: var(--gold);
        }
        
        /* Category Modal */
        .category-modal-content {
            max-width: 500px;
            padding: 1.5rem;
        }
        
        .category-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        .category-modal-header h2 {
            font-family: 'Unna', serif;
            font-size: 1.5rem;
            color: var(--text);
            margin: 0;
        }
        
        .category-modal-weight {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text);
            background: var(--border);
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .category-modal-desc {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-muted);
        }
        
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            line-height: 1;
        }
        
        .modal-close:hover {
            color: var(--gold);
        }
        
        .modal-content h2 {
            font-family: 'Unna', serif;
            font-size: 1.8rem;
            color: var(--text);
            margin-bottom: 1rem;
        }
        
        /* Methodology Navigation */
        .methodology-nav {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid var(--border);
        }
        
        .methodology-nav a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.75rem;
            padding: 0.35rem 0.75rem;
            border: 1px solid var(--border);
            border-radius: 100px;
            transition: all 0.2s;
        }
        
        .methodology-nav a:hover {
            color: var(--gold);
            border-color: var(--gold-dim);
        }
        
        /* Methodology Sections */
        .methodology-section {
            margin-bottom: 2.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 3px solid;
        }
        
        .methodology-intro {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05));
            border-color: #3b82f6;
        }
        
        .methodology-intro strong {
            color: #60a5fa;
        }
        
        .intro-header {
            margin-bottom: 1rem;
        }
        
        .intro-header h3 {
            font-size: 1.1rem;
            color: #60a5fa;
            margin-bottom: 0;
            font-weight: 600;
        }
        
        .methodology-intro p {
            margin-bottom: 1rem;
            line-height: 1.7;
        }
        
        .intro-example {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #60a5fa;
            padding: 0.75rem 1rem;
            border-radius: 0 6px 6px 0;
            margin: 1rem 0;
            line-height: 1.7;
        }
        
        .intro-example strong {
            color: #93c5fd;
        }
        
        .methodology-categories {
            border-left: 3px solid var(--border);
            padding-left: 0;
        }
        
        .methodology-category {
            margin-bottom: 1.75rem;
            padding: 1.25rem;
            background: var(--bg);
            border-radius: 6px;
            border: 1px solid var(--border);
        }
        
        .methodology-category:last-child {
            margin-bottom: 0;
        }
        
        .methodology-category h3 {
            font-family: 'Unna', serif;
            font-size: 1.2rem;
            color: var(--text);
            margin-bottom: 0;
            font-weight: 600;
            letter-spacing: 0.01em;
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .category-weight {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            background: var(--border);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .methodology-category p {
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.7;
            margin-bottom: 0;
        }
        
        .methodology-multipliers {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05));
            border-color: #f59e0b;
        }
        
        .methodology-multipliers h3 {
            color: #fbbf24;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }
        
        .methodology-multipliers p {
            font-size: 0.8rem;
            color: var(--text-muted);
            line-height: 1.7;
            margin-bottom: 0.5rem;
        }
        
        .methodology-multipliers strong {
            color: #fbbf24;
        }
        
        .methodology-tier {
            padding: 1.75rem;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.2));
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .methodology-tier h3 {
            font-size: 1.1rem;
            color: var(--text);
            margin-bottom: 1rem;
            font-weight: 600;
        }
        
        .methodology-tier p {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }
        
        .methodology-tier strong {
            color: var(--gold);
            font-weight: 600;
        }
        
        /* Multiplier Grid */
        .multiplier-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .multiplier-item {
            display: flex;
            flex-direction: column;
            padding: 0.6rem 0.75rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .multiplier-item.multiplier-negative {
            border-left: 3px solid #ef4444;
        }
        
        .multiplier-item.multiplier-negative .multiplier-value {
            color: #ef4444;
        }
        
        .multiplier-item.multiplier-neutral {
            border-left: 3px solid #64748b;
        }
        
        .multiplier-item.multiplier-neutral .multiplier-value {
            color: #64748b;
        }
        
        .multiplier-item.multiplier-positive {
            border-left: 3px solid #22c55e;
        }
        
        .multiplier-item.multiplier-positive .multiplier-value {
            color: #22c55e;
        }
        
        .multiplier-range {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .multiplier-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--gold);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .multiplier-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            opacity: 0.8;
        }
        
        /* Score Scale */
        .score-scale {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 1.25rem;
        }
        
        .scale-item {
            display: grid;
            grid-template-columns: 60px 150px 1fr;
            align-items: center;
            gap: 1.25rem;
            padding: 0.75rem 1.25rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        
        .scale-item.scale-perfect { border-left-color: #ffd700; }
        .scale-item.scale-incredible { border-left-color: #f0c75b; }
        .scale-item.scale-exceptional { border-left-color: #c0c0c0; }
        .scale-item.scale-very-good { border-left-color: #cd7f32; }
        .scale-item.scale-good { border-left-color: #4ade80; }
        .scale-item.scale-average { border-left-color: #60a5fa; }
        .scale-item.scale-below { border-left-color: #ef4444; }
        
        .scale-score {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--text);
        }
        
        .scale-label {
            font-weight: 600;
            font-size: 1rem;
            color: var(--text);
        }
        
        .scale-desc {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-style: italic;
        }
        
        /* Quick Compare Bar */
        .quick-compare {
            display: none;
            background: linear-gradient(180deg, var(--card) 0%, #0d0d14 100%);
            border-bottom: 1px solid var(--gold-dim);
            padding: 0.75rem 2rem;
            position: relative;
            z-index: 99;
        }
        
        .quick-compare.visible {
            display: block;
        }
        
        .quick-compare-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--gold);
            margin-bottom: 0.4rem;
        }
        
        .pinned-shows {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .pinned-card {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--bg);
            border: 1px solid var(--gold-dim);
            border-radius: 8px;
            padding: 0.5rem 0.75rem;
            min-width: 200px;
            position: relative;
        }
        
        .pinned-card .pin-rank {
            font-family: 'Unna', serif;
            font-weight: 900;
            color: var(--gold);
            font-size: 1.1rem;
        }
        
        .pinned-card .pin-title {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text);
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .pinned-card .pin-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--gold);
            font-weight: 600;
        }
        
        .pinned-card .unpin-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1rem;
            padding: 0;
            line-height: 1;
            opacity: 0.6;
            transition: opacity 0.2s;
        }
        
        .pinned-card .unpin-btn:hover {
            opacity: 1;
            color: var(--bronze);
        }
        
        /* Filters Section */
        .filters-section {
            background: linear-gradient(180deg, rgba(20,20,28,0.95), rgba(15,15,22,0.98));
            border-bottom: 1px solid #2a2a38;
            padding: 1.5rem 2rem;
            position: relative;
            z-index: 100;
        }
        
        .filter-group {
            margin-bottom: 1.25rem;
        }
        
        .filter-group:last-child {
            margin-bottom: 0;
        }
        
        .filter-label {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #64748b;
            margin-bottom: 0.6rem;
            display: block;
            font-weight: 500;
        }
        
        .filter-row {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .search-wrapper {
            position: relative;
            flex: 1;
            min-width: 200px;
        }
        
        .search-input {
            width: 100%;
            padding: 0.6rem 1rem 0.6rem 2.5rem;
            background: rgba(10,10,15,0.8);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23555566' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: 0.75rem center;
            border: 1px solid #2a2a38;
            color: #e0e0e8;
            border-radius: 4px;
            font-size: 0.85rem;
            font-family: 'Source Sans 3', sans-serif;
            transition: all 0.2s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #64748b;
            box-shadow: 0 0 0 2px rgba(100, 116, 139, 0.15);
        }
        
        .search-input::placeholder {
            color: #555566;
        }
        
        /* Weight Adjustment */
        .weight-group {
            background: rgba(10,10,15,0.6);
            border: 1px solid #2a2a38;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 0.5rem;
        }
        
        .weight-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #2a2a38;
        }
        
        .weight-section-title {
            font-family: 'Unna', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #e0e0e8;
            letter-spacing: -0.01em;
        }
        
        .weight-reset-btn {
            background: transparent;
            border: 1px solid #3a3a48;
            color: #64748b;
            padding: 0.3rem 0.6rem;
            border-radius: 3px;
            font-size: 0.65rem;
            font-family: 'Source Sans 3', sans-serif;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .weight-reset-btn:hover {
            border-color: #64748b;
            color: #e0e0e8;
            background: rgba(100, 116, 139, 0.15);
        }
        
        .weight-total {
            margin-bottom: 1rem;
        }
        
        .weight-total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.4rem 0.75rem;
            background: rgba(20,20,28,0.8);
            border-radius: 4px;
            border: 1px solid #2a2a38;
            margin-bottom: 0.35rem;
        }
        
        .weight-total-row span:first-child {
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-size: 0.7rem;
        }
        
        .weight-total-row.valid {
            background: rgba(34, 197, 94, 0.1);
            border-color: rgba(34, 197, 94, 0.3);
        }
        
        .weight-total-row.valid span:last-child {
            color: #22c55e;
        }
        
        .weight-total-row.invalid {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .weight-total-row.invalid span:last-child {
            color: #ef4444;
        }
        
        .weight-guidance {
            font-size: 0.7rem;
            color: #8a8a9a;
            text-align: center;
            letter-spacing: 0.02em;
            margin-bottom: 0.75rem;
        }
        
        .weight-warning {
            display: none;
            font-size: 0.75rem;
            color: #ef4444;
            margin-top: 0.5rem;
            text-align: center;
        }
        
        .weight-warning.visible {
            display: block;
        }
        
        .weight-sliders {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .weight-slider-row {
            display: grid;
            grid-template-columns: 140px 1fr 40px;
            align-items: center;
            gap: 0.75rem;
        }
        
        .weight-slider-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .weight-slider-input {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 4px;
            background: linear-gradient(180deg, #1a1a24 0%, #252532 100%);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
        }
        
        .weight-slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            background: linear-gradient(145deg, #64748b, #475569);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.15s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1);
        }
        
        .weight-slider-input::-webkit-slider-thumb:hover {
            background: linear-gradient(145deg, #94a3b8, #64748b);
            transform: scale(1.1);
        }
        
        .weight-slider-value {
            font-size: 0.75rem;
            font-weight: 500;
            color: #c0c0c8;
            font-family: 'JetBrains Mono', monospace;
            text-align: right;
            letter-spacing: -0.02em;
            min-width: 40px;
        }

        /* Per-card category score sliders */
        .cat-bar-container {
            position: relative;
            height: 14px;
            display: flex;
            align-items: center;
        }
        .cat-bar-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px;
            transform: translateY(-50%);
            background: #333;
            border-radius: 2px;
            overflow: hidden;
        }
        .cat-bar-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 0.1s ease, background 0.1s ease;
        }
        .cat-slider-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            cursor: pointer;
            margin: 0;
            padding: 0;
            z-index: 2;
        }
        .cat-slider-input::-webkit-slider-runnable-track {
            height: 14px;
            background: transparent;
        }
        .cat-slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 10px;
            height: 10px;
            background: #64748b;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.15s, background 0.15s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.4);
        }
        .cat-slider-input::-webkit-slider-thumb:hover {
            background: #94a3b8;
            transform: scale(1.3);
        }
        .cat-slider-input::-moz-range-track {
            height: 14px;
            background: transparent;
            border: none;
        }
        .cat-slider-input::-moz-range-thumb {
            width: 10px;
            height: 10px;
            background: #64748b;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            transition: transform 0.15s, background 0.15s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.4);
        }
        .cat-slider-input::-moz-range-thumb:hover {
            background: #94a3b8;
            transform: scale(1.3);
        }
        .cat-value-modified {
            color: #60a5fa !important;
        }

        /* Score save bar */
        .score-save-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, rgba(20,20,28,0.98), rgba(10,10,15,0.99));
            border-top: 1px solid #64748b;
            padding: 0.6rem 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            z-index: 999;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            flex-wrap: wrap;
        }
        .score-save-bar.visible {
            transform: translateY(0);
        }
        .score-save-bar .modified-count {
            font-size: 0.8rem;
            color: #60a5fa;
            font-family: 'JetBrains Mono', monospace;
        }
        .score-save-bar button {
            padding: 0.4rem 1rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        .save-btn {
            background: #64748b;
            color: #e8e8ec;
            border: 1px solid #64748b;
        }
        .save-btn:hover { background: #94a3b8; }
        .export-btn {
            background: transparent;
            color: #d4af37;
            border: 1px solid #d4af37;
        }
        .export-btn:hover { background: rgba(212,175,55,0.15); }
        .import-btn {
            background: transparent;
            color: #64748b;
            border: 1px solid #3a3a48;
        }
        .import-btn:hover { background: rgba(100,116,139,0.15); }
        .reset-btn {
            background: transparent;
            color: #ef4444;
            border: 1px solid #ef444480;
        }
        .reset-btn:hover { background: rgba(239,68,68,0.15); }

        @media (max-width: 600px) {
            .cat-slider-input::-webkit-slider-thumb {
                width: 16px;
                height: 16px;
            }
            .cat-slider-input::-moz-range-thumb {
                width: 16px;
                height: 16px;
            }
            .cat-bar-container {
                height: 20px;
            }
        }
        
        .weight-recalc-btn {
            display: block;
            width: 100%;
            margin-top: 1rem;
            padding: 0.6rem;
            background: transparent;
            color: #64748b;
            border: 1px solid #3a3a48;
            border-radius: 4px;
            font-size: 0.7rem;
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            opacity: 0.5;
            pointer-events: none;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        
        .weight-recalc-btn.active {
            opacity: 1;
            pointer-events: auto;
            color: #64748b;
            border-color: #64748b;
        }
        
        .weight-recalc-btn.active:hover {
            background: rgba(100, 116, 139, 0.15);
            box-shadow: 0 0 15px rgba(100, 116, 139, 0.2);
        }
            border-color: var(--accent-dim);
            color: var(--text);
        }
        
        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #555566;
            font-size: 1rem;
        }
        
        .range-wrapper {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }
        
        .range-slider {
            flex: 1;
            height: 4px;
            -webkit-appearance: none;
            background: var(--border);
            border-radius: 2px;
            cursor: pointer;
        }
        
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: var(--gold);
            border-radius: 50%;
            cursor: pointer;
        }
        
        .range-value {
            font-size: 0.8rem;
            color: var(--gold);
            min-width: 2.5rem;
            text-align: right;
        }
        
        .genre-pills {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
        }
        
        .genre-pill {
            padding: 0.3rem 0.7rem;
            background: transparent;
            border: 1px solid #3a3a48;
            color: #8a8a9a;
            cursor: pointer;
            border-radius: 100px;
            font-size: 0.65rem;
            font-family: 'Source Sans 3', sans-serif;
            transition: all 0.2s ease;
            letter-spacing: 0.03em;
            text-transform: lowercase;
        }
        
        .genre-pill:hover {
            border-color: #64748b;
            color: #c0c0c8;
            background: rgba(100, 116, 139, 0.1);
        }
        
        .genre-pill.active {
            background: #64748b;
            color: #ffffff;
            border-color: #64748b;
            font-weight: 500;
        }
        
        /* Filter buttons (Era) */
        .filter-btn {
            padding: 0.4rem 0.75rem;
            background: transparent;
            border: 1px solid #3a3a48;
            color: #8a8a9a;
            cursor: pointer;
            border-radius: 3px;
            font-size: 0.7rem;
            font-family: 'Source Sans 3', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            transition: all 0.2s ease;
        }
        
        .filter-btn:hover {
            border-color: #64748b;
            color: #c0c0c8;
            background: rgba(100, 116, 139, 0.1);
        }
        
        .filter-btn.active {
            background: #64748b;
            color: #ffffff;
            border-color: #64748b;
            font-weight: 600;
        }
        
        .active-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px solid var(--border);
        }
        
        .active-filter-tag {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.2rem 0.45rem;
            background: var(--gold-glow);
            border: 1px solid var(--gold-dim);
            border-radius: 4px;
            font-size: 0.65rem;
            color: var(--gold);
        }
        
        .active-filter-tag button {
            background: none;
            border: none;
            color: var(--gold);
            cursor: pointer;
            padding: 0;
            font-size: 0.85rem;
        }
        
        .clear-all {
            font-size: 0.65rem;
            color: var(--text-muted);
            cursor: pointer;
            background: none;
            border: none;
            text-decoration: underline;
        }
        
        /* Main */
        main {
            max-width: 900px;
            margin: 0 auto;
            padding: 1.5rem 1rem 4rem;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .results-count {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .results-count strong {
            color: var(--gold);
        }
        
        .sort-select {
            padding: 0.35rem 0.75rem;
            background: var(--bg);
            border: 1px solid var(--border);
            color: var(--text);
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
        }
        
        .sort-select:focus {
            outline: none;
            border-color: var(--gold);
        }
        
        /* Show Cards - Cinematic Editorial Style */
        .show-list {
            display: flex;
            flex-direction: column;
            gap: 0;
        }
        
        .show-list.hidden {
            display: none !important;
        }
        
        .score-breakdown.hidden {
            display: none !important;
        }
        
        .show-card {
            background: #14141c !important;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem 1.75rem;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: flex-start;
        }
        
        /* Universal transparent rule - strip backgrounds from card inner wrappers */
        .show-card .title-section,
        .show-card .score-section,
        .show-card .score-breakdown,
        .show-card .meta,
        .show-card .title-section *,
        .show-card .score-section *,
        .show-card .score-breakdown *,
        .show-card .meta * {
            background: transparent !important;
            box-shadow: none !important;
        }
        
        /* Exception: keep gradients for prestige elements */
        .show-card .rank-badge {
            background: linear-gradient(135deg, var(--gold-dim), var(--gold)) !important;
        }
        .show-card.tier-silver .rank-badge {
            background: linear-gradient(135deg, var(--silver-dim), var(--silver)) !important;
        }
        .show-card.tier-bronze .rank-badge {
            background: linear-gradient(135deg, var(--bronze-dim), var(--bronze)) !important;
        }
        .show-card .score-bar-fill {
            background: linear-gradient(90deg, #9E7F2A, #F0C75B, #9E7F2A) !important;
            background-size: 200% 100% !important;
        }
        .show-card .score-item.tier-silver .score-bar-fill {
            background: linear-gradient(90deg, #7a7a80, #c0c0c8, #7a7a80) !important;
            background-size: 200% 100% !important;
        }
        .show-card .score-item.tier-bronze .score-bar-fill {
            background: linear-gradient(90deg, #8B5A2B, #CD853F, #8B5A2B) !important;
            background-size: 200% 100% !important;
        }
        .show-card .season-badge {
            background: var(--gold) !important;
        }
        .show-card .final-score {
            background: unset !important;
        }
        
        /* Also preserve score bar track color */
        .show-card .score-bar {
            background: #333333 !important;
        }
        .show-card .score-item {
            background: transparent !important;
        }
        
        /* Poster transparency */
        .show-card .poster,
        .show-card .poster-placeholder {
            background: transparent !important;
        }
        
        /* Score desc transparency */
        .show-card .score-desc {
            background: transparent !important;
        }
        
        /* Score labels and values */
        .show-card .score-label-text,
        .show-card .score-value {
            background: transparent !important;
        }
        
        /* Genre tags */
        .show-card .genre-tag {
            background: transparent !important;
            border: 1px solid var(--gold) !important;
            color: var(--gold) !important;
            transition: all 0.3s ease;
        }
        .show-card .genre-tag:hover {
            background: var(--gold) !important;
            color: var(--bg) !important;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }
        
        /* Meta info */
        .show-card .meta .year,
        .show-card .meta .episodes {
            background: transparent !important;
        }
        
        /* Pin button - needs explicit background */
        .show-card .pin-btn {
            background: rgba(0, 0, 0, 0.6) !important;
        }
        
        .show-card:hover {
            background: #1a1a26 !important;
            border-color: var(--border-hover);
        }
        
        /* Force transparency on all card children */
        .show-card > * {
            background-color: transparent !important;
        }
            transition: opacity 0.3s;
        }
        
        .show-card::after {
            display: none !important;
        }
        
        .show-card:hover {
            background: var(--card-hover);
            border-color: var(--border-hover);
            transform: translateY(-3px);
            box-shadow: 0 16px 48px rgba(0,0,0,0.4);
        }
        
        .show-card::before,
        .show-card::after {
            display: none !important;
        }
        
        .show-card.tier-gold { border-color: var(--gold-dim); }
        .show-card.tier-gold .rank-badge { background: linear-gradient(135deg, var(--gold-dim), var(--gold)); color: var(--bg); border: none; box-shadow: 0 4px 16px rgba(212, 175, 55, 0.4); }
        
        .show-card.tier-silver { border-color: var(--silver-dim); }
        .show-card.tier-silver .rank-badge { background: linear-gradient(135deg, var(--silver-dim), var(--silver)); color: var(--bg); border: none; }
        
        .show-card.tier-bronze { border-color: var(--bronze-dim); }
        .show-card.tier-bronze .rank-badge { background: linear-gradient(135deg, var(--bronze-dim), var(--bronze)); color: var(--bg); border: none; }
        
        /* Card Header */
        .card-header {
            display: none; /* Removed - using direct children now */
        }
        
        .title-section {
            flex: 1;
            min-width: 200px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding-top: 0;
            margin-top: 0;
        }
        
        /* Poster Thumbnail */
        .poster {
            width: 120px;
            height: 180px;
            border-radius: 4px;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .poster-glow {
            display: none; /* Disabled for uniform card look */
        }
        
        .poster-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Unna', serif;
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.15);
            font-weight: 900;
        }
        
        /* Pin Button */
        .pin-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--border);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s;
            color: var(--text-muted);
            font-size: 0.9rem;
            z-index: 10;
        }
        
        .show-card:hover .pin-btn,
        .pin-btn.pinned {
            opacity: 1;
        }
        
        .pin-btn:hover {
            background: var(--gold);
            border-color: var(--gold);
            color: var(--bg);
        }
        
        .pin-btn.pinned {
            background: var(--gold);
            border-color: var(--gold);
            color: var(--bg);
        }
        
        .rank-badge {
            position: absolute;
            top: -12px;
            left: -12px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            background: var(--bg);
            border: 2px solid var(--gold-dim);
            border-radius: 50%;
            font-family: 'Unna', serif;
            font-weight: 900;
            font-size: 1.5rem;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            z-index: 10;
        }
        
        .title-section {
            flex: 1;
            min-width: 0;
            margin-top: -4px;
        }
        
        .show-title {
            font-family: 'Unna', serif;
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
            color: var(--text);
            letter-spacing: -0.01em;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }
        
        .season-badge {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 2px 6px;
            border: 1px solid var(--gold);
            border-radius: 4px;
            color: #000;
            background: #D4AF37;
            letter-spacing: 0.02em;
        }
            border: 1px solid var(--gold);
            border-radius: 4px;
            color: #000;
            background: var(--gold);
            letter-spacing: 0.02em;
        }
        
        .show-meta {
            display: flex;
            gap: 0.6rem;
            font-family: 'Unna', serif;
            font-size: 0.9rem;
            font-weight: 500;
            color: #AAAAAA;
            margin-top: 0.25rem;
            letter-spacing: 0.02em;
        }
        
        .show-meta .year::before {
            content: '•';
            margin-right: 0.6rem;
            color: var(--gold-dim);
        }
        
        .show-meta .year {
            color: var(--text);
        }
        
        .show-meta .episodes {
            color: var(--text-muted);
        }
        
        .score-section {
            text-align: right;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
            margin-left: auto;
        }
        
        .final-score {
            font-family: 'Unna', serif;
            font-size: 3.2rem;
            font-weight: 900;
            color: var(--gold);
            text-align: right;
            line-height: 1;
            text-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }
        
        .final-score.silver {
            color: var(--silver);
            text-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }
        
        .final-score.bronze {
            color: var(--bronze);
            text-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }
        
        .score-label {
            display: block;
            font-size: 0.6rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            text-align: right;
            margin-top: 0.3rem;
        }
        
        /* Score Breakdown - List View */
        .score-breakdown {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border);
            position: relative;
            z-index: 1;
            width: 100%;
        }
        
        .score-item {
            display: grid;
            grid-template-columns: 35% 55% 10%;
            align-items: center;
            gap: 0;
        }
        
        .score-label-text {
            font-family: 'Unna', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
            flex-shrink: 0;
            width: 100%;
            letter-spacing: 0.01em;
        }
        
        .score-bar {
            height: 6px;
            background: #333333;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            width: 100%;
        }
        
        .score-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.6s ease-out;
            width: 0;
            animation: shimmerMove 3s ease-in-out infinite;
        }
        
        @keyframes shimmerMove {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* Gold tier */
        .score-item.tier-gold .score-bar-fill { background: linear-gradient(90deg, #9E7F2A, #F0C75B, #9E7F2A); background-size: 200% 100%; }
        .score-item.tier-gold .score-value { color: var(--gold); }
        
        /* Silver tier */
        .score-item.tier-silver .score-bar-fill { background: linear-gradient(90deg, #7a7a80, #c0c0c8, #7a7a80); background-size: 200% 100%; }
        .score-item.tier-silver .score-value { color: var(--silver); }
        
        /* Bronze tier */
        .score-item.tier-bronze .score-bar-fill { background: linear-gradient(90deg, #6d5230, #c9955a, #6d5230); background-size: 200% 100%; }
        .score-item.tier-bronze .score-value { color: var(--bronze); }
        
        .score-value {
            font-family: 'Unna', serif;
            font-weight: 600;
            font-size: 1.4rem;
            color: var(--text);
            text-align: right;
            width: 100%;
            letter-spacing: 0.02em;
        }
        
        .score-value.clickable {
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .score-value.clickable:hover {
            color: var(--gold);
        }
        
        /* Clickable score label */
        .score-label-text.clickable {
            cursor: pointer;
            position: relative;
            transition: color 0.2s;
        }
        
        .score-label-text.clickable:hover {
            color: var(--gold);
        }
        
        .score-label-text.clickable::after {
            content: '▼';
            font-size: 0.5rem;
            margin-left: 0.3rem;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .score-label-text.clickable:hover::after {
            opacity: 0.5;
        }
        
        /* Score description accordion */
        .score-desc {
            display: none;
            font-size: 0.7rem;
            color: var(--text-muted);
            padding: 0.25rem 0;
            line-height: 1.4;
            font-style: italic;
            width: 100%;
            order: 3;
        }
        
        .score-desc.expanded {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        /* Genres */
        .genres {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
            margin-top: 1.25rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
            position: relative;
            z-index: 1;
        }
        
        .genre-tag {
            padding: 0.2rem 0.5rem;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 100px;
            font-family: 'Unna', serif;
            font-size: 0.7rem;
            font-weight: 500;
            color: var(--text-muted);
            transition: all 0.2s ease;
            cursor: pointer;
            letter-spacing: 0.03em;
        }
        
        .genre-tag:hover {
            border-color: var(--text-muted);
            color: var(--text);
        }
        
        /* Card methodology link */
        .card-methodology-link {
            font-family: 'Unna', serif;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-muted);
            text-decoration: none;
            border-bottom: 1px dashed var(--text-muted);
            transition: all 0.2s;
            margin-top: 0.5rem;
            display: inline-block;
            letter-spacing: 0.02em;
        }
        
        .card-methodology-link:hover {
            color: var(--gold);
            border-color: var(--gold);
        }
        
        /* Read Review Arrow */
        .read-more {
            position: absolute;
            bottom: 1rem;
            right: 1.5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 0.3rem;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .show-card:hover .read-more {
            opacity: 1;
            transform: translateX(-4px);
        }
        
        .read-more-arrow {
            transition: transform 0.3s;
        }
        
        .show-card:hover .read-more-arrow {
            transform: translateX(4px);
        }
        
        /* No Results */
        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            main {
                max-width: 100% !important;
                padding: 1rem 0.5rem 3rem !important;
            }
            .show-module {
                flex-direction: row !important;
                gap: 0.5rem !important;
                margin-bottom: 0.5rem !important;
                align-items: flex-start !important;
            }
            .show-poster {
                width: 100px !important;
                min-width: 100px !important;
                flex-shrink: 0 !important;
                border-radius: 6px 0 0 6px !important;
            }
            .show-poster img { 
                height: auto !important; 
                width: 100% !important;
            }
            .show-card-panel {
                border-radius: 0 6px 6px 0 !important;
                padding: 0.5rem !important;
                min-width: 0 !important;
            }
            header { padding: 2rem 1rem; }
            h1 { font-size: 2.5rem !important; }
            .subtitle { font-size: 0.8rem !important; padding: 0 1rem; }
            .stats { gap: 1rem !important; padding: 0 1rem; }
            .filters-section { padding: 0.5rem; }
            .card-header {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .show-title { flex: 1; min-width: 0; }
            .score-section { flex-shrink: 0; }
            .rank-badge { width: 28px; height: 28px; font-size: 0.75rem; flex-shrink: 0; }
            .score-section { text-align: left; margin-top: 0.25rem; }
            .score-label { text-align: left; }
            .show-card { padding: 0.5rem; }
            .show-title { font-size: 0.8rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
            .final-score { font-size: 1.2rem; }
            .show-meta { font-size: 0.65rem; }
            .score-breakdown {
                display: flex !important;
                flex-wrap: wrap !important;
                gap: 0.15rem !important;
                margin-top: 0.25rem !important;
                justify-content: flex-end !important;
            }
            .score-label-text { font-size: 0.45rem !important; width: auto !important; }
            .score-value { font-size: 0.5rem !important; }
            .score-bar-container { width: 20px !important; height: 2px !important; }
            .results-header { flex-direction: column; gap: 0.5rem; align-items: flex-start !important; }
        }
            .search-input { font-size: 0.9rem; padding: 0.5rem 1rem 0.5rem 2rem; }
            .genre-pills { gap: 0.3rem; flex-wrap: wrap; justify-content: center; }
            .genre-pill { padding: 0.3rem 0.6rem; font-size: 0.7rem; }
            .weight-slider-row { flex-direction: column; gap: 0.5rem; align-items: stretch; }
            .weight-slider-label { font-size: 0.8rem; min-width: unset; text-align: left; }
            .weight-slider-input { height: 8px !important; }
            .weight-slider-input::-webkit-slider-thumb { width: 24px !important; height: 24px !important; }
            .weight-value { font-size: 0.9rem; }
            .results-header { flex-direction: column; gap: 0.5rem; align-items: flex-start !important; }
        }
        
        @media (max-width: 900px) {
            .show-module { 
                gap: 0 !important; 
                margin-bottom: 0.75rem !important;
            }
            .show-poster {
                width: 120px !important;
                min-width: 120px !important;
                flex-shrink: 0 !important;
            }
            .show-poster img { 
                height: auto !important; 
                width: 100% !important;
            }
            .show-card-panel { 
                padding: 0.5rem 0.75rem !important;
                min-width: 0 !important;
            }
            .show-title { font-size: 1.1rem; }
            .final-score { font-size: 1.5rem; }
            header { padding: 3rem 1.5rem; }
            h1 { font-size: 3rem; }
            .subtitle { font-size: 0.9rem; }
            .stats { gap: 1.5rem; }
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes goldGlow {
            0%, 100% { text-shadow: 0 0 10px rgba(212, 175, 55, 0.3); }
            50% { text-shadow: 0 0 20px rgba(212, 175, 55, 0.6), 0 0 30px rgba(212, 175, 55, 0.3); }
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .show-card {
            animation: fadeIn 0.4s ease-out;
            animation-fill-mode: both;
        }
        
        /* ============================================
           CARD RESET - KILLS ALL BACKGROUND ARTIFACTS
           ============================================ */
        .show-card,
        .show-card *,
        .show-card *::before,
        .show-card *::after {
            background: transparent !important;
            background-color: transparent !important;
            background-image: none !important;
            box-shadow: none !important;
            text-shadow: none !important;
        }
        
        /* Now re-apply only what we need inline */
    </style>
</head>
<body>
    <header>
        <!-- Ornate corner decorations -->
        <div style="position:absolute;top:20px;left:20px;width:50px;height:50px;border-top:1px solid #d4af37;border-left:1px solid #d4af37;"></div>
        <div style="position:absolute;top:20px;right:20px;width:50px;height:50px;border-top:1px solid #d4af37;border-right:1px solid #d4af37;"></div>
        <div style="position:absolute;bottom:20px;left:20px;width:50px;height:50px;border-bottom:1px solid #d4af37;border-left:1px solid #d4af37;"></div>
        <div style="position:absolute;bottom:20px;right:20px;width:50px;height:50px;border-bottom:1px solid #d4af37;border-right:1px solid #d4af37;"></div>
        
        <!-- Center diamond ornament -->
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.2rem;color:#d4af37;opacity:0.5;">◆</div>
        
        <!-- Top decorative line -->
        <div style="position:absolute;top:0;left:10%;right:10%;height:1px;background:linear-gradient(90deg,transparent,#d4af37,#d4af37,transparent);"></div>
        
        <h1>TV Shows Ranked</h1>
        
        <!-- Ornate subtitle -->
        <p class="subtitle" style="font-family:'Source Sans 3',sans-serif;font-size:1.2rem;font-weight:300;color:#8a8a9a;letter-spacing:0.3em;text-transform:uppercase;margin-top:0.5rem;position:relative;display:inline-block;">
            <span style="position:absolute;left:-40px;top:50%;width:30px;height:1px;background:linear-gradient(90deg,transparent,#d4af37);"></span>
            100 prestige dramas scored across 7 categories
            <span style="position:absolute;right:-40px;top:50%;width:30px;height:1px;background:linear-gradient(90deg,#d4af37,transparent);"></span>
        </p>
        
        <div class="stats" style="margin-top:2rem;display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;align-items:center;">
            <div style="text-align:center;">
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">500</span>
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Shows Ranked</span>
            </div>
            <div style="width:1px;height:30px;background:#2a2a38;"></div>
            <div style="text-align:center;">
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">110</span>
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Showing</span>
            </div>
            <div style="width:1px;height:30px;background:#2a2a38;"></div>
            <div style="text-align:center;">
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">7</span>
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Evaluation Dimensions</span>
            </div>
            <div style="width:1px;height:30px;background:#2a2a38;"></div>
            <div style="text-align:center;">
                <span style="font-size:0.65rem;color:#555566;text-transform:uppercase;letter-spacing:0.12em;">Updated</span>
                <span class="num" style="font-family:'Unna',serif;font-size:1.4rem;font-weight:600;color:#8a8a9a;display:block;line-height:1;">February 2026</span>
            </div>
        </div>
        
        <!-- Bottom decorative line -->
        <div style="position:absolute;bottom:0;left:15%;right:15%;height:1px;background:linear-gradient(90deg,transparent,#252532,#d4af37,#252532,transparent);"></div>
    </header>
    
    <!-- Methodology Modal -->
    <div class="modal-overlay" id="methodology-modal">
        <div class="modal-content">
            <button class="modal-close" id="close-methodology">×</button>
            <h2>Ranking Methodology</h2>
            
            <div class="methodology-nav">
                <a href="#methodology-intro">Season Selection</a>
                <a href="#methodology-categories">Core Metrics</a>
                <a href="#methodology-multipliers">Multipliers</a>
                <a href="#methodology-scale">Scoring Scale</a>
            </div>
            
            <div class="methodology-section methodology-intro" id="methodology-intro">
                <div class="intro-header">
                    <h3>Season Selection Philosophy</h3>
                </div>
                <p>Shows are evaluated at their peak. When later seasons decline in quality, only the excellent seasons are included in the ranking.</p>
                <p class="intro-example"><strong>Example:</strong> Game of Thrones (S1-4) includes only the first four seasons—the show at its absolute best, before the source material ran out and quality declined.</p>
                <p>This mirrors how we select only the best shows for inclusion: we're ranking television excellence, not mediocrity. A show's weakest moments don't define it—its strongest do.</p>
            </div>
            
            <div class="methodology-section" id="methodology-categories">
                <div class="methodology-categories">
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Characters & Acting</h3>
                            <span class="category-weight">20%</span>
                        </div>
                        <p>Characters & Acting evaluates whether the people on screen feel like real individuals making authentic, internally consistent choices. It assesses depth of characterization, psychological believability, meaningful change over time, and the strength of the ensemble as a whole—not just standout leads. Acting is judged on embodiment and invisibility: performances should disappear into the role rather than draw attention to themselves. High scores reflect characters who feel autonomous, linger in the viewer's mind, and remain compelling beyond the immediate plot.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>World Building</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>World Building measures how fully realized and self-sustaining the show's world feels. This includes consistency of rules, institutions, cultures, and social structures, as well as the sense that life exists beyond the immediate story being told. A strong world feels navigable and durable: the viewer can understand how power works, how people live, and what pressures shape behavior without constant exposition. High scores are reserved for worlds that feel lived-in, coherent, and capable of supporting many stories.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Cinematography</h3>
                            <span class="category-weight">10%</span>
                        </div>
                        <p>Cinematography evaluates the visual craft and intentionality behind how the story is told. This includes framing, camera movement, lighting, color, composition, and visual rhythm, with emphasis on coherence and meaning rather than surface beauty. High-scoring shows demonstrate a distinctive and consistent visual language, where the camera communicates narrative or character information rather than merely recording events. A key marker is recognizability: the ability to identify the show from a single frame.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Visual Spectacle</h3>
                            <span class="category-weight">10%</span>
                        </div>
                        <p>Visual Spectacle measures the impact, ambition, and sustained presence of what is shown on screen. This includes large-scale environments, meticulously crafted sets, production design, visual effects, and striking or immersive imagery. Frequency matters when spectacle is genuinely sustained across scenes and episodes. Spectacle may also arise from novelty and exposure—revealing places, systems, or ways of life the viewer has rarely or never seen, captured with authority and detail. The focus is on how visually compelling and memorable the on-screen world is, whether through epic construction or grounded realism.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Conceptual Density</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>Conceptual Density measures how many distinct ideas a series meaningfully engages with, and how well those ideas are integrated into the narrative. These concepts may be political, philosophical, social, moral, or institutional, but must be dramatized through story, character, and world rather than stated directly. Higher scores reflect shows that sustain multiple independent concepts across episodes and seasons, explore them from different angles, and allow them to interact or conflict. The emphasis is on breadth of ideas combined with coherent execution, not symbolic interpretation or tone.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Narrative Drive</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>Narrative Drive assesses how effectively the story pulls the viewer forward. This includes pacing, clarity of stakes, escalation, and whether each episode meaningfully advances the narrative. A strong sense of drive does not require constant action; slower or quieter series can score highly if momentum, tension, or curiosity are consistently maintained. Filler, stalling, or structural wheel-spinning lowers the score. The core question is whether the story moves with purpose.</p>
                    </div>
                    <div class="methodology-category">
                        <div class="category-header">
                            <h3>Narrative Path & Resolution</h3>
                            <span class="category-weight">15%</span>
                        </div>
                        <p>Narrative Path & Resolution evaluates how effectively a series fulfills the narrative promises it introduces. This includes how many story loops, mysteries, arcs, or tensions are opened, how deliberately they are carried forward, and how meaningfully they are resolved. High scores reflect disciplined loop management, strong closure rates, and payoffs that feel earned—often enhancing or recontextualizing earlier material. Ambiguity is not penalized when intentional and coherent, but unresolved, rushed, or undermining resolutions reduce the score. This category rewards narrative discipline over novelty.</p>
                    </div>
                </div>
            </div>
            
            <div class="methodology-section methodology-multipliers" id="methodology-multipliers">
                <h3>Episode Count Multipliers</h3>
                <p>Longer shows that maintain quality across many hours are rewarded. The multiplier system recognizes that sustaining excellence over 60+ episodes is harder than over 6.</p>
                <div class="multiplier-grid">
                    <div class="multiplier-item multiplier-negative"><span class="multiplier-range">≤10 episodes</span><span class="multiplier-value">×0.96</span><span class="multiplier-label">Miniseries</span></div>
                    <div class="multiplier-item multiplier-negative"><span class="multiplier-range">11–20 episodes</span><span class="multiplier-value">×0.95</span><span class="multiplier-label">Short Series</span></div>
                    <div class="multiplier-item multiplier-negative"><span class="multiplier-range">21–30 episodes</span><span class="multiplier-value">×0.97</span><span class="multiplier-label">Limited Series</span></div>
                    <div class="multiplier-item multiplier-neutral"><span class="multiplier-range">31–40 episodes</span><span class="multiplier-value">×1.00</span><span class="multiplier-label">Baseline</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">41–50 episodes</span><span class="multiplier-value">×1.02</span><span class="multiplier-label">Standard Run</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">51–60 episodes</span><span class="multiplier-value">×1.03</span><span class="multiplier-label">Extended</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">61–75 episodes</span><span class="multiplier-value">×1.04</span><span class="multiplier-label">Long-Form</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">76–100 episodes</span><span class="multiplier-value">×1.05</span><span class="multiplier-label">Epic Run</span></div>
                    <div class="multiplier-item multiplier-positive"><span class="multiplier-range">100+ episodes</span><span class="multiplier-value">×1.06</span><span class="multiplier-label">Maximum Bonus</span></div>
                </div>
            </div>
            
            <div class="methodology-section methodology-tier" id="methodology-scale">
                <h3>The Scoring Scale</h3>
                <p>Every category uses a strict 1-10 scale calibrated for precision:</p>
                <div class="score-scale">
                    <div class="scale-item scale-perfect"><span class="scale-score">10</span><span class="scale-label">Perfect</span><span class="scale-desc">The gold standard, no meaningful flaws</span></div>
                    <div class="scale-item scale-incredible"><span class="scale-score">9</span><span class="scale-label">Incredible</span><span class="scale-desc">Near-flawless, only minor imperfections</span></div>
                    <div class="scale-item scale-exceptional"><span class="scale-score">8</span><span class="scale-label">Exceptional</span><span class="scale-desc">Among the very best in television</span></div>
                    <div class="scale-item scale-very-good"><span class="scale-score">7</span><span class="scale-label">Very Good</span><span class="scale-desc">Clearly stands out, memorable</span></div>
                    <div class="scale-item scale-good"><span class="scale-score">6</span><span class="scale-label">Good</span><span class="scale-desc">Noticeably above typical TV</span></div>
                    <div class="scale-item scale-average"><span class="scale-score">5</span><span class="scale-label">Average</span><span class="scale-desc">Competent but unremarkable</span></div>
                    <div class="scale-item scale-below"><span class="scale-score">≤4</span><span class="scale-label">Below Average</span><span class="scale-desc">Ranges from mediocre to poor</span></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Category Detail Modal -->
    <div class="modal-overlay" id="category-modal">
        <div class="modal-content category-modal-content">
            <button class="modal-close" id="close-category">&times;</button>
            <div class="category-modal-header">
                <h2 id="category-modal-title">Category</h2>
                <span class="category-modal-weight" id="category-modal-weight">20%</span>
            </div>
            <p class="category-modal-desc" id="category-modal-desc">Description</p>
        </div>
    </div>
    
    <!-- Quick Compare Bar -->
    <div class="quick-compare" id="quick-compare">
        <div class="quick-compare-label">📌 Quick Compare (Pinned Shows)</div>
        <div class="pinned-shows" id="pinned-shows"></div>
    </div>
    
    <div class="filters-section">
        <!-- Search -->
        <div class="filter-group">
            <div class="filter-row">
                <div class="search-wrapper">
                    <input type="text" class="search-input" placeholder="Search shows..." id="search">
                </div>
            </div>
        </div>
        
        <!-- Era Filter -->
        <div class="filter-group">
            <label class="filter-label">Era</label>
            <div class="filter-row" id="era-filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="last3mo">Last 3 Months</button>
                <button class="filter-btn" data-filter="last6mo">Last 6 Months</button>
                <button class="filter-btn" data-filter="thisYear">This Year</button>
                <button class="filter-btn" data-filter="2020s">2020s</button>
                <button class="filter-btn" data-filter="2010s">2010s</button>
                <button class="filter-btn" data-filter="2000s">2000s</button>
                <button class="filter-btn" data-filter="pre2000">Pre-2000</button>
            </div>
        </div>
        
        <!-- Genre Filter -->
        <div class="filter-group">
            <label class="filter-label">Genre</label>
            <div class="genre-pills" id="genre-filters">
                <button class="genre-pill active" data-genre="all">All</button>
                <button class="genre-pill" data-genre="drama">Drama</button>
                <button class="genre-pill" data-genre="crime">Crime</button>
                <button class="genre-pill" data-genre="thriller">Thriller</button>
                <button class="genre-pill" data-genre="mystery">Mystery</button>
                <button class="genre-pill" data-genre="sci-fi">Sci-Fi</button>
                <button class="genre-pill" data-genre="fantasy">Fantasy</button>
                <button class="genre-pill" data-genre="historical">Historical</button>
                <button class="genre-pill" data-genre="comedy">Comedy</button>
                <button class="genre-pill" data-genre="action">Action</button>
                <button class="genre-pill" data-genre="horror">Horror</button>
                <button class="genre-pill" data-genre="western">Western</button>
                <button class="genre-pill" data-genre="superhero">Superhero</button>
                <button class="genre-pill" data-genre="cop-show">Cop Show</button>
            </div>
        </div>
        
        <!-- Active Filters -->
        <div class="active-filters" id="active-filters"></div>
        
        <!-- Weight Adjustment -->
        <div class="filter-group weight-group">
            <a href="#" class="methodology-badge" id="open-methodology" style="display:flex;align-items:center;justify-content:center;gap:0.5rem;background:linear-gradient(135deg,rgba(212,175,55,0.15),rgba(212,175,55,0.05));border:1px solid #d4af37;color:#d4af37;padding:0.6rem 1rem;border-radius:4px;text-decoration:none;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.1em;transition:all 0.3s ease;margin-bottom:1rem;">
                <svg class="methodology-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;">
                    <path d="M3 6h18M3 12h18M3 18h18M7 6v12M17 6v12M7 9h.01M17 9h.01"/>
                </svg>
                Methodology & Criteria
            </a>
            <div class="weight-header">
                <span class="weight-section-title">Create Your Custom Ranking</span>
                <button class="weight-reset-btn" id="reset-weights">Reset</button>
            </div>
            <div class="weight-total-row">
                <span>Total</span>
                <span id="weight-total-value">100%</span>
            </div>
            <div class="weight-guidance">Adjust sliders until total reaches 100%</div>
            <div class="weight-sliders" id="weight-sliders">
                <!-- Generated by JS -->
            </div>
            <div class="weight-warning" id="weight-warning">⚠️ Total must equal 100%</div>
            
            <!-- Episode Multiplier Toggle -->
            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #3a3a48;">
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" id="multiplier-toggle" style="width: 16px; height: 16px; accent-color: #d4af37;">
                    <span style="color: #e0e0e8; font-size: 0.85rem;">Episode Multiplier</span>
                </label>
                <div style="color: #64748b; font-size: 0.7rem; margin-top: 0.25rem;">Longer shows get bonus points</div>
            </div>
        </div>
    </div>
    
    <main>
        <div class="results-header">
            <div class="results-count">Showing <strong id="results-num">100</strong> shows</div>
            <select class="sort-select" id="sort-select">
                <option value="rank">Sort by Rank</option>
                <option value="score-desc">Highest Score</option>
                <option value="score-asc">Lowest Score</option>
                <option value="year-desc">Newest First</option>
                <option value="year-asc">Oldest First</option>
                <option value="title">Alphabetical</option>
            </select>
        </div>
        <div class="show-list" id="rankings" style="display: flex;"></div>
        <div class="no-results" id="no-results" style="display: none;">
            <p>None</p>
        </div>
        <!-- Score Save Bar -->
        <div class="score-save-bar" id="score-save-bar">
            <span class="modified-count" id="modified-count">0 shows modified</span>
            <button class="save-btn" id="save-scores-btn">Save to localStorage</button>
            <button class="export-btn" id="export-scores-btn">Download JSON</button>
            <button class="import-btn" id="import-scores-btn">Import</button>
            <input type="file" id="import-scores-file" accept=".json" style="display:none;">
            <button class="reset-btn" id="reset-scores-btn">Reset All</button>
        </div>
    </main>

    <script>
        const TMDB_API_KEY = 'ca9b21cb89de2d1debed1050f603d7ad';
        const TMDB_IMAGE_BASE = 'https://image.tmdb.org/t/p/w500';
        
        // Dynamic data loading from JSON
        let shows = [];
        
        async function loadShowsData() {
            try {
                const response = await fetch('data/shows/index.json');
                const data = await response.json();
                shows = data.shows;
                console.log(`Loaded ${shows.length} shows from JSON`);
                initScoreSystem();
                renderShows();
            } catch (error) {
                console.error('Failed to load shows from JSON, using fallback:', error);
                // Fallback to embedded data if JSON fails
                shows = FALLBACK_SHOWS;
                initScoreSystem();
                renderShows();
            }
        }
        
        // Fallback embedded data (same as original)
        const FALLBACK_SHOWS = [
            { rank: 1, title: "Game of Thrones (S1-4)", year: 2011, month: 4, episodes: 40, char: 10, world: 10, cine: 8, spect: 9.5, conc: 9, drive: 10, resol: 9, final: 9.50, genres: ["fantasy", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/1XS1oqL89opfnbLl8WnZY1O1uJx.jpg" },
            { rank: 2, title: "Breaking Bad", year: 2008, month: 1, episodes: 62, char: 9, world: 7, cine: 9, spect: 6, conc: 8, drive: 10, resol: 10, final: 8.89, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/ztkUQFLlC19CCMYHW9o1zWhJRNq.jpg" },
            { rank: 3, title: "The Wire", year: 2002, month: 6, episodes: 60, char: 9.5, world: 10, cine: 6, spect: 7, conc: 10, drive: 7, resol: 9, final: 8.74, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/4lbclFySvugI51fwsyxBTOm4DqK.jpg" },
            { rank: 4, title: "Better Call Saul", year: 2015, month: 2, episodes: 63, char: 8.5, world: 7, cine: 9, spect: 6, conc: 8, drive: 9, resol: 10, final: 8.74, genres: ["crime", "drama"], poster: "https://image.tmdb.org/t/p/w500/fC2HDm5t0kHl7mTm7jxMR31b7by.jpg" },
            { rank: 5, title: "Chernobyl", year: 2019, month: 5, episodes: 5, char: 8, world: 8, cine: 9, spect: 9, conc: 9, drive: 10, resol: 10, final: 8.54, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/hlLXt2tOPT6RRnjiUmoxyG1LTFi.jpg" },
            { rank: 6, title: "The Sopranos", year: 1999, month: 1, episodes: 86, char: 9.5, world: 9, cine: 6, spect: 5, conc: 9, drive: 7, resol: 9, final: 8.38, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/rTc7ZXdroqjkKivFPvCPX0Ru7uw.jpg" },
            { rank: 7, title: "The Americans", year: 2013, month: 1, episodes: 75, char: 8, world: 7.5, cine: 7, spect: 5, conc: 8, drive: 8, resol: 10, final: 8.33, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/w1UBlxEXhbKe8sp0fxFZh7MqTce.jpg" },
            { rank: 8, title: "The Shield", year: 2002, month: 3, episodes: 88, char: 8.5, world: 6.5, cine: 6, spect: 5, conc: 7, drive: 9, resol: 10, final: 8.17, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/AfdZXqqlFsPUEfi6kWWWthxw7Nz.jpg" },
            { rank: 9, title: "The Expanse", year: 2015, month: 12, episodes: 62, char: 7.5, world: 9, cine: 7, spect: 9, conc: 8, drive: 7.5, resol: 7, final: 8.09, genres: ["sci-fi", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/8djpxDeWpINnGhjpFXQjnBe6zbx.jpg" },
            { rank: 10, title: "Succession", year: 2018, month: 6, episodes: 39, char: 8.5, world: 7, cine: 8, spect: 7, conc: 7, drive: 8.5, resol: 9, final: 8.03, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/z0XiwdrCQ9yVIr4O0pxzaAYRxdW.jpg" },
            { rank: 11, title: "Babylon Berlin", year: 2017, month: 10, episodes: 36, char: 7.5, world: 9, cine: 9, spect: 9, conc: 8, drive: 7.5, resol: 7, final: 8.03, genres: ["drama", "historical", "thriller"], poster: "https://image.tmdb.org/t/p/w500/om7Ri353ddUsg0gDJsOZIQJBRwL.jpg" },
            { rank: 12, title: "Mr. Robot", year: 2015, month: 5, episodes: 45, char: 8, world: 7, cine: 9, spect: 6, conc: 8, drive: 7.5, resol: 9, final: 7.99, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/kv1nRqgebSsREnd7vdC2pSGjpLo.jpg" },
            { rank: 13, title: "Boardwalk Empire", year: 2010, month: 9, episodes: 56, char: 9, world: 8.5, cine: 8.5, spect: 9, conc: 7, drive: 7, resol: 8, final: 7.98, genres: ["crime", "drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/kL6SqlVPpfAof2nQbh1VxkUuXBQ.jpg" },
            { rank: 14, title: "Andor", year: 2022, month: 9, episodes: 12, char: 8.5, world: 8.5, cine: 9, spect: 8.5, conc: 9, drive: 8.5, resol: 7, final: 7.96, genres: ["sci-fi", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/khZqmwHQicTYoS7Flreb9EddFZC.jpg" },
            { rank: 15, title: "Adolescence", year: 2025, month: 3, episodes: 4, char: 8, world: 6.5, cine: 9.5, spect: 5, conc: 9, drive: 9, resol: 10, final: 7.95, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/20i4nShZZg1g1VFHSB8xpaYM4r7.jpg" },
            { rank: 16, title: "True Detective S1", year: 2014, month: 1, episodes: 8, char: 8, world: 7.5, cine: 10, spect: 8, conc: 8, drive: 9, resol: 8, final: 7.90, genres: ["crime", "mystery", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/cuV2O5ZyDLHSOWzg3nLVljp1ubw.jpg" },
            { rank: 17, title: "For All Mankind", year: 2019, month: 11, episodes: 40, char: 7, world: 8, cine: 8, spect: 8, conc: 8, drive: 8, resol: 7.5, final: 7.88, genres: ["sci-fi", "drama"], poster: "https://image.tmdb.org/t/p/w500/JP3DItWMbrrLiKR5AYUfpsNf2b.jpg" },
            { rank: 18, title: "Mad Men", year: 2007, month: 7, episodes: 92, char: 8, world: 7.5, cine: 8, spect: 6, conc: 8, drive: 7, resol: 8, final: 7.88, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/7v8iCNzKFpdlrCMcqCoJyn74Nsa.jpg" },
            { rank: 19, title: "Halt and Catch Fire", year: 2014, month: 6, episodes: 40, char: 9, world: 7.5, cine: 7, spect: 5, conc: 8, drive: 8, resol: 9, final: 7.88, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/AtKo2gANo2QBgZN9ebTAa8hXnvv.jpg" },
            { rank: 20, title: "Angels in America", year: 2003, month: 12, episodes: 6, char: 8.5, world: 7, cine: 8, spect: 7, conc: 10, drive: 7, resol: 9, final: 7.82, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/rrV0kCmzcP8oB00gemSZDns90rb.jpg" },
            { rank: 21, title: "Dark", year: 2017, month: 12, episodes: 26, char: 7, world: 8, cine: 8.5, spect: 6.5, conc: 9, drive: 8.5, resol: 9, final: 7.79, genres: ["sci-fi", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/7CFCzWIZZcnxHke3yAQiGPWXHwF.jpg" },
            { rank: 22, title: "Deadwood", year: 2004, month: 3, episodes: 36, char: 9, world: 8.5, cine: 7, spect: 7, conc: 9, drive: 7, resol: 6, final: 7.78, genres: ["drama", "western"], poster: "https://image.tmdb.org/t/p/w500/fWwxYAuqY4Na7fKI3Qq2nFWCwG8.jpg" },
            { rank: 23, title: "The Crown", year: 2016, month: 11, episodes: 60, char: 7.5, world: 8, cine: 9, spect: 8, conc: 7, drive: 7, resol: 7, final: 7.76, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/1DDE0Z2Y805rqfkEjPbZsMLyPwa.jpg" },
            { rank: 24, title: "Justified", year: 2010, month: 3, episodes: 78, char: 8, world: 7.5, cine: 7, spect: 5, conc: 7, drive: 8, resol: 8, final: 7.75, genres: ["crime", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/ie1quhMk09lDtvtAyQAHTu09R9Z.jpg" },
            { rank: 25, title: "Band of Brothers", year: 2001, month: 9, episodes: 10, char: 7.5, world: 9, cine: 8, spect: 10, conc: 7, drive: 9, resol: 9, final: 7.73, genres: ["drama", "historical", "war"], poster: "https://image.tmdb.org/t/p/w500/8JMXquNmdMUy2n2RgW8gfOM0O3l.jpg" },
            { rank: 26, title: "Six Feet Under", year: 2001, month: 6, episodes: 63, char: 8, world: 6.5, cine: 7, spect: 5, conc: 8, drive: 6, resol: 10, final: 7.73, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/sCgzLaVlFy8KxtxRPvt1V5MNTDb.jpg" },
            { rank: 27, title: "Fargo", year: 2014, month: 4, episodes: 51, char: 7.5, world: 7, cine: 8.5, spect: 6.5, conc: 7, drive: 8, resol: 8, final: 7.73, genres: ["crime", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/6U9CPeD8obHzweikFhiLhpc7YBT.jpg" },
            { rank: 28, title: "It's a Sin", year: 2021, month: 1, episodes: 5, char: 8, world: 7.5, cine: 8, spect: 6, conc: 8, drive: 8, resol: 10, final: 7.71, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/tUaNS4b5TIiP1SwpHCYCbUoGpHG.jpg" },
            { rank: 29, title: "When They See Us", year: 2019, month: 5, episodes: 4, char: 8, world: 7, cine: 8, spect: 5, conc: 9, drive: 8, resol: 10, final: 7.68, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/oPv3nNtkuc6EPEql5lgdOuQNHuG.jpg" },
            { rank: 30, title: "Girls", year: 2012, month: 4, episodes: 62, char: 8.5, world: 7, cine: 7, spect: 5, conc: 8, drive: 7, resol: 8, final: 7.68, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/ikyT3hnELofnYRsPIqVGgUhDbOT.jpg" },
            { rank: 31, title: "Watchmen (2019)", year: 2019, month: 10, episodes: 9, char: 7.5, world: 8, cine: 8, spect: 8, conc: 9, drive: 8, resol: 8, final: 7.68, genres: ["drama", "sci-fi", "superhero"], poster: "https://image.tmdb.org/t/p/w500/m8rWq3j73ZGhDuSCZWMMoE9ePH1.jpg" },
            { rank: 32, title: "The Bureau", year: 2015, month: 4, episodes: 50, char: 8, world: 7.5, cine: 7, spect: 5, conc: 8, drive: 8, resol: 8, final: 7.68, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/noxbt8KgVz21vdLINfQ5P1CmflS.jpg" },
            { rank: 33, title: "Homeland", year: 2011, month: 12, episodes: 96, char: 8, world: 7, cine: 7, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.67, genres: ["drama", "thriller", "action"], poster: "https://image.tmdb.org/t/p/w500/6GAvS2e6VIRsms9FpVt33PsCoEW.jpg" },
            { rank: 34, title: "The Queen's Gambit", year: 2020, month: 10, episodes: 7, char: 7.5, world: 7.5, cine: 9, spect: 7, conc: 7, drive: 9, resol: 9, final: 7.66, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/zU0htwkhNvBQdVSIKB9s6hgVeFK.jpg" },
            { rank: 35, title: "The Leftovers", year: 2014, month: 6, episodes: 28, char: 7.5, world: 8, cine: 8, spect: 7, conc: 9, drive: 8, resol: 9, final: 7.64, genres: ["drama", "fantasy", "mystery"], poster: "https://image.tmdb.org/t/p/w500/ri8xr223xBb2TeHX3GKypvQPV2B.jpg" },
            { rank: 36, title: "Lost", year: 2004, month: 9, episodes: 121, char: 8, world: 7.5, cine: 7, spect: 7.5, conc: 7, drive: 8, resol: 5, final: 7.61, genres: ["sci-fi", "drama", "mystery"], poster: "https://image.tmdb.org/t/p/w500/og6S0aTZU6YUJAbqxeKjCa3kY1E.jpg" },
            { rank: 37, title: "The Knick", year: 2014, month: 8, episodes: 20, char: 8.5, world: 8.5, cine: 9.5, spect: 8, conc: 8, drive: 8, resol: 6, final: 7.60, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/oeEqDSIVOi6q0GcZj8L9Q6G7fGC.jpg" },
            { rank: 38, title: "The Haunting of Hill House", year: 2018, month: 10, episodes: 10, char: 8, world: 7, cine: 9, spect: 7, conc: 8, drive: 8, resol: 9, final: 7.60, genres: ["horror", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/38PkhBGRQtmVx2drvPik3F42qHO.jpg" },
            { rank: 39, title: "Friday Night Lights", year: 2006, month: 10, episodes: 76, char: 8, world: 7.5, cine: 7, spect: 5, conc: 7, drive: 7, resol: 8, final: 7.59, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/Eu7MzZY1DldJ683z7vLkILHNRD.jpg" },
            { rank: 40, title: "Wolf Hall", year: 2015, month: 4, episodes: 6, char: 8, world: 8.5, cine: 9, spect: 7, conc: 9, drive: 7, resol: 7, final: 7.58, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/dGuiMtUQBGxM3ZWosphO2MdYw8o.jpg" },
            { rank: 41, title: "Pluribus", year: 2025, month: 11, episodes: 10, char: 8.5, world: 7.5, cine: 8.5, spect: 7, conc: 9, drive: 8.5, resol: 6, final: 7.58, genres: ["drama", "thriller", "sci-fi"], poster: "https://image.tmdb.org/t/p/w500/z7Nga7Q9IGFWs5OEduY2gGFxnX3.jpg" },
            { rank: 42, title: "Hannibal", year: 2013, month: 4, episodes: 39, char: 8, world: 6.5, cine: 10, spect: 8.5, conc: 7, drive: 6.5, resol: 8, final: 7.55, genres: ["crime", "thriller", "horror", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/pbV2eLnKSIm1epSZt473UYfqaeZ.jpg" },
            { rank: 43, title: "Station Eleven", year: 2021, month: 12, episodes: 10, char: 7.5, world: 8, cine: 9, spect: 7, conc: 9, drive: 7, resol: 8, final: 7.53, genres: ["drama", "sci-fi"], poster: "https://image.tmdb.org/t/p/w500/xWlhMOzRxUpu4uzkWcDQOaESCE.jpg" },
            { rank: 44, title: "House of the Dragon", year: 2022, month: 8, episodes: 18, char: 8.5, world: 9.5, cine: 8, spect: 9.5, conc: 8, drive: 8, resol: 6, final: 7.53, genres: ["fantasy", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/7QMsOTMUswlwxJP0rTTZfmz2tX2.jpg" },
            { rank: 45, title: "Black Mirror", year: 2011, month: 12, episodes: 29, char: 7, world: 7, cine: 8, spect: 7, conc: 9, drive: 8, resol: 8, final: 7.52, genres: ["sci-fi", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/seN6rRfN0I6n8iDXjlSMk1QjNcq.jpg" },
            { rank: 46, title: "Midnight Mass", year: 2021, month: 9, episodes: 7, char: 7.5, world: 7.5, cine: 8, spect: 6, conc: 9, drive: 7, resol: 9, final: 7.52, genres: ["horror", "drama", "mystery"], poster: "https://image.tmdb.org/t/p/w500/iYoMZYVD775MtBYJfv6OGY1FsnL.jpg" },
            { rank: 47, title: "Battlestar Galactica", year: 2004, month: 1, episodes: 75, char: 7, world: 7, cine: 7, spect: 8, conc: 8, drive: 7, resol: 6, final: 7.51, genres: ["sci-fi", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/99PJSbcO2LeM10uOGWeFihNp77j.jpg" },
            { rank: 48, title: "Rectify", year: 2013, month: 12, episodes: 30, char: 9, world: 7, cine: 8.5, spect: 5, conc: 9, drive: 6, resol: 9, final: 7.50, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/tm9nQe9165cyjnTz8NB50izwcpJ.jpg" },
            { rank: 49, title: "Ozark", year: 2017, month: 7, episodes: 44, char: 7.5, world: 7, cine: 8, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.50, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/pCGyPVrI9Fzw6rE1Pvi4BIXF6ET.jpg" },
            { rank: 50, title: "Peaky Blinders", year: 2013, month: 9, episodes: 36, char: 7.5, world: 8, cine: 9, spect: 7.5, conc: 7, drive: 7, resol: 7, final: 7.50, genres: ["crime", "drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/vUUqzWa2LnHIVqkaKVlVGkVcZIW.jpg" },
            { rank: 51, title: "Beef", year: 2023, month: 4, episodes: 10, char: 8.5, world: 6.5, cine: 8, spect: 5, conc: 8, drive: 9, resol: 9, final: 7.49, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/4b4v7RnPhNyPEaVGFarEuo74r8W.jpg" },
            { rank: 52, title: "Severance", year: 2022, month: 2, episodes: 19, char: 7.5, world: 8.5, cine: 8.5, spect: 6.5, conc: 9, drive: 9, resol: 6, final: 7.49, genres: ["sci-fi", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/pPHpeI2X1qEd1CS1SeyrdhZ4qnT.jpg" },
            { rank: 53, title: "Shogun (2024)", year: 2024, month: 2, episodes: 10, char: 8, world: 9, cine: 9, spect: 9, conc: 7, drive: 7.5, resol: 7, final: 7.48, genres: ["drama", "historical", "action"], poster: "https://image.tmdb.org/t/p/w500/7O4iVfOMQmdCSxhOg1WnzG1AgYT.jpg" },
            { rank: 54, title: "Sharp Objects", year: 2018, month: 6, episodes: 8, char: 8.5, world: 7.5, cine: 9, spect: 6, conc: 8, drive: 7, resol: 8, final: 7.47, genres: ["drama", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/1SGovj2qDdkJexvhFiXllj9EYfu.jpg" },
            { rank: 55, title: "Patrick Melrose", year: 2018, month: 5, episodes: 5, char: 8.5, world: 7, cine: 8, spect: 6, conc: 8, drive: 7, resol: 9, final: 7.47, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/t6ubZ1Bpu0elTzA8tT2mxkrfpxA.jpg" },
            { rank: 56, title: "Generation Kill", year: 2008, month: 7, episodes: 7, char: 7.5, world: 8, cine: 8, spect: 7, conc: 9, drive: 7, resol: 8, final: 7.47, genres: ["drama", "war", "action"], poster: "https://image.tmdb.org/t/p/w500/wiihoYOODwh82xVzPoiaztlg6c9.jpg" },
            { rank: 57, title: "Squid Game", year: 2021, month: 9, episodes: 18, char: 7, world: 7.5, cine: 8, spect: 9, conc: 7, drive: 9, resol: 8, final: 7.46, genres: ["thriller", "drama", "sci-fi"], poster: "https://image.tmdb.org/t/p/w500/1QdXdRYfktUSONkl1oD5gc6Be0s.jpg" },
            { rank: 58, title: "24", year: 2001, month: 11, episodes: 192, char: 6.5, world: 6, cine: 6, spect: 7, conc: 6, drive: 9.5, resol: 7, final: 7.45, genres: ["action", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/iq6yrZ5LEDXf1ArCOYLq8PIUBpV.jpg" },
            { rank: 59, title: "Borgen", year: 2010, month: 9, episodes: 40, char: 8, world: 7, cine: 7, spect: 5, conc: 8, drive: 8, resol: 8, final: 7.45, genres: ["drama", "political"], poster: "https://image.tmdb.org/t/p/w500/3wB4R3Ac3lKSQWKpoU0zeRY8XqL.jpg" },
            { rank: 60, title: "Pose", year: 2018, month: 6, episodes: 26, char: 7.5, world: 8, cine: 8, spect: 7, conc: 8, drive: 7, resol: 8, final: 7.45, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/5f23i30nFJz0nrd3DGheOCqXa2P.jpg" },
            { rank: 61, title: "The White Lotus", year: 2021, month: 7, episodes: 21, char: 7.5, world: 7, cine: 9, spect: 8, conc: 8, drive: 7, resol: 8, final: 7.45, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/gbSaK9v1CbcYH1ISgbM7XObD2dW.jpg" },
            { rank: 62, title: "Utopia (UK)", year: 2013, month: 1, episodes: 12, char: 7.5, world: 7.5, cine: 10, spect: 7, conc: 8, drive: 9, resol: 6, final: 7.44, genres: ["sci-fi", "thriller", "drama"], poster: "https://image.tmdb.org/t/p/w500/snOU6W5CU7aGVSVu29wBWzdzNzi.jpg" },
            { rank: 63, title: "The X-Files", year: 1993, month: 9, episodes: 218, char: 7.5, world: 7.5, cine: 7, spect: 7, conc: 7, drive: 7, resol: 6, final: 7.40, genres: ["sci-fi", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/rcBx0p8h51LHceyhquYMxbspJQu.jpg" },
            { rank: 64, title: "Stranger Things", year: 2016, month: 7, episodes: 42, char: 7, world: 7, cine: 8, spect: 8, conc: 6, drive: 8, resol: 7, final: 7.40, genres: ["sci-fi", "horror", "drama"], poster: "https://image.tmdb.org/t/p/w500/uOOtwVbSr4QDjAGIifLDwpb2Pdl.jpg" },
            { rank: 65, title: "The Last of Us", year: 2023, month: 1, episodes: 16, char: 8, world: 7.5, cine: 8, spect: 8, conc: 8, drive: 8, resol: 7, final: 7.39, genres: ["drama", "action", "sci-fi"], poster: "https://image.tmdb.org/t/p/w500/dmo6TYuuJgaYinXBPjrgG9mB5od.jpg" },
            { rank: 66, title: "Twin Peaks: The Return", year: 2017, month: 5, episodes: 18, char: 8, world: 8, cine: 9.5, spect: 9, conc: 9, drive: 5, resol: 7, final: 7.39, genres: ["mystery", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/lA9CNSdo50iQPZ8A2fyVpMvJZAf.jpg" },
            { rank: 67, title: "Rome", year: 2005, month: 8, episodes: 22, char: 8, world: 8.5, cine: 7, spect: 9, conc: 8, drive: 8, resol: 6, final: 7.39, genres: ["drama", "historical", "action"], poster: "https://image.tmdb.org/t/p/w500/xLy4fhXUPocgMyFNPFac3tY4jwY.jpg" },
            { rank: 68, title: "Silo", year: 2023, month: 5, episodes: 20, char: 7.5, world: 8.5, cine: 8, spect: 8, conc: 8, drive: 8.5, resol: 6, final: 7.39, genres: ["sci-fi", "drama", "mystery"], poster: "https://image.tmdb.org/t/p/w500/c2OijvbFEXBW1onbzuvENr4CGQB.jpg" },
            { rank: 69, title: "The Underground Railroad", year: 2021, month: 5, episodes: 10, char: 7.5, world: 8, cine: 10, spect: 8, conc: 9, drive: 6, resol: 7, final: 7.39, genres: ["drama", "fantasy", "historical"], poster: "https://image.tmdb.org/t/p/w500/CrrTqw7LHafnbdH9UcK60aOZSm.jpg" },
            { rank: 70, title: "Penny Dreadful", year: 2014, month: 5, episodes: 27, char: 8, world: 8, cine: 9, spect: 8, conc: 8, drive: 7, resol: 6, final: 7.37, genres: ["horror", "drama", "fantasy"], poster: "https://image.tmdb.org/t/p/w500/hQSdrXBYTbLGHYDIseHkBOPXTgL.jpg" },
            { rank: 71, title: "Godless", year: 2017, month: 11, episodes: 7, char: 7.5, world: 8, cine: 9, spect: 8, conc: 7, drive: 7, resol: 8, final: 7.37, genres: ["drama", "western"], poster: "https://image.tmdb.org/t/p/w500/ePOD0ofGWFDTbZR84QhM7kpYMPX.jpg" },
            { rank: 72, title: "Gomorrah", year: 2014, month: 4, episodes: 58, char: 7, world: 8, cine: 8, spect: 6, conc: 7, drive: 7, resol: 7, final: 7.36, genres: ["crime", "drama"], poster: "https://image.tmdb.org/t/p/w500/cXsagSyQQki9vTbV3TTxRCGIIlQ.jpg" },
            { rank: 73, title: "Downton Abbey", year: 2010, month: 9, episodes: 52, char: 7, world: 8, cine: 8, spect: 8, conc: 6, drive: 7, resol: 7, final: 7.36, genres: ["drama", "historical"], poster: "https://image.tmdb.org/t/p/w500/7HgDYRYjym4BwbhKaqTQq771SKb.jpg" },
            { rank: 74, title: "Hill Street Blues", year: 1981, month: 1, episodes: 146, char: 7.5, world: 7, cine: 6, spect: 5, conc: 8, drive: 7, resol: 7, final: 7.35, genres: ["drama", "crime", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/elvCmYxmwVzv2va3rLKponOJOfm.jpg" },
            { rank: 75, title: "The Boys", year: 2019, month: 7, episodes: 40, char: 7, world: 7.5, cine: 7, spect: 8, conc: 8, drive: 8, resol: 6, final: 7.33, genres: ["superhero", "action", "drama"], poster: "https://image.tmdb.org/t/p/w500/2zmTngn1tYC1AvfnrFLhxeD82hz.jpg" },
            { rank: 76, title: "Mare of Easttown", year: 2021, month: 4, episodes: 7, char: 8, world: 7.5, cine: 7, spect: 5, conc: 7, drive: 8, resol: 9, final: 7.32, genres: ["crime", "drama", "mystery", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/78aK4Msbr22A5PGa6PZV0pAvdwf.jpg" },
            { rank: 77, title: "Euphoria", year: 2019, month: 6, episodes: 17, char: 8, world: 7, cine: 9.5, spect: 8.5, conc: 8, drive: 7, resol: 6, final: 7.30, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/3Q0hd3heuWwDWpwcDkhQOA6TYWI.jpg" },
            { rank: 78, title: "The Pacific", year: 2010, month: 3, episodes: 10, char: 7, world: 8, cine: 8, spect: 9, conc: 7, drive: 7, resol: 8, final: 7.30, genres: ["drama", "war", "historical"], poster: "https://image.tmdb.org/t/p/w500/x9Y1IMFdY8Ma222KcQadFEau0EB.jpg" },
            { rank: 79, title: "Escape at Dannemora", year: 2018, month: 11, episodes: 7, char: 8, world: 7, cine: 8, spect: 5, conc: 7, drive: 8, resol: 9, final: 7.30, genres: ["drama", "crime", "thriller"], poster: "https://image.tmdb.org/t/p/w500/odk6ccUtUJlGTzPApKS6s4CTTrK.jpg" },
            { rank: 80, title: "Line of Duty", year: 2012, month: 3, episodes: 37, char: 7.5, world: 7, cine: 7, spect: 5, conc: 7, drive: 9, resol: 7, final: 7.30, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/ysGUKnnR1pGYIndjXWcjupGbWpS.jpg" },
            { rank: 81, title: "Narcos", year: 2015, month: 8, episodes: 30, char: 7.5, world: 8, cine: 8, spect: 7, conc: 7, drive: 8, resol: 7, final: 7.26, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/rTmal9fDbwh5F0waol2hq35U4ah.jpg" },
            { rank: 82, title: "Oz", year: 1997, month: 7, episodes: 56, char: 7.5, world: 7.5, cine: 6, spect: 5, conc: 8, drive: 7, resol: 7, final: 7.26, genres: ["crime", "drama"], poster: "https://image.tmdb.org/t/p/w500/oTQ9PUnCgf9CimYeWuDGp8iaT07.jpg" },
            { rank: 83, title: "The Killing (DK)", year: 2007, month: 1, episodes: 40, char: 7.5, world: 7, cine: 7, spect: 5, conc: 7, drive: 8, resol: 8, final: 7.23, genres: ["crime", "drama", "mystery", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/iLvnc1aK2b2PNQhbyn4IVpDcmcX.jpg" },
            { rank: 84, title: "The Penguin", year: 2024, month: 10, episodes: 8, char: 8, world: 7.5, cine: 8, spect: 7, conc: 7, drive: 8, resol: 7, final: 7.23, genres: ["crime", "drama", "superhero"], poster: "https://image.tmdb.org/t/p/w500/vOWcqC4oDQws1doDWLO7d3dh5qc.jpg" },
            { rank: 85, title: "The Plot Against America", year: 2020, month: 3, episodes: 6, char: 7.5, world: 8, cine: 8, spect: 6, conc: 9, drive: 7, resol: 7, final: 7.23, genres: ["drama", "historical", "thriller"], poster: "https://image.tmdb.org/t/p/w500/rC5GUHvKxlk3WPyCh4mQ5q6HDxG.jpg" },
            { rank: 86, title: "Dopesick", year: 2021, month: 10, episodes: 8, char: 7.5, world: 7, cine: 7, spect: 5, conc: 9, drive: 8, resol: 8, final: 7.23, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/qW8Gpddy29faTcD7VuyKjwLXbKU.jpg" },
            { rank: 87, title: "Happy Valley", year: 2014, month: 10, episodes: 18, char: 8, world: 7, cine: 7, spect: 5, conc: 7, drive: 8, resol: 9, final: 7.22, genres: ["crime", "drama", "thriller", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/xZK5iQSrn2mouZEk2PwyLPCwa4u.jpg" },
            { rank: 88, title: "Broadchurch", year: 2013, month: 3, episodes: 24, char: 7.5, world: 7, cine: 8, spect: 6, conc: 7, drive: 8, resol: 8, final: 7.21, genres: ["crime", "drama", "mystery", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/2NhBFUTg5KVBmGwafxtLwVdsqrr.jpg" },
            { rank: 89, title: "The Affair", year: 2014, month: 10, episodes: 53, char: 7.5, world: 6.5, cine: 8, spect: 5, conc: 8, drive: 7, resol: 6, final: 7.14, genres: ["drama"], poster: "https://image.tmdb.org/t/p/w500/8scKJeu6GoxMqpt7UO5aMeU0TOn.jpg" },
            { rank: 90, title: "Twin Peaks", year: 1990, month: 4, episodes: 30, char: 7.5, world: 8, cine: 8, spect: 7, conc: 9, drive: 6, resol: 6, final: 7.13, genres: ["mystery", "drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/lA9CNSdo50iQPZ8A2fyVpMvJZAf.jpg" },
            { rank: 91, title: "Homicide: Life on the Street", year: 1993, month: 1, episodes: 122, char: 7.5, world: 6.5, cine: 6, spect: 5, conc: 7, drive: 7, resol: 7, final: 7.13, genres: ["crime", "drama", "cop-show"], poster: "https://image.tmdb.org/t/p/w500/nb5310xlFjx5r9TnpKoaOTQsAlP.jpg" },
            { rank: 92, title: "Foundation", year: 2021, month: 9, episodes: 30, char: 6, world: 9, cine: 9, spect: 10, conc: 8, drive: 6, resol: 5, final: 7.03, genres: ["sci-fi", "drama"], poster: "https://image.tmdb.org/t/p/w500/tg9I5pOY4M9CKj8U0cxVBTsm5eh.jpg" },
            { rank: 93, title: "The Handmaid's Tale", year: 2017, month: 4, episodes: 56, char: 7, world: 8, cine: 8.5, spect: 7.5, conc: 8, drive: 5, resol: 5, final: 7.03, genres: ["drama", "sci-fi", "thriller"], poster: "https://image.tmdb.org/t/p/w500/eGUT7j3n3rn5yGihlCgwUnD70HV.jpg" },
            { rank: 94, title: "The Bear", year: 2022, month: 6, episodes: 28, char: 7.5, world: 6.5, cine: 9, spect: 5, conc: 7, drive: 8, resol: 7, final: 7.01, genres: ["drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/eKfVzzEazSIjJMrw9ADa2x8ksLz.jpg" },
            { rank: 95, title: "Big Little Lies", year: 2017, month: 2, episodes: 14, char: 7.5, world: 7, cine: 8, spect: 7, conc: 7, drive: 7, resol: 8, final: 7.01, genres: ["drama", "thriller"], poster: "https://image.tmdb.org/t/p/w500/b4HNJOc2N6SGyEhf2RagdpAKBK6.jpg" },
            { rank: 96, title: "True Detective S3", year: 2019, month: 9, episodes: 8, char: 7.5, world: 7.5, cine: 8, spect: 6, conc: 7, drive: 7, resol: 8, final: 6.97, genres: ["crime", "mystery", "thriller"], poster: "https://image.tmdb.org/t/p/w500/cuV2O5ZyDLHSOWzg3nLVljp1ubw.jpg" },
            { rank: 97, title: "The Marvelous Mrs. Maisel", year: 2017, month: 3, episodes: 43, char: 7, world: 7, cine: 8, spect: 7, conc: 7, drive: 7, resol: 8, final: 6.96, genres: ["drama", "comedy", "historical"], poster: "https://image.tmdb.org/t/p/w500/zS7fQiOZiKCVH2vlYSiIsFWW8hh.jpg" },
            { rank: 98, title: "Killing Eve", year: 2018, month: 4, episodes: 32, char: 7, world: 6.5, cine: 7, spect: 7, conc: 7, drive: 8, resol: 7, final: 6.90, genres: ["thriller", "action", "drama"], poster: "https://image.tmdb.org/t/p/w500/4wKhTVw8aGq5AZMa0Q1spERdi7n.jpg" },
            { rank: 99, title: "Barry", year: 2018, month: 3, episodes: 32, char: 7.5, world: 6, cine: 8, spect: 6, conc: 7, drive: 8, resol: 7, final: 6.88, genres: ["crime", "drama", "comedy"], poster: "https://image.tmdb.org/t/p/w500/j1XpwD11f0BAEI7pX6UdMhUVX2F.jpg" },
            { rank: 100, title: "Westworld", year: 2016, month: 11, episodes: 36, char: 7, world: 8, cine: 8, spect: 8, conc: 7, drive: 5, resol: 5, final: 6.83, genres: ["sci-fi", "western", "drama"], poster: "https://image.tmdb.org/t/p/w500/8MfgyFHf7XEboZJPZXCIDqqiz6e.jpg" },
            { rank: 101, title: "Slow Horses", year: 2022, month: 4, episodes: 18, char: 8, world: 7, cine: 7, spect: 6, conc: 7, drive: 8, resol: 7, final: 7.98, genres: ["thriller", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/dnpatlJrEPiDSn5fzgzvxtiSnMo.jpg" },
            { rank: 102, title: "Somebody Somewhere", year: 2022, month: 3, episodes: 25, char: 8, world: 6.5, cine: 7, spect: 5, conc: 6, drive: 7, resol: 8, final: 7.85, genres: ["comedy", "drama"], poster: "https://image.tmdb.org/t/p/w500/1GkoExnlnyTcyGWIo4C3yS1mRYf.jpg" },
            { rank: 103, title: "Frieren: Beyond Journey's End", year: 2023, month: 9, episodes: 28, char: 8, world: 8, cine: 8, spect: 7, conc: 7, drive: 7, resol: 8, final: 8.76, genres: ["anime", "fantasy", "drama"], poster: "https://image.tmdb.org/t/p/w500/dqZENchTd7lp5zht7BdlqM7RBhD.jpg" },
            { rank: 104, title: "The Rehearsal", year: 2022, month: 7, episodes: 6, char: 7.5, world: 6.5, cine: 8, spect: 5, conc: 8, drive: 7, resol: 7, final: 7.75, genres: ["comedy", "documentary"], poster: "https://image.tmdb.org/t/p/w500/mIevNYxovnH4sR22qkUmAgS5vdv.jpg" },
            { rank: 105, title: "Interview with the Vampire", year: 2022, month: 10, episodes: 18, char: 8, world: 7.5, cine: 8, spect: 7, conc: 7, drive: 7, resol: 7, final: 7.40, genres: ["horror", "drama", "fantasy"], poster: "https://image.tmdb.org/t/p/w500/Afv4pPhqVMg2wOmhuDLiGUw4r4O.jpg" },
            { rank: 106, title: "Rick and Morty", year: 2013, month: 12, episodes: 72, char: 8.5, world: 9, cine: 7, spect: 7, conc: 8, drive: 8, resol: 6, final: 8.68, genres: ["animation", "sci-fi", "comedy"], poster: "https://image.tmdb.org/t/p/w500/WGRQ8FpjkDTzivQJ43t94bOuY0.jpg" },
            { rank: 107, title: "The Day of the Jackal", year: 2024, month: 11, episodes: 8, char: 7.5, world: 7, cine: 8, spect: 6, conc: 7, drive: 8, resol: 7, final: 8.16, genres: ["thriller", "drama", "action"], poster: "https://image.tmdb.org/t/p/w500/tYLecM3WSEjlkKhkGiH5G68Dprm.jpg" },
            { rank: 108, title: "Telemarketers", year: 2023, month: 8, episodes: 9, char: 7, world: 6, cine: 7, spect: 5, conc: 7, drive: 7, resol: 8, final: 7.25, genres: ["documentary", "comedy"], poster: "https://image.tmdb.org/t/p/w500/eyeamvQYIgDQo1vFOs8pMujPVBf.jpg" },
            { rank: 109, title: "A Man on the Inside", year: 2024, month: 11, episodes: 8, char: 7.5, world: 6.5, cine: 7, spect: 5, conc: 6, drive: 7, resol: 8, final: 7.47, genres: ["comedy", "drama"], poster: "https://image.tmdb.org/t/p/w500/c09XdTLpLku2tqHt158NZBgC4hi.jpg" }
        ];

        // Initialize by loading from JSON (or fallback)
        loadShowsData();

        const list = document.getElementById('rankings');
        const noResults = document.getElementById('no-results');
        const searchInput = document.getElementById('search');
        const scoreFilter = document.getElementById('score-filter');
        const scoreValue = document.getElementById('score-value');
        const sortSelect = document.getElementById('sort-select');
        const resultsNum = document.getElementById('results-num');
        const activeFiltersEl = document.getElementById('active-filters');
        
        let currentGenres = ['all'];
        let currentEras = [];
        let minScore = 6.5;
        let searchTerm = '';
        let sortBy = 'rank';
        let viewMode = 'list';
        
        // Default weights
        const defaultWeights = { char: 20, world: 15, cine: 10, spect: 10, conc: 15, drive: 15, resol: 15 };
        let weights = { ...defaultWeights };
        
        // Episode multiplier toggle
        let multiplierEnabled = false;

        // Score override system
        const baseScores = {};
        const activeScores = {};
        const modifiedShows = new Set();
        const catKeys = ['char', 'world', 'cine', 'spect', 'conc', 'drive', 'resol'];

        function recalcFinal(show) {
            const val = (
                (show.char * weights.char) +
                (show.world * weights.world) +
                (show.cine * weights.cine) +
                (show.spect * weights.spect) +
                (show.conc * weights.conc) +
                (show.drive * weights.drive) +
                (show.resol * weights.resol)
            ) / 100;
            show.final = parseFloat(val.toFixed(2));
            return show.final;
        }

        function initScoreSystem() {
            // Build base scores from loaded data
            shows.forEach(show => {
                baseScores[show.title] = {};
                activeScores[show.title] = {};
                catKeys.forEach(key => {
                    baseScores[show.title][key] = show[key];
                    activeScores[show.title][key] = show[key];
                });
                // Also save the original final score
                baseScores[show.title].final = show.final;
            });

            // Restore overrides from localStorage
            try {
                const saved = localStorage.getItem('tvranked_score_overrides');
                if (saved) {
                    const overrides = JSON.parse(saved);
                    Object.keys(overrides).forEach(title => {
                        const show = shows.find(s => s.title === title);
                        if (!show) return;
                        const changes = overrides[title];
                        let hasChange = false;
                        catKeys.forEach(key => {
                            if (changes[key] !== undefined && changes[key] !== baseScores[title][key]) {
                                show[key] = changes[key];
                                activeScores[title][key] = changes[key];
                                hasChange = true;
                            }
                        });
                        if (hasChange) {
                            modifiedShows.add(title);
                            recalcFinal(show);
                        }
                    });

                    if (modifiedShows.size > 0) {
                        // Re-sort and re-rank
                        shows.sort((a, b) => b.final - a.final);
                        shows.forEach((show, idx) => { show.rank = idx + 1; });
                        updateSaveBar();
                    }
                }
            } catch (e) {
                console.error('Failed to restore score overrides:', e);
            }
        }

        function updateSaveBar() {
            const bar = document.getElementById('score-save-bar');
            const countEl = document.getElementById('modified-count');
            if (!bar) return;
            if (modifiedShows.size > 0) {
                bar.classList.add('visible');
                countEl.textContent = modifiedShows.size + ' show' + (modifiedShows.size !== 1 ? 's' : '') + ' modified';
            } else {
                bar.classList.remove('visible');
            }
        }

        function saveOverridesToStorage() {
            const overrides = {};
            modifiedShows.forEach(title => {
                overrides[title] = {};
                catKeys.forEach(key => {
                    overrides[title][key] = activeScores[title][key];
                });
            });
            localStorage.setItem('tvranked_score_overrides', JSON.stringify(overrides));
        }
        
        // Initialize weight sliders
        function initWeightSliders() {
            const slidersContainer = document.getElementById('weight-sliders');
            if (!slidersContainer) return;
            
            slidersContainer.innerHTML = categories.map(cat => `
                <div class="weight-slider-row">
                    <span class="weight-slider-label">${cat.label}</span>
                    <input type="range" class="weight-slider-input" data-key="${cat.key}" min="0" max="100" step="5" value="${weights[cat.key]}">
                    <span class="weight-slider-value" id="weight-value-${cat.key}">${weights[cat.key]}%</span>
                </div>
            `).join('');
            
            // Add event listeners
            slidersContainer.querySelectorAll('.weight-slider-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    const key = e.target.dataset.key;
                    const value = parseInt(e.target.value);
                    weights[key] = value;
                    document.getElementById(`weight-value-${key}`).textContent = value + '%';
                    updateWeightTotal();
                    
                    // Auto-recalculate if total = 100
                    const total = Object.values(weights).reduce((a, b) => a + b, 0);
                    if (total === 100) {
                        recalculateWithWeights();
                    }
                });
            });
            
            updateWeightTotal();
        }
        
        function updateWeightTotal() {
            const total = Object.values(weights).reduce((a, b) => a + b, 0);
            const totalEl = document.getElementById('weight-total-value');
            const totalContainer = document.querySelector('.weight-total-row');
            const warningEl = document.getElementById('weight-warning');
            const recalcBtn = document.getElementById('recalc-weights');
            
            totalEl.textContent = total + '%';
            
            // Enable recalc only when total = 100
            if (total === 100) {
                totalContainer.classList.add('valid');
                totalContainer.classList.remove('invalid');
                warningEl.classList.remove('visible');
                recalcBtn?.classList.add('active');
            } else {
                totalContainer.classList.add('invalid');
                totalContainer.classList.remove('valid');
                warningEl.textContent = total > 100 ? `⚠️ Total ${total}% - reduce to 100%` : `⚠️ Total must equal 100%`;
                warningEl.classList.add('visible');
                recalcBtn?.classList.remove('active');
            }
        }
        
        // Reset weights
        document.getElementById('reset-weights')?.addEventListener('click', () => {
            weights = { ...defaultWeights };
            initWeightSliders();
            recalculateWithWeights();
        });
        
        // Recalculate rankings with custom weights (shared function)
        function recalculateWithWeights() {
            // Recalculate final scores from BASE scores (not current modifications)
            shows.forEach(show => {
                const base = baseScores[show.title];
                if (!base) return;
                let val = (
                    (base.char * weights.char) +
                    (base.world * weights.world) +
                    (base.cine * weights.cine) +
                    (base.spect * weights.spect) +
                    (base.conc * weights.conc) +
                    (base.drive * weights.drive) +
                    (base.resol * weights.resol)
                ) / 100;
                
                // Apply multiplier if enabled
                if (multiplierEnabled) {
                    val = val * getMultiplier(show.episodes);
                }
                
                show.final = parseFloat(val.toFixed(2));
            });

            // Re-sort shows by new final score
            shows.sort((a, b) => b.final - a.final);

            // Update ranks
            shows.forEach((show, idx) => {
                show.rank = idx + 1;
            });

            // Re-render
            renderShows();
        }
        
        // Legacy button handler (kept for compatibility)
        document.getElementById('recalc-weights')?.addEventListener('click', () => {
            const total = Object.values(weights).reduce((a, b) => a + b, 0);
            if (total !== 100) return;
            recalculateWithWeights();
        });
        
        // Episode multiplier toggle
        document.getElementById('multiplier-toggle')?.addEventListener('change', (e) => {
            multiplierEnabled = e.target.checked;
            console.log('Multiplier toggled:', multiplierEnabled);
            
            // Recalculate from BASE scores (not current - avoids double multiplication)
            shows.forEach(show => {
                const base = baseScores[show.title];
                if (!base) return;
                
                // First calculate from base scores with current weights
                let val = (
                    (base.char * weights.char) +
                    (base.world * weights.world) +
                    (base.cine * weights.cine) +
                    (base.spect * weights.spect) +
                    (base.conc * weights.conc) +
                    (base.drive * weights.drive) +
                    (base.resol * weights.resol)
                ) / 100;
                
                // Then apply multiplier if enabled
                if (multiplierEnabled) {
                    val = val * getMultiplier(show.episodes);
                }
                
                show.final = parseFloat(val.toFixed(2));
            });
            
            // Sort and re-rank
            shows.sort((a, b) => b.final - a.final);
            shows.forEach((s, i) => { s.rank = i + 1; });
            
            renderShows();
        });
        
        // Initialize on load
        // Note: initWeightSliders called after categories is defined

        const categories = [
            { key: 'char', label: 'Characters & Acting', weight: '20%', desc: 'Characters & Acting evaluates whether the people on screen feel like real individuals making authentic, internally consistent choices. It assesses depth of characterization, psychological believability, meaningful change over time, and the strength of the ensemble as a whole—not just standout leads. Acting is judged on embodiment and invisibility: performances should disappear into the role rather than draw attention to themselves. High scores reflect characters who feel autonomous, linger in the viewer\'s mind, and remain compelling beyond the immediate plot.' },
            { key: 'world', label: 'World Building', weight: '15%', desc: 'World Building measures how fully realized and self-sustaining the show\'s world feels. This includes consistency of rules, institutions, cultures, and social structures, as well as the sense that life exists beyond the immediate story being told. A strong world feels navigable and durable: the viewer can understand how power works, how people live, and what pressures shape behavior without constant exposition. High scores are reserved for worlds that feel lived-in, coherent, and capable of supporting many stories.' },
            { key: 'cine', label: 'Cinematography', weight: '10%', desc: 'Cinematography evaluates the visual craft and intentionality behind how the story is told. This includes framing, camera movement, lighting, color, composition, and visual rhythm, with emphasis on coherence and meaning rather than surface beauty. High-scoring shows demonstrate a distinctive and consistent visual language, where the camera communicates narrative or character information rather than merely recording events. A key marker is recognizability: the ability to identify the show from a single frame.' },
            { key: 'spect', label: 'Visual Spectacle', weight: '10%', desc: 'Visual Spectacle measures the impact, ambition, and sustained presence of what is shown on screen. This includes large-scale environments, meticulously crafted sets, production design, visual effects, and striking or immersive imagery. Frequency matters when spectacle is genuinely sustained across scenes and episodes. Spectacle may also arise from novelty and exposure—revealing places, systems, or ways of life the viewer has rarely or never seen, captured with authority and detail. The focus is on how visually compelling and memorable the on-screen world is, whether through epic construction or grounded realism.' },
            { key: 'conc', label: 'Conceptual Density', weight: '15%', desc: 'Conceptual Density measures how many distinct ideas a series meaningfully engages with, and how well those ideas are integrated into the narrative. These concepts may be political, philosophical, social, moral, or institutional, but must be dramatized through story, character, and world rather than stated directly. Higher scores reflect shows that sustain multiple independent concepts across episodes and seasons, explore them from different angles, and allow them to interact or conflict. The emphasis is on breadth of ideas combined with coherent execution, not symbolic interpretation or tone.' },
            { key: 'drive', label: 'Narrative Drive', weight: '15%', desc: 'Narrative Drive assesses how effectively the story pulls the viewer forward. This includes pacing, clarity of stakes, escalation, and whether each episode meaningfully advances the narrative. A strong sense of drive does not require constant action; slower or quieter series can score highly if momentum, tension, or curiosity are consistently maintained. Filler, stalling, or structural wheel-spinning lowers the score. The core question is whether the story moves with purpose.' },
            { key: 'resol', label: 'Narrative Path & Resolution', weight: '15%', desc: 'Narrative Path & Resolution evaluates how effectively a series fulfills the narrative promises it introduces. This includes how many story loops, mysteries, arcs, or tensions are opened, how deliberately they are carried forward, and how meaningfully they are resolved. High scores reflect disciplined loop management, strong closure rates, and payoffs that feel earned—often enhancing or recontextualizing earlier material. Ambiguity is not penalized when intentional and coherent, but unresolved, rushed, or undermining resolutions reduce the score. This category rewards narrative discipline over novelty.' }
        ];

        // Initialize weight sliders after categories is defined
        initWeightSliders();

        function getEra(year, month) {
            const now = new Date();
            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth() + 1; // 1-12
            
            // This year (current year)
            if (year === currentYear) return 'thisYear';
            
            // Last 3 months: current year if we're in Jan-Mar, or previous year
            if (currentMonth <= 3) {
                // In Jan-Mar 2026, last 3 months = shows from 2025 or 2026
                if (year === currentYear || year === currentYear - 1) return 'last3mo';
            } else {
                // After March, last 3 months means shows from this year
                if (year === currentYear && month >= currentMonth - 2) return 'last3mo';
            }
            
            // Last 6 months: current year if we're in Jan-Jun, or previous year
            if (currentMonth <= 6) {
                // In Jan-Jun 2026, last 6 months = shows from 2025 or 2026
                if (year === currentYear || year === currentYear - 1) return 'last6mo';
            } else {
                // After June, last 6 months means shows from this year
                if (year === currentYear && month >= currentMonth - 5) return 'last6mo';
            }
            
            // Decades
            if (year >= 2020) return '2020s';
            if (year >= 2010) return '2010s';
            if (year >= 2000) return '2000s';
            return 'pre2000';
        }
        
        function getTier(score) {
            if (score >= 9) return 'gold';
            if (score >= 7) return 'silver';
            return 'bronze';
        }
        
        function getMultiplier(episodes) {
            if (episodes <= 10) return 0.96;
            if (episodes <= 20) return 0.95;
            if (episodes <= 30) return 0.97;
            if (episodes <= 40) return 1.00;
            if (episodes <= 50) return 1.02;
            if (episodes <= 60) return 1.03;
            if (episodes <= 75) return 1.04;
            if (episodes <= 100) return 1.05;
            return 1.06;
        }
        
        // Fetch posters from TMDB
        async function fetchPosters() {
            for (let show of shows) {
                // Clean title for search (remove season info in parentheses)
                const searchTitle = show.title.replace(/\s*\(S\d+.*\)/, '').trim();
                try {
                    const searchRes = await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(searchTitle)}&first_air_year=${show.year}`);
                    const searchData = await searchRes.json();
                    if (searchData.results && searchData.results.length > 0) {
                        const bestMatch = searchData.results[0];
                        if (bestMatch.poster_path) {
                            show.poster = TMDB_IMAGE_BASE + bestMatch.poster_path;
                            console.log(`Found poster for: ${show.title}`);
                        }
                    }
                } catch (e) {
                    console.error(`Error fetching poster for ${show.title}:`, e);
                }
                // Rate limiting - small delay between requests
                await new Promise(r => setTimeout(r, 200));
            }
            // Re-render with posters
            renderShows();
        }
        
        function getScoreMeaning(score) {
            if (score >= 10) return 'Perfect — The gold standard, no meaningful flaws';
            if (score >= 9) return 'Incredible — Near-flawless, only minor imperfections';
            if (score >= 8) return 'Exceptional — Among the very best in television';
            if (score >= 7) return 'Very Good — Clearly stands out, memorable';
            if (score >= 6) return 'Good — Noticeably above typical TV';
            if (score >= 5) return 'Average — Competent but unremarkable';
            return 'Below Average — Ranges from mediocre to poor';
        }
        
        // Poster colors by genre
        const genreColors = {
            'fantasy': '#7B68EE',
            'drama': '#4A90A4',
            'action': '#E63946',
            'crime': '#2D3436',
            'thriller': '#6C5CE7',
            'cop-show': '#1ABC9C',
            'scifi': '#00CEC9',
            'horror': '#A63333',
            'comedy': '#F39C12',
            'western': '#D35400',
            'romance': '#E91E63',
            'mystery': '#34495E',
            'historical': '#8B4513',
            'war': '#5D6D7E'
        };
        
        function getPosterColor(genres) {
            const primary = genres[0] || 'drama';
            return genreColors[primary] || '#d4af37';
        }
        
        // Pinned shows for Quick Compare (stored by title, not rank)
        let pinnedShows = [];

        function renderPinnedShows() {
            const container = document.getElementById('pinned-shows');
            const quickCompare = document.getElementById('quick-compare');

            if (pinnedShows.length === 0) {
                quickCompare.classList.remove('visible');
                return;
            }

            quickCompare.classList.add('visible');
            container.innerHTML = pinnedShows.map(title => {
                const show = shows.find(s => s.title === title);
                if (!show) return '';
                return `
                    <div class="pinned-card" data-pin-title="${show.title.replace(/"/g, '&quot;')}">
                        <span class="pin-rank">#${show.rank}</span>
                        <span class="pin-title">${show.title.replace(/\s*\(S\d+-\d+\)$/, '')}</span>
                        <span class="pin-score">${show.final.toFixed(2)}</span>
                        <button class="unpin-btn" data-pin-title="${show.title.replace(/"/g, '&quot;')}">✕</button>
                    </div>
                `;
            }).join('');
        }

        function togglePin(title) {
            const idx = pinnedShows.indexOf(title);
            if (idx > -1) {
                pinnedShows.splice(idx, 1);
            } else {
                if (pinnedShows.length >= 3) {
                    pinnedShows.shift(); // Max 3 pinned
                }
                pinnedShows.push(title);
            }
            renderPinnedShows();
            renderShows();
        }

        function renderShows() {
            let filtered = shows.filter(show => {
                const matchesSearch = show.title.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesScore = show.final >= minScore;
                const matchesEra = currentEras.length === 0 || currentEras.includes(getEra(show.year, show.month));
                
                let matchesGenre = true;
                if (!currentGenres.includes('all')) {
                    matchesGenre = currentGenres.every(g => show.genres.includes(g));
                }
                
                return matchesSearch && matchesScore && matchesEra && matchesGenre;
            });

            filtered.sort((a, b) => {
                switch(sortBy) {
                    case 'score-desc': return b.final - a.final;
                    case 'score-asc': return a.final - b.final;
                    case 'year-desc': return b.year - a.year;
                    case 'year-asc': return a.year - b.year;
                    case 'title': return a.title.localeCompare(b.title);
                    default: return a.rank - b.rank;
                }
            });

            resultsNum.textContent = filtered.length;

            if (filtered.length === 0) {
                list.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }

            list.style.display = 'flex';
            noResults.style.display = 'none';

            list.innerHTML = filtered.map((show, idx) => {
                const tier = getTier(show.final);
                const tierColors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                const tierColor = tierColors[tier];
                
                const showTitleEscaped = show.title.replace(/"/g, '&quot;');
                return `
                <div class="show-module" data-show-title="${showTitleEscaped}" style="display:flex;gap:0;margin-bottom:0.5rem;animation:fadeIn 0.4s ease-out;animation-delay:${idx*40}ms;animation-fill-mode:both;align-items:flex-start;">
                    <!-- Poster - larger image -->
                    <div class="show-poster" style="width:200px;min-width:200px;background:#1a1a24;border-radius:8px 0 0 8px;position:relative;flex-shrink:0;box-shadow:4px 0 20px rgba(0,0,0,0.4);overflow:hidden;">
                        ${show.poster
                            ? `<img src="${show.poster}" alt="${show.title}" style="width:100%;height:auto;display:block;">`
                            : `<span style="font-family:Unna,serif;font-size:5rem;color:rgba(255,255,255,0.12);font-weight:900;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;">${show.title.charAt(0)}</span>`
                        }
                        <!-- Rank badge -->
                        <span data-rank-badge style="position:absolute;top:-6px;left:-6px;width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,${tierColor}99,${tierColor});color:#0a0a0f;display:flex;align-items:center;justify-content:center;font-family:JetBrains Mono,monospace;font-size:0.75rem;font-weight:600;z-index:5;box-shadow:0 4px 12px rgba(0,0,0,0.5);">#${show.rank}</span>
                    </div>

                    <!-- Card Panel - flows next to poster -->
                    <div class="show-card-panel" style="flex:1;min-width:0;background:linear-gradient(135deg,rgba(20,20,28,0.95),rgba(20,20,28,0.8));border:1px solid #252532;border-radius:0 12px 12px 0;border-left:none;padding:0.8rem 1.25rem;position:relative;transition:all 0.3s ease;" onmouseover="this.style.borderColor='#d4af3740';this.style.background='linear-gradient(135deg,rgba(30,30,40,0.98),rgba(25,25,35,0.85))'" onmouseout="this.style.borderColor='#252532';this.style.background='linear-gradient(135deg,rgba(20,20,28,0.95),rgba(20,20,28,0.8))'">
                        <!-- Corner ornaments -->
                        <div style="position:absolute;top:6px;left:6px;width:12px;height:12px;border-top:1px solid #d4af3740;border-left:1px solid #d4af3740;"></div>
                        <div style="position:absolute;top:6px;right:6px;width:12px;height:12px;border-top:1px solid #d4af3740;border-right:1px solid #d4af3740;"></div>
                        <div style="position:absolute;bottom:6px;left:6px;width:12px;height:12px;border-bottom:1px solid #d4af3740;border-left:1px solid #d4af3740;"></div>
                        <div style="position:absolute;bottom:6px;right:6px;width:12px;height:12px;border-bottom:1px solid #d4af3740;border-right:1px solid #d4af3740;"></div>

                        <!-- Top row: Title + Score -->
                        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:0.5rem;">
                            <div style="flex:1;min-width:100px;">
                                <div style="font-family:Unna,serif;font-size:1.6rem;font-weight:700;color:#e8e8ec;display:flex;align-items:center;gap:0.35rem;flex-wrap:wrap;line-height:1.1;">
                                    ${show.title.replace(/\s*\(S\d+-\d+\)$/, '')}
                                    ${show.title.match(/\(S\d+-\d+\)/) ? `<span style="background:#475569;color:#e8e8ec;font-size:0.75rem;padding:0.08rem 0.25rem;border-radius:4px;font-weight:600;box-shadow:0 2px 4px rgba(0,0,0,0.2);">${show.title.match(/\(S\d+-\d+\)/)[0].replace(/[()]/g,'')}</span>` : ''}
                                </div>
                                <div style="display:flex;align-items:center;gap:0.4rem;margin-top:0.2rem;">
                                    <span style="font-size:0.9rem;color:#8a8a9a;">${show.year}</span>
                                    <span style="color:#3a3a48;">|</span>
                                    <span style="font-size:0.9rem;color:#8a8a9a;">${show.episodes} ep</span>
                                    <span style="font-size:0.8rem;font-family:'JetBrains Mono',monospace;vertical-align:0;${getMultiplier(show.episodes) > 1 ? 'color:#22c55e;' : getMultiplier(show.episodes) < 1 ? 'color:#ef4444;' : 'color:#64748b;'}">×${getMultiplier(show.episodes).toFixed(2)}</span>
                                </div>
                            </div>
                            <div style="text-align:right;flex-shrink:0;position:relative;">
                                <!-- Score glow effect for high scores -->
                                ${show.final >= 9 ? `<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:50px;height:50px;background:radial-gradient(circle,${tierColor}30 0%,transparent 70%);border-radius:50%;pointer-events:none;"></div>` : ''}
                                <div data-score-display style="font-family:Unna,serif;font-size:2.2rem;font-weight:900;color:${tierColor};line-height:1;animation:goldGlow 3s ease-in-out infinite;text-shadow:${show.final >= 9 ? `0 0 20px ${tierColor}40` : 'none'};">${show.final.toFixed(2)}</div>
                                <div style="font-size:0.5rem;color:#8a8a9a;text-transform:uppercase;letter-spacing:0.1em;">score</div>
                            </div>
                        </div>

                        <!-- Divider -->
                        <div style="display:flex;align-items:center;gap:0.5rem;padding:0.3rem 0;">
                            <div style="flex:1;height:1px;background:linear-gradient(90deg,transparent,#252532);"></div>
                            <div style="color:#d4af37;font-size:0.65rem;">✦</div>
                            <div style="flex:1;height:1px;background:linear-gradient(90deg,#252532,transparent);"></div>
                        </div>

                        <!-- Category bars with sliders -->
                        <div style="display:flex;flex-direction:column;gap:2px;">
                            ${categories.map(cat => {
                                const value = show[cat.key];
                                const percentage = (value / 10) * 100;
                                const catTier = getTier(value);
                                const catTierColors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                                const catTierColor = catTierColors[catTier];
                                const isModified = baseScores[show.title] && value !== baseScores[show.title][cat.key];
                                return `
                                    <div style="display:grid;grid-template-columns:35% 55% 10%;align-items:center;">
                                        <span style="font-family:Unna,serif;font-size:0.85rem;font-weight:200;font-style:italic;color:#e8e8ec;">${cat.label}</span>
                                        <div class="cat-bar-container">
                                            <div class="cat-bar-track">
                                                <div class="cat-bar-fill" data-cat-bar="${cat.key}" style="background:linear-gradient(90deg,${catTierColor}99,${catTierColor},${catTierColor}99);width:${percentage}%;"></div>
                                            </div>
                                            <input type="range" class="cat-slider-input" data-show="${showTitleEscaped}" data-cat="${cat.key}" min="0" max="10" step="0.5" value="${value}">
                                        </div>
                                        <span class="cat-value-display${isModified ? ' cat-value-modified' : ''}" data-cat-value="${cat.key}" style="font-family:JetBrains Mono,monospace;font-size:0.7rem;font-weight:500;text-align:right;color:${isModified ? '#60a5fa' : catTierColor};">${value}</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>

                        <!-- Genres -->
                        <div style="display:flex;flex-wrap:wrap;gap:0.25rem;margin-top:0.25rem;">
                            ${show.genres.map(g => `<span style="background:transparent;border:1px solid #64748b;color:#64748b;padding:0.08rem 0.25rem;border-radius:100px;font-size:0.5rem;font-weight:500;">${g}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `}).join('');

            setTimeout(() => {
                document.querySelectorAll('.score-bar-fill').forEach(bar => {
                    bar.style.width = bar.dataset.width;
                });
            }, 100);

            updateActiveFilters();
        }

        function updateActiveFilters() {
            const tags = [];
            
            // Active era tags
            if (currentEras.length > 0) {
                currentEras.forEach(era => {
                    tags.push({ type: 'era', value: era, label: `Era: ${era}` });
                });
            }
            
            if (minScore > 6.5) {
                tags.push({ type: 'score', value: minScore, label: `Score: ${minScore}+` });
            }
            
            if (!currentGenres.includes('all')) {
                currentGenres.forEach(g => {
                    tags.push({ type: 'genre', value: g, label: g });
                });
            }
            
            if (searchTerm) {
                tags.push({ type: 'search', value: searchTerm, label: `"${searchTerm}"` });
            }
            
            if (tags.length === 0) {
                activeFiltersEl.innerHTML = '';
                return;
            }
            
            activeFiltersEl.innerHTML = tags.map(t => `
                <span class="active-filter-tag">
                    ${t.label}
                    <button onclick="removeFilter('${t.type}', '${t.value}')">×</button>
                </span>
            `).join('') + `<button class="clear-all" onclick="clearAllFilters()">Clear all</button>`;
        }

        window.removeFilter = function(type, value) {
            if (type === 'era') {
                currentEra = 'all';
                document.querySelectorAll('#era-filters .filter-btn').forEach(b => b.classList.remove('active'));
                document.querySelector('#era-filters .filter-btn[data-filter="all"]').classList.add('active');
            } else if (type === 'score') {
                minScore = 6.5;
                if (scoreFilter) scoreFilter.value = 6.5;
                if (scoreValue) scoreValue.textContent = '6.5';
            } else if (type === 'genre') {
                currentGenres = currentGenres.filter(g => g !== value);
                if (currentGenres.length === 0) {
                    currentGenres = ['all'];
                    document.querySelectorAll('#genre-filters .genre-pill').forEach(p => p.classList.remove('active'));
                    document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.add('active');
                } else {
                    document.querySelector(`#genre-filters .genre-pill[data-genre="${value}"]`).classList.remove('active');
                }
            } else if (type === 'search') {
                searchTerm = '';
                searchInput.value = '';
            }
            renderShows();
        };

        window.clearAllFilters = function() {
            currentEras = [];
            currentGenres = ['all'];
            minScore = 6.5;
            searchTerm = '';
            sortBy = 'rank';
            
            searchInput.value = '';
            if (scoreFilter) scoreFilter.value = 6.5;
            if (scoreValue) scoreValue.textContent = '6.5';
            sortSelect.value = 'rank';
            
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.genre-pill').forEach(p => p.classList.remove('active'));
            document.querySelector('#era-filters .filter-btn[data-filter="all"]').classList.add('active');
            document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.add('active');
            
            renderShows();
        };

        // Era buttons (multi-select)
        document.querySelectorAll('#era-filters .filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const era = btn.dataset.filter;
                if (era === 'all') {
                    currentEras = [];
                    document.querySelectorAll('#era-filters .filter-btn').forEach(b => b.classList.remove('active'));
                } else {
                    btn.classList.toggle('active');
                    if (btn.classList.contains('active')) {
                        currentEras.push(era);
                    } else {
                        currentEras = currentEras.filter(e => e !== era);
                    }
                    document.querySelector('#era-filters .filter-btn[data-filter="all"]').classList.remove('active');
                }
                renderShows();
            });
        });

        // Genre pills
        document.querySelectorAll('#genre-filters .genre-pill').forEach(pill => {
            pill.addEventListener('click', () => {
                const genre = pill.dataset.genre;
                
                if (genre === 'all') {
                    document.querySelectorAll('#genre-filters .genre-pill').forEach(p => p.classList.remove('active'));
                    pill.classList.add('active');
                    currentGenres = ['all'];
                } else {
                    document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.remove('active');
                    
                    if (pill.classList.contains('active')) {
                        pill.classList.remove('active');
                        currentGenres = currentGenres.filter(g => g !== genre);
                        if (currentGenres.length === 0) {
                            currentGenres = ['all'];
                            document.querySelector('#genre-filters .genre-pill[data-genre="all"]').classList.add('active');
                        }
                    } else {
                        pill.classList.add('active');
                        if (currentGenres.includes('all')) {
                            currentGenres = [genre];
                        } else {
                            currentGenres.push(genre);
                        }
                    }
                }
                renderShows();
            });
        });

        // Search
        searchInput.addEventListener('input', (e) => {
            searchTerm = e.target.value;
            renderShows();
        });
        
        // Genre tags on cards - click to filter
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('genre-tag')) {
                const genre = e.target.textContent;
                document.querySelectorAll('#genre-filters .genre-pill').forEach(p => p.classList.remove('active'));
                const pill = document.querySelector(`#genre-filters .genre-pill[data-genre="${genre}"]`);
                if (pill) {
                    pill.classList.add('active');
                    currentGenres = [genre];
                    renderShows();
                }
            }
        });

        // Score filter (only if element exists)
        if (scoreFilter) {
            scoreFilter.addEventListener('input', (e) => {
                minScore = parseFloat(e.target.value);
                if (scoreValue) scoreValue.textContent = minScore.toFixed(1);
                renderShows();
            });
        }

        // Sort
        sortSelect.addEventListener('change', (e) => {
            sortBy = e.target.value;
            renderShows();
        });
        
        // Pin button handlers
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('pin-btn')) {
                const title = e.target.dataset.pinTitle || e.target.closest('.show-module')?.dataset.showTitle;
                if (title) togglePin(title);
            }
            if (e.target.classList.contains('unpin-btn')) {
                const title = e.target.dataset.pinTitle;
                if (title) togglePin(title);
            }
            // Accordion for score descriptions - Category label
            if (e.target.classList.contains('score-label-text')) {
                const desc = e.target.nextElementSibling.nextElementSibling; // score-bar is between
                const allDescs = document.querySelectorAll('.score-desc.expanded');
                allDescs.forEach(d => {
                    if (d !== desc) d.classList.remove('expanded');
                });
                desc.classList.toggle('expanded');
            }
            // Score value click - show score meaning
            if (e.target.classList.contains('score-value')) {
                const meaning = e.target.dataset.meaning;
                const catDesc = e.target.previousElementSibling.previousElementSibling.querySelector('.score-desc');
                const allDescs = document.querySelectorAll('.score-desc.expanded');
                allDescs.forEach(d => {
                    if (d !== catDesc) d.classList.remove('expanded');
                });
                // Show category description with score meaning
                if (catDesc) {
                    catDesc.innerHTML = `<strong>Score ${e.target.dataset.score}:</strong> ${meaning}<br><em>${catDesc.textContent}</em>`;
                    catDesc.classList.toggle('expanded');
                }
            }
        });

        // Methodology modal
        const modal = document.getElementById('methodology-modal');
        const openLink = document.getElementById('open-methodology');
        const closeBtn = document.getElementById('close-methodology');
        
        if (openLink && modal && closeBtn) {
            openLink.addEventListener('click', (e) => {
                e.preventDefault();
                modal.classList.add('visible');
            });
            
            // Card-level methodology links
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('card-methodology-link')) {
                    e.preventDefault();
                    modal.classList.add('visible');
                }
            });
            
            closeBtn.addEventListener('click', () => {
                modal.classList.remove('visible');
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('visible');
                }
            });
        }

        // Category modal
        const categoryModal = document.getElementById('category-modal');
        const categoryModalTitle = document.getElementById('category-modal-title');
        const categoryModalWeight = document.getElementById('category-modal-weight');
        const categoryModalDesc = document.getElementById('category-modal-desc');
        const closeCategoryBtn = document.getElementById('close-category');
        
        if (categoryModal) {
            // Click on score labels
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('score-label-text') || e.target.classList.contains('score-value')) {
                    const catKey = e.target.dataset.cat || e.target.dataset.score;
                    const category = categories.find(c => c.key === catKey);
                    if (category) {
                        categoryModalTitle.textContent = category.label;
                        categoryModalWeight.textContent = category.weight;
                        categoryModalDesc.textContent = category.desc;
                        categoryModal.classList.add('visible');
                    }
                }
            });
            
            closeCategoryBtn.addEventListener('click', () => {
                categoryModal.classList.remove('visible');
            });
            
            categoryModal.addEventListener('click', (e) => {
                if (e.target === categoryModal) {
                    categoryModal.classList.remove('visible');
                }
            });
        }

        // ---- Per-card slider event handling ----
        let reorderDebounce = null;

        // Prevent slider drags from opening category modal
        list.addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('cat-slider-input')) {
                e.stopPropagation();
            }
        }, true);
        list.addEventListener('touchstart', (e) => {
            if (e.target.classList.contains('cat-slider-input')) {
                e.stopPropagation();
            }
        }, true);

        // Live update on slider drag
        list.addEventListener('input', (e) => {
            if (!e.target.classList.contains('cat-slider-input')) return;
            const slider = e.target;
            const title = slider.dataset.show;
            const catKey = slider.dataset.cat;
            const newVal = parseFloat(slider.value);

            const show = shows.find(s => s.title === title);
            if (!show || !activeScores[title]) return;

            // Update data
            activeScores[title][catKey] = newVal;
            show[catKey] = newVal;
            
            // Calculate final from BASE + sum of all deltas (not cumulative)
            let finalDelta = 0;
            catKeys.forEach(k => {
                const delta = activeScores[title][k] - baseScores[title][k];
                finalDelta += delta * (weights[k] / 100);
            });
            show.final = parseFloat((baseScores[title].final + finalDelta).toFixed(2));

            // Track modification
            const isModified = catKeys.some(k => activeScores[title][k] !== baseScores[title][k]);
            if (isModified) {
                modifiedShows.add(title);
            } else {
                modifiedShows.delete(title);
            }

            // Targeted DOM update (no full re-render)
            const card = list.querySelector(`.show-module[data-show-title="${CSS.escape(title)}"]`);
            if (card) {
                // Update bar fill
                const barFill = card.querySelector(`[data-cat-bar="${catKey}"]`);
                if (barFill) {
                    const pct = (newVal / 10) * 100;
                    const tier = getTier(newVal);
                    const colors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                    const c = colors[tier];
                    barFill.style.width = pct + '%';
                    barFill.style.background = `linear-gradient(90deg,${c}99,${c},${c}99)`;
                }

                // Update value text
                const valEl = card.querySelector(`[data-cat-value="${catKey}"]`);
                if (valEl) {
                    const valModified = baseScores[title] && newVal !== baseScores[title][catKey];
                    valEl.textContent = newVal;
                    if (valModified) {
                        valEl.classList.add('cat-value-modified');
                        valEl.style.color = '#60a5fa';
                    } else {
                        valEl.classList.remove('cat-value-modified');
                        const tier = getTier(newVal);
                        const colors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                        valEl.style.color = colors[tier];
                    }
                }

                // Update total score display
                const scoreDisplay = card.querySelector('[data-score-display]');
                if (scoreDisplay) {
                    const tier = getTier(show.final);
                    const colors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                    scoreDisplay.textContent = show.final.toFixed(2);
                    scoreDisplay.style.color = colors[tier];
                }
            }

            updateSaveBar();

            // Debounced reorder
            if (reorderDebounce) clearTimeout(reorderDebounce);
            reorderDebounce = setTimeout(() => checkAndReorder(), 300);
        });

        // On slider release — immediate reorder + persist
        list.addEventListener('change', (e) => {
            if (!e.target.classList.contains('cat-slider-input')) return;
            if (reorderDebounce) { clearTimeout(reorderDebounce); reorderDebounce = null; }
            checkAndReorder();
            saveOverridesToStorage();
        });

        function checkAndReorder() {
            // Re-sort shows array
            shows.sort((a, b) => b.final - a.final);
            shows.forEach((s, i) => { s.rank = i + 1; });

            // Get current DOM order
            const cards = Array.from(list.querySelectorAll('.show-module[data-show-title]'));
            const currentOrder = cards.map(c => c.dataset.showTitle);
            const desiredOrder = shows.map(s => s.title);

            // Filter desired order to only currently-visible cards
            const visibleTitles = new Set(currentOrder);
            const desiredVisible = desiredOrder.filter(t => visibleTitles.has(t));

            let needsMove = false;
            for (let i = 0; i < desiredVisible.length; i++) {
                if (currentOrder[i] !== desiredVisible[i]) { needsMove = true; break; }
            }

            if (needsMove) {
                // Move DOM nodes to match desired order
                desiredVisible.forEach(title => {
                    const card = list.querySelector(`.show-module[data-show-title="${CSS.escape(title)}"]`);
                    if (card) list.appendChild(card);
                });
            }

            // Update all rank badges on visible cards
            cards.forEach(card => {
                const title = card.dataset.showTitle;
                const show = shows.find(s => s.title === title);
                if (!show) return;
                const badge = card.querySelector('[data-rank-badge]');
                if (badge) {
                    badge.textContent = '#' + show.rank;
                    const tier = getTier(show.final);
                    const colors = { gold: '#d4af37', silver: '#a8a8b0', bronze: '#a87d4a' };
                    const c = colors[tier];
                    badge.style.background = `linear-gradient(135deg,${c}99,${c})`;
                }
            });

            // Refresh pinned shows
            renderPinnedShows();
        }

        // ---- Save / Export / Import / Reset ----
        document.getElementById('save-scores-btn')?.addEventListener('click', () => {
            saveOverridesToStorage();
            const btn = document.getElementById('save-scores-btn');
            const orig = btn.textContent;
            btn.textContent = 'Saved!';
            setTimeout(() => { btn.textContent = orig; }, 1500);
        });

        document.getElementById('export-scores-btn')?.addEventListener('click', () => {
            const overrides = {};
            modifiedShows.forEach(title => {
                overrides[title] = {};
                catKeys.forEach(key => {
                    overrides[title][key] = activeScores[title][key];
                });
            });
            const blob = new Blob([JSON.stringify({
                timestamp: new Date().toISOString(),
                weights: { ...weights },
                baseScores: { ...baseScores },
                overrides,
                finalRankings: shows.map(s => ({ rank: s.rank, title: s.title, final: s.final }))
            }, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            const ts = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19);
            a.href = url;
            a.download = `tvranked-scores-${ts}.json`;
            a.click();
            URL.revokeObjectURL(url);
        });

        document.getElementById('import-scores-btn')?.addEventListener('click', () => {
            document.getElementById('import-scores-file').click();
        });

        document.getElementById('import-scores-file')?.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (ev) => {
                try {
                    const data = JSON.parse(ev.target.result);
                    if (data.overrides) {
                        // Reset to base first
                        shows.forEach(show => {
                            if (baseScores[show.title]) {
                                catKeys.forEach(k => {
                                    show[k] = baseScores[show.title][k];
                                    activeScores[show.title][k] = baseScores[show.title][k];
                                });
                            }
                        });
                        modifiedShows.clear();

                        // Apply imported overrides
                        Object.keys(data.overrides).forEach(title => {
                            const show = shows.find(s => s.title === title);
                            if (!show) return;
                            const changes = data.overrides[title];
                            let hasChange = false;
                            catKeys.forEach(key => {
                                if (changes[key] !== undefined) {
                                    show[key] = changes[key];
                                    activeScores[title][key] = changes[key];
                                    if (changes[key] !== baseScores[title][key]) hasChange = true;
                                }
                            });
                            if (hasChange) modifiedShows.add(title);
                            recalcFinal(show);
                        });

                        // Optionally import weights
                        if (data.weights) {
                            Object.assign(weights, data.weights);
                            initWeightSliders();
                        }

                        shows.forEach(show => recalcFinal(show));
                        shows.sort((a, b) => b.final - a.final);
                        shows.forEach((s, i) => { s.rank = i + 1; });
                        saveOverridesToStorage();
                        updateSaveBar();
                        renderShows();
                    }
                } catch (err) {
                    console.error('Failed to import scores:', err);
                    alert('Failed to import: invalid JSON file');
                }
            };
            reader.readAsText(file);
            e.target.value = ''; // reset file input
        });

        document.getElementById('reset-scores-btn')?.addEventListener('click', () => {
            if (!confirm('Reset all score modifications to original values?')) return;
            
            // Also reset weights to defaults
            weights = { ...defaultWeights };
            initWeightSliders();
            
            shows.forEach(show => {
                if (baseScores[show.title]) {
                    catKeys.forEach(k => {
                        show[k] = baseScores[show.title][k];
                        activeScores[show.title][k] = baseScores[show.title][k];
                    });
                    // Restore original final score instead of recalculating
                    show.final = baseScores[show.title].final;
                }
            });
            modifiedShows.clear();
            localStorage.removeItem('tvranked_score_overrides');
            shows.sort((a, b) => b.final - a.final);
            shows.forEach((s, i) => { s.rank = i + 1; });
            updateSaveBar();
            renderShows();
        });

        // ---- Fix pinned shows to use titles instead of ranks ----
        // (Ranks are now mutable, so pin by title)

        // Initial render
        renderShows();

        // Ensure list is visible
        document.getElementById('rankings').style.display = 'flex';
    </script>
</body>
</html>
